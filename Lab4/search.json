[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "S2S Lab 4",
    "section": "",
    "text": "Welcome to the fourth S2S lab. This lab will teach you how to plot data sets in R, specifically following Sections 2.3 and 2.4 of Probability and Statistics with R. You will learn some of the appropriate ways to display different types of data and how to create these graphs and plots with your own code.\nThere are two ways plots or graphs are commonly created in R, and that is either using base R functions (ones which are automatically built into the R software) or using a specific package for creating graphs called ggplot2. This lab focuses on producing plots in base R, but ggplot2 is introduced in Appendix A.\nBy the end of this lab you will be able to create your own plots of data from scratch, and replicate detailed graphs as well.",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Welcome!</span>"
    ]
  },
  {
    "objectID": "01-qualitative.html",
    "href": "01-qualitative.html",
    "title": "2  Qualitative Data",
    "section": "",
    "text": "2.1 Tables\nQualitative data is the term used when a variable has different categories or groups or levels. This could be things such as students’ grades, the genders of patients in an experiment or which treatment subjects have been given. There are several ways that qualitative data can be summarised and presented.\nDetails on summarising univariate qualitative data and creating suitable graphical displays are also covered in Section 2.3 Displaying Qualitative Data in Probability and Statistics with R.\nFrequency tables summarise qualitative data by showing the different groups/categories in a variable and the corresponding frequency with which they occur - that is, how many observations fall into each category.\nFrequency tables can be created in R using the table() function. We have already seen table() used in Lab 3, but let’s revisit it with an example.\nThe data set EPIDURAL from the package PASWR2 contains information on 85 patients from a study used to determine whether administering epidural anesthesia (a pain relief administered in the back) to pregnant women in labour is better whilst they are in the traditional sitting position, or when they are in a “hamstring stretch” position. This contains several variables relating to each patient and the treatment they receive (to see more about what each of these variables describes, run the code help(\"EPIDURAL\")).\nWe can load the data frame into our Environment tab and look at the first five rows using the following code (make sure you have installed the PASWR2 package on whatever device you are using R with beforehand).\nThe variable ease is a factor variable which tells how easy the physician found it to locate where the epidural anesthesia should be administered for each patient. It has levels \"Easy\", \"Difficult\" and \"Impossible\".\nWe can summarise the number of patients that fall into each level of the ease variable using the table() function as follows.\nThis frequency table shows us that there are 57 patients in the data set for whom it was easy to administer the anesthetic, 20 who it was difficult for and 8 for whom it was impossible to find where to administer the anesthetic.\nWe could also create a table showing the proportion of the total number of patients which fall into each level of ease using prop.table(). We need to make sure that we give a pre-existing table to this function. We can use the table epi_freq created above.\nNow we can see that it was easy to find where to administer the anesthetic for roughly 67% of patients, difficult for roughly 24% and impossible for 9% of patients.\nSee Section 2.3.1 Tables of Probability and Statistics with R to read more about presenting qualitative data in frequency and proportion tables.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Qualitative Data</span>"
    ]
  },
  {
    "objectID": "01-qualitative.html#sec-tables",
    "href": "01-qualitative.html#sec-tables",
    "title": "2  Qualitative Data",
    "section": "",
    "text": "R CodeOutput\n\n\n\nlibrary(PASWR2)\n\ndata(\"EPIDURAL\")\nhead(EPIDURAL)\n\n\n\n\n\n  doctor  kg  cm       ease           treatment oc complications\n1  Dr. B 116 172  Difficult Traditional Sitting  0          None\n2  Dr. C  86 176       Easy   Hamstring Stretch  0          None\n3  Dr. B  72 157  Difficult Traditional Sitting  0          None\n4  Dr. B  63 169       Easy   Hamstring Stretch  2          None\n5  Dr. B 114 163 Impossible Traditional Sitting  0          None\n6  Dr. B 121 163  Difficult   Hamstring Stretch  3          None\n\n\n\n\n\n\n\n\nR CodeOutput\n\n\n\nepi_freq &lt;- table(EPIDURAL$ease)\nepi_freq\n\n\n\n\n\n\n Difficult       Easy Impossible \n        20         57          8 \n\n\n\n\n\n\n\n\nTask\n\n\nThe levels of ease are automatically presented in alphabetical order. Can you reorder the labels so that they go in the order \"Easy\", \"Difficult\" and \"Impossible\"?\n\n\nHint\n\nYou will need to use the function factor() and the argument levels = in order to reorder the levels of a factor. You can look back at Lab 2 to remind yourself how to use the factor() function.\n\n\n\nSolution\n\n\nR CodeOutput\n\n\n\nEPIDURAL$ease &lt;- factor(x = EPIDURAL$ease,\n                        levels = c(\"Easy\", \"Difficult\", \"Impossible\"))\nlevels(EPIDURAL$ease)\n\n\n\n\n\n[1] \"Easy\"       \"Difficult\"  \"Impossible\"\n\n\n\n\n\nThe function levels() can be used to see the levels of a factor variable, as well as the order they are stored in.\nWe can update the frequency table epi_freq so that the different levels of ease now appear in a sensible order.\n\nR CodeOutput\n\n\n\nepi_freq &lt;- table(EPIDURAL$ease)\nepi_freq\n\n\n\n\n\n\n      Easy  Difficult Impossible \n        57         20          8 \n\n\n\n\n\n\n\n\n\n\nR CodeOutput\n\n\n\nepi_prop &lt;- prop.table(epi_freq)\nepi_prop\n\n\n\n\n\n\n      Easy  Difficult Impossible \n0.67058824 0.23529412 0.09411765 \n\n\n\n\n\n\n\n\nTask\n\n\nThe TITANIC3 data set from the PASWR2 package contains information on the survival status of passengers on the Titanic. Load this data set into your Environment tab and create a frequency table showing the number of passengers who survived and the number who did not.\nRemember to explore the data set using the help() and str() functions. It might help to rename the levels of the survived variable so they are clear.\n\n\nSolution\n\n\nR CodeOutput\n\n\n\ndata(\"TITANIC3\")\n\nTITANIC3$survived &lt;- factor(x = TITANIC3$survived, labels = c(\"No\", \"Yes\"))\n\ntable(TITANIC3$survived)\n\n\n\n\n\n\n No Yes \n809 500 \n\n\n\n\n\n\n\n\n\n\nTask\n\n\nWhat proportion of passengers survived the Titanic sinking? \n\n\nSolution\n\nWe can find the proportion of survivors by using the prop.table() function.\n\nR CodeOutput\n\n\n\nprop.table(table(TITANIC3$survived))\n\n\n\n\n\n\n      No      Yes \n0.618029 0.381971",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Qualitative Data</span>"
    ]
  },
  {
    "objectID": "01-qualitative.html#sec-bars",
    "href": "01-qualitative.html#sec-bars",
    "title": "2  Qualitative Data",
    "section": "2.2 Barplots",
    "text": "2.2 Barplots\nBarplots are a way to graphically summarise qualitative data. You will most likely have seen many barplots before, but now we’re going to learn how to create our own.\nThe function used to create barplots in R is barplot(). It takes the following arguments:\n\nheight =: this is the vector or matrix which contains a summary of the qualitative data; this could be a frequency table or a table of proportions.\ncol =: this is a vector of colours to be used for the bars in the barplot. If you want to see a list of colour names that R can use, run the code colors() - there are also documents online which will show you the actual colours too!\nmain =: this is the main title of the plot.\nxlab =: this is a label for along the x-axis.\nylab =: this is a label for along the y-axis.\nylim =: this is a vector giving the limits that the y-axis should be spread over.\n\nThe only essential argument to give to barplot() is height =. For a full list of the arguments that can be used within barplot(), use the code help(\"barplot\").\nWe can create a barplot showing the number of patients from EPIDURAL that fall into each level of ease using the following code.\n\nR CodePlots\n\n\n\nbarplot(height = epi_freq,\n        col = c(\"darkslategray\", \"darkslategray4\", \"darkslategray3\"),\n        main = \"Ease of Locating Anesthesia Administering Location in Patients\",\n        xlab = \"Ease\",\n        ylab = \"Frequency\")\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nWe can also use the table of proportions epi_prop to create a barplot, this time showing the proportion of patients in each level of ease, rather than the frequency.\n\nR CodePlots\n\n\n\nbarplot(height = epi_prop,\n        col = c(\"darkslategray\", \"darkslategray4\", \"darkslategray3\"),\n        main = \"Ease of Locating Anesthesia Administering Location in Patients\",\n        xlab = \"Ease\",\n        ylab = \"Proportion\")\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nNotice that the shapes of both these barplots are identical. The only difference between them is the scale used on the y-axis.\n\n\nTask\n\n\nComplete the code below to create a barplot which shows the number of passengers on the Titanic belonging to 1st, 2nd and 3rd class respectively.\n\nR CodePlots\n\n\n\n(= table(TITANIC3$pclass),\n\ncol = c(\"gray32\", \"gray95\", \"seashell3\"),\n\n\n= \"Number of Titanic Passengers in each Class\",\n\n\nxlab =, ylab = \"Frequency\")\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nSolution\n\n\nR CodePlots\n\n\n\nbarplot(height = table(TITANIC3$pclass),\n        col = c(\"gray32\", \"gray95\", \"seashell3\"),\n        main = \"Number of Titanic Passengers in each Class\",\n        xlab = \"Class\",\n        ylab = \"Frequency\")\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nYou can see further examples of creating barplots in R in Section 2.3.2 Barplots of Probability and Statistics with R.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Qualitative Data</span>"
    ]
  },
  {
    "objectID": "01-qualitative.html#sec-dots",
    "href": "01-qualitative.html#sec-dots",
    "title": "2  Qualitative Data",
    "section": "2.3 Dot Charts",
    "text": "2.3 Dot Charts\nDot charts show similar information to barplots and summarise qualitative data. They show a dot for each level of a categorical variable which indicates the frequency of that level (see below for an example).\nDot charts can be made in R using the function dotchart(). This takes similar arguments to those used by barplot() above, including:\n\nx =: this is the vector or matrix which contains a summary of the qualitative data; this could be a frequency table or a table of proportions.\nbg =: this is the colour to be used inside the dot.\n\nAgain, the only essential argument to provide is x =.\nWe can create a dot chart showing the number of patients from EPIDURAL in each level of ease using the following code.\n\nR CodePlots\n\n\n\ndotchart(x = epi_freq,\n         bg = c(\"darkslategray\", \"darkslategray4\", \"darkslategray3\"),\n         main = \"Ease of Locating Anesthesia Administering Location in Patients\",\n         xlab = \"Frequency\",\n         ylab = \"Ease\")\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nSee Section 2.3.3 Dot Charts of Probability and Statistics with R to learn more about constructing these plots.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Qualitative Data</span>"
    ]
  },
  {
    "objectID": "01-qualitative.html#sec-pies",
    "href": "01-qualitative.html#sec-pies",
    "title": "2  Qualitative Data",
    "section": "2.4 Pie Charts",
    "text": "2.4 Pie Charts\nA third way to graphically present qualitative data is with a pie chart. These show the relative frequencies of different levels of a categorical variable as proportions of a “pie”.\nPie charts are sometimes not favoured by statisticians because it can be difficult to clearly see the differences in proportions when they are very similar. Pie charts can still be used though to show the proportion of observations in a category, in relation to the total number of observations.\nThe function used to create pie charts is pie(), which takes the following arguments:\n\nx =: this is the vector which summarises the qualitative data as frequencies or proportions.\nradius =: this determines the size of the pie chart within your plotting window.\ncol =: this is a vector of colours which are to be used for each “slice” of the pie chart.\n\nYou can see a full list of the arguments that can be given to the pie() function using help(\"pie\"). The only necessary argument to provide is x =.\nWe can create a pie chart showing the proportion of patients in each level of ease using the code below.\n\nR CodePlots\n\n\n\npie(x = epi_prop,\n    radius = 0.9,\n    col = c(\"darkslategray\", \"darkslategray4\", \"darkslategray3\"),\n    main = \"Ease of Locating Anesthesia Administering Location in Patients\")\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nTask\n\n\nCreate a pie chart showing the proportion of passengers on the Titanic in each class.\n\nR CodePlot\n\n\n\n(x = table(TITANIC3$sexclasspclasssurvived),\n\ncol = c(\"gray32\", \"gray95\", \"seashell3\"),\n\n\n= \"Class of Titanic Passengers\")\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nSolution\n\n\nR CodePlots\n\n\n\npie(x = table(TITANIC3$pclass),\n    col = c(\"gray32\", \"gray95\", \"seashell3\"),\n    main = \"Class of Titanic Passengers\")\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nSection 2.3.4 Pie Charts of Probability and Statistics with R gives additional examples of constructing pie charts.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Qualitative Data</span>"
    ]
  },
  {
    "objectID": "01-qualitative.html#sec-bi",
    "href": "01-qualitative.html#sec-bi",
    "title": "2  Qualitative Data",
    "section": "2.5 Bivariate Data",
    "text": "2.5 Bivariate Data\nSo far, we have looked at different ways to visualise information about one categorical (or qualitative) variable. Because only one variable has been considered, it is called univariate data.\nWe will now turn our attention to bivariate categorical data. This means we will look at ways to visualise information about two categorical variables at the same time. We can expand upon some of the methods we have already learned to allow two categorical variables to be considered.\nIn Section 2.1 we looked at the use of the table() function to create frequency tables for one categorical variable. We can expand upon the use of this function so that frequency tables of two categorical variables can be created. These are known as two-way contingency tables.\nIn order to create a two-way contingency table, simply provide the second categorical variable you wish to use as an additional argument.\nThe data set EPIDURAL contains a variable doctor which indicates the physician (\"Dr. A\", \"Dr. B\", \"Dr. C\" or \"Dr. D\") who administered the epidural anesthesia. Table 2.1 shows the number of patients who fall into each level of the doctor and ease variables.\n\n\n\n\nTable 2.1: Two-way contingency table of Doctor by Ease.\n\n\n\n\n\n\n\nEasy\nDifficult\nImpossible\n\n\n\n\nDr. A\n19\n3\n1\n\n\nDr. B\n7\n10\n4\n\n\nDr. C\n18\n3\n0\n\n\nDr. D\n13\n4\n3\n\n\n\n\n\n\n\n\nWe can recreate Table 2.1 in R using the following code.\n\nR CodeOutput\n\n\n\nepi_tab &lt;- table(EPIDURAL$doctor, EPIDURAL$ease)\nepi_tab\n\n\n\n\n\n       \n        Easy Difficult Impossible\n  Dr. A   19         3          1\n  Dr. B    7        10          4\n  Dr. C   18         3          0\n  Dr. D   13         4          3\n\n\n\n\n\n\n\nTask\n\n\nCreate a two-way contingency table showing the number of passengers who survived and did not survive in each of the three classes (1st, 2nd and 3rd).\n\n\nSolution\n\n\nR CodeOutput\n\n\n\ntable(TITANIC3$pclass, TITANIC3$survived)\n\n\n\n\n\n     \n       No Yes\n  1st 123 200\n  2nd 158 119\n  3rd 528 181\n\n\n\n\n\n\n\n\n\n\nTask\n\n\nHow many 3rd class passengers survived the sinking of the Titanic? \n\n\nBarplots are a useful tool to present the information from a two-way contingency table graphically. For example, we can produce a barplot, which shows the same counts as in Table 2.1, using the following code.\n\nR CodePlots\n\n\n\nbarplot(height = epi_tab,\n        legend.text = TRUE,\n        col = c(\"seashell\", \"rosybrown2\", \"thistle\", \"snow4\"),\n        main = \"Number of patients treated by each physician in each level of Ease\",\n        xlab = \"Ease\",\n        ylab = \"Frequency\")\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nThis code uses the barplot() function introduced in Section 2.2 and provides the two-way contingency table epi_tab to the argument height =. This means that all the values in this table will be used to construct the height of the bars. Because the bars for each doctor are on top of each other, this is known as a “stacked” barplot.\nThe argument legend.text = TRUE has also been included so that a legend, indicating the different physicians, is included in the plot.\nIf we instead wanted to produce a barplot where there is a separate bar for each doctor within each level of the ease variable, then we need to include the argument beside = TRUE.\n\nR CodePlots\n\n\n\nbarplot(height = epi_tab,\n        legend.text = TRUE,\n        beside = TRUE,\n        col = c(\"seashell\", \"rosybrown2\", \"thistle\", \"snow4\"),\n        main = \"Number of patients treated by each physician in each level of Ease\",\n        xlab = \"Ease\",\n        ylab = \"Frequency\")\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nAnother option for presenting this information would be to create a barplot where the different doctors are along the x-axis and the levels of ease are used to create the individual bars. In order to do this, we need to transpose the two-way contingency table that is given to the height = argument in the barplot() function.\nTransposing a table can easily be achieved using the function t(). The only argument needed is the table you wish to transpose.\n\nR CodeOutput\n\n\n\nt(epi_tab)\n\n\n\n\n\n            \n             Dr. A Dr. B Dr. C Dr. D\n  Easy          19     7    18    13\n  Difficult      3    10     3     4\n  Impossible     1     4     0     3\n\n\n\n\n\nWe can then create the following barplots using the transposed epi_tab table.\n\nR CodePlots\n\n\n\nbarplot(height = t(epi_tab),\n        legend.text = TRUE,\n        col = c(\"darkslategray\", \"darkslategray3\", \"darkslategray4\"),\n        main = \"Number of patients treated by each physician in each level of Ease\",\n        xlab = \"Doctor\",\n        ylab = \"Frequency\")\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nR CodePlots\n\n\n\nbarplot(height = t(epi_tab),\n        legend.text = TRUE,\n        beside = TRUE,\n        col = c(\"darkslategray\", \"darkslategray3\", \"darkslategray4\"),\n        main = \"Number of patients treated by each physician in each level of Ease\",\n        xlab = \"Doctor\",\n        ylab = \"Frequency\")\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nIt is often better to present relationships using proportions, rather than counts. In order to calculate the proportions (either out of the total number of observations, row totals or column totals) from a two-way contingency table, we can use the function prop.table().\nTo create a barplot which shows the proportion of patients who were in each level of the ease variable out of the total number of patients seen by a given doctor, we would first need to calculate these proportions in epi_tab. This can be done by using the argument margin = 1 within the prop.table() function.\n\nR CodeOutput\n\n\n\nepi_prop_tab &lt;- prop.table(x = epi_tab, margin = 1)\nepi_prop_tab\n\n\n\n\n\n       \n              Easy  Difficult Impossible\n  Dr. A 0.82608696 0.13043478 0.04347826\n  Dr. B 0.33333333 0.47619048 0.19047619\n  Dr. C 0.85714286 0.14285714 0.00000000\n  Dr. D 0.65000000 0.20000000 0.15000000\n\n\n\n\n\nNow we can see, for example, that Dr. A found it easy to feel the bone landmarks of 82.6% of their patients, found it difficult in 13.0% of their patients and impossible in 4.3% of their patients.\nWe can graphically present these proportions for all doctors in a barplot using the following code. Because the proportions are calculated out of the total number of patients each doctor has seen, it makes sense to plot the physicians along the x-axis.\n\nR CodePlots\n\n\n\nbarplot(height = t(epi_prop_tab),\n        legend.text = TRUE,\n        beside = TRUE,\n        col = c(\"darkslategray\", \"darkslategray3\", \"darkslategray4\"),\n        main = \"Proportion of doctor's patients in each level of Ease variable\",\n        xlab = \"Doctor\",\n        ylab = \"Proportion\")\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nTask\n\n\nCreate the following barplot showing the proportion of passengers in each class who survived and the proportion who did not.\n\nPlots\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nSolution\n\n\nR CodePlots\n\n\n\nsurv_prop &lt;- prop.table(table(TITANIC3$pclass, TITANIC3$survived), margin = 1)\n\nbarplot(height = t(surv_prop),\n        legend.text = TRUE,\n        beside = TRUE,\n        main = \"Proportion of Passengers Surviving the Titanic Sinking in each Class\",\n        xlab = \"Class\",\n        ylab = \"Proportion\")\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nTo learn more about presenting bivariate qualitative data, see Sections 2.7.1 Two-Way Contingency Tables and 2.7.2 Graphical Representations of Two-Way Contingency Tables of Probability and Statistics with R.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Qualitative Data</span>"
    ]
  },
  {
    "objectID": "02-quantitative.html",
    "href": "02-quantitative.html",
    "title": "3  Quantitative Data",
    "section": "",
    "text": "3.1 Stem and Leaf Plots\nQuantitative data is the term used to describe numerical data. Essentially, data that can be “quantified” is quantitative data. That is, any information that can be measured, counted or given a numerical value. This could be things such as individuals’ height, weight or age, or distances or prices of items.\nQuantitative data can be thought of having different “properties”, including its shape, center and spread. There are several ways in which quantitative data can be presented to better understand these properties.\nWhen dealing with quantitative data, a good way to quickly get an idea of the spread of the data is with a stem and leaf plot. This arranges the observations by increasing numerical value and splits each value into a “stem” and a “leaf”.\nThe stem is the beginning of the numerical value - this could be multiples of 10, 100, 1000 or any value really. The leaf is always a single digit, indicating the value of the observation from the data.\nStem and leaf plots can become increasingly hard to read when using large data sets. They are clearest, and easiest to interpret, when they are constructed for relatively small data sets (fewer than 100 observations roughly).\nThe function for creating a stem and leaf plot in R is stem(). The only necessary argument for this function is x = which is the vector of the numeric values.\nWe can create a stem and leaf plot showing the weight (in kg) of each patient included in the EPIDURAL data set using the following code. The weights are stored in the variable called kg.\nThe first row in this plot tells us that the lightest patient is 48kg, the next two lightest partients are both 57kg and so on. The argument scale = 2 has been included so that the stem shows a new row for every 10kg in weight.\nThe stem may not always be multiples of 10, so pay close attention to the message given The decimal point is 1 digit(s) to the right of the | which will tell you where the decimal point lies.\nSee Section 2.4.1 Stem-and-Leaf Plots of Probability and Statistics with R for additional examples.",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Quantitative Data</span>"
    ]
  },
  {
    "objectID": "02-quantitative.html#sec-stem",
    "href": "02-quantitative.html#sec-stem",
    "title": "3  Quantitative Data",
    "section": "",
    "text": "R CodeOutput\n\n\n\nstem(x = EPIDURAL$kg,\n     scale = 2)\n\n\n\n\n\n\n  The decimal point is 1 digit(s) to the right of the |\n\n   4 | 8\n   5 | 77999\n   6 | 0133567779\n   7 | 01122244455679999\n   8 | 001233334455566666799\n   9 | 000011233445678\n  10 | 334568\n  11 | 23446\n  12 | 1\n  13 | 14\n  14 | 2\n  15 | \n  16 | 8\n\n\n\n\n\n\n\n\n\nTask\n\n\nHow would you describe the shape of the distribution of patients’ weights?\nLeft-skewedSymmetricRight-skewedCan’t tell",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Quantitative Data</span>"
    ]
  },
  {
    "objectID": "02-quantitative.html#sec-hist",
    "href": "02-quantitative.html#sec-hist",
    "title": "3  Quantitative Data",
    "section": "3.2 Histograms",
    "text": "3.2 Histograms\nHistograms are a widely used tool for graphically summarizing quantitative data. They look similar to barplots (for qualitative data), however the width of the “bins” (or bars) can be changed in a histogram. This means that you can choose to include more or fewer observations in each bin shown on the plot.\nThe function to create a histogram in R is hist(). This function takes the following arguments:\n\nx =: this is the vector of numeric values that should be used to create the histogram.\nbreaks =: this is vector giving the breakpoints that should be used to create the intervals each bar of the histogram represents, or it can be a single value specifying the number of bins that should be in the histogram.\nfreq =: this takes the values TRUE or FALSE which indicate whether a frequency histogram (TRUE) or a density histogram (FALSE) should be created. By default, a frequency histogram will be created.\nright =: this takes the values TRUE and FALSE which indicate whether the intervals used to create the bins should be right-closed (TRUE) e.g. \\((x_1, x_2]\\), or left-closed (FALSE) e.g. \\([x_1, x_2)\\). By default the intervals will be right-closed.\ninclude.lowest =: this takes the values TRUE or FALSE which indicates whether the lowest value in the data should be included in the first bin, when right-closed intervals are used.\n\nThe only argument that needs to be provided to the hist() function is x =.\nWe can create a histogram showing the weight of patients from the EPIDURAL data set using the following code.\n\nR CodePlots\n\n\n\nhist(x = EPIDURAL$kg,\n     breaks = seq(from = 40, to = 180, by = 10),\n     col = \"coral1\",\n     main = \"Patient Weights from the EPIDURAL data set\",\n     xlab = \"Weight (kg)\")\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nThis code creates a vector using the seq() function to use with the breaks = argument. This vector is \\(\\begin{bmatrix}40&50&60&\\dots&180 \\end{bmatrix}^\\intercal\\), so the histogram has a bin including all observations between 40kg and 50kg, between 50kg and 60kg and so on. Because we have left out the right = argument, these intervals are right-closed. This means they are of the form (40, 50], (50, 60], …, (170, 180] where “(x” represents “greater than x” and “y]” represents “less than or equal to y”).\nThe freq = argument has also been left out of this code, so a frequency histogram is created by default. In this case, the height of a bar represents the number of patients that fall into that particular interval.\nIf we add in the argument freq = FALSE a density histogram is created instead. The shape of the histogram is identical to the frequency histogram, however the scale on the y-axis has changed. Now, the height of each bar represents the proportion of the patients that fall into that particular interval.\n\nR CodePlots\n\n\n\nhist(x = EPIDURAL$kg,\n     breaks = seq(from = 40, to = 180, by = 10),\n     freq = FALSE,\n     col = \"coral1\",\n     main = \"Patient Weights from the EPIDURAL data set\",\n     xlab = \"Weight (kg)\")\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nWe can instead provide a single value to the breaks = argument. Most of the time, this defines the number of bins that should be used in the histogram, however sometimes the plot created will have a slightly different number from what you specify. This is because R uses “pretty values”, which essentially means a number of bins will be selected for you, to best produce a sensible looking histogram.\nFor example, when we specify breaks = 4, there are 4 bars in the histogram produced. This is because it makes sense to split the range of our data into the four sets (0, 50], (50, 100], (100, 150] and (150, 200].\n\nR CodePlots\n\n\n\nhist(x = EPIDURAL$kg,\n     breaks = 4,\n     col = \"coral1\",\n     main = \"Patient Weights from the EPIDURAL data set\",\n     xlab = \"Weight (kg)\")\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nIf we instead specify that breaks = 5, note that the histogram produced actually has 7 intervals. This is because the “pretty values” used means that R tries to split the range of our data into at least 5 intervals of the same size, where the upper and lower limit of each interval is an integer. In this case, the intervals used are (40, 60], (60, 80], (80, 100], …, (160, 180].\nIt is always a good idea to produce histograms where different intervals have been used to construct the bins to get a proper sense for the shape of the data.\n\nR CodePlots\n\n\n\nhist(x = EPIDURAL$kg,\n     breaks = 5,\n     col = \"coral1\",\n     main = \"Patient Weights from the EPIDURAL data set\",\n     xlab = \"Weight (kg)\")\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nTask\n\n\nWhat single value would you provide to the breaks = argument to create the density histogram of passenger ages on the Titanic shown below?\n\n\n\n\n\n\n\n\n\n\nR Code\n\n\n\nhist(x = TITANIC$age,\n\nbreaks =,\n\n\nfreq = FALSE, main = \"Ages of Passengers on the Titanic\", xlab = \"Age\")\n\n\n\n\n\nIf you instead wanted to provide the argument breaks = with a sequence generated using the seq() function, how would you do this?\n\nR Code\n\n\n\nhist(x = TITANIC$age,\n\nbreaks = seq(),\n\n\nfreq = FALSE, main = \"Ages of Passengers on the Titanic\", xlab = \"Age\")\n\n\n\n\n\n\n\nSolution\n\nBoth chunks of code below will produce the same histogram shown above.\n\nR CodePlots\n\n\n\nhist(x = TITANIC3$age,\n     breaks = 8,\n     freq = FALSE,\n     main = \"Ages of Passengers on the Titanic\",\n     xlab = \"Age\")\n\nhist(x = TITANIC3$age,\n     breaks = seq(from = 0, to = 80, by = 10),\n     freq = FALSE,\n     main = \"Ages of Passengers on the Titanic\",\n     xlab = \"Age\")\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nThere are several different ways that the breaks used to construct the intervals for a histogram can be constructed. You can read more about these methods in Section 2.4.3.1 Histograms from Probability and Statistics with R.",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Quantitative Data</span>"
    ]
  },
  {
    "objectID": "02-quantitative.html#sec-kernel",
    "href": "02-quantitative.html#sec-kernel",
    "title": "3  Quantitative Data",
    "section": "3.3 Kernel Density Estimators",
    "text": "3.3 Kernel Density Estimators\nSince the shape of histograms can change so drastically based on the intervals defined, they can sometimes be misleading when trying to determine the shape of data. Kernel density estimators offer a more reliable indication of the shape of data by taking weighted localised averages (we don’t need to know the technical details for our purposes).\nThe function to create a kernel density estimator in R is density(x). The only argument needed for this function is:\n\nx =: this is the vector of data for which the kernel density estimate should be computed.\n\nThis creates a list object in R which can be used to show the kernel density estimate in a plot. In order to superimpose the density estimate over the histogram of the data, we can use the lines() function.\nFor example, the following code creates the histogram of the patients’ weights, and then superimposes the kernel density estimate dens on top.\n\nR CodePlots\n\n\n\nhist(x = EPIDURAL$kg,\n     breaks = seq(from = 40, to = 180, by = 10),\n     freq = FALSE,\n     col = \"grey90\",\n     main = \"Patient Weights from the EPIDURAL data set\",\n     xlab = \"Weight (kg)\")\n\ndens &lt;- density(x = EPIDURAL$kg)\n\nlines(dens, col = \"coral1\", lwd = 2)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nWe can see that the distribution of all patients’ weights is right skewed and that the mode is around 85kg.\nIn order to use lines() to superimpose the kernel density estimate, the histogram created must be a density histogram. It is also necessary to create a plot first because the lines() function only builds on top of a pre-existing plot. Within the lines() function, the additional arguments col = and lwd = have been included to set the colour and line width respectively of the kernel density estimate.\nIn order to show a kernel density estimate in its own plot, we can use the function plot(). The following code can be used to show the same kernel density estimate as above, but this time without the histogram beneath it.\n\nR CodePlots\n\n\n\nplot(dens, col = \"coral1\", lwd = 2,\n     main = \"Density of Patient Weights\")\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nTask\n\n\nCreate a plot only showing the kernel density estimate for distribution of passenger ages on the Titanic.\n\n\nSolution\n\n\nR CodePlots\n\n\n\nage_dens &lt;- density(x = TITANIC3$age, na.rm = TRUE)\n\nplot(age_dens, col = \"gray32\", lwd = 2,\n     main = \"Density of Passeneger Ages\")\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nTo read more about how kernel density estimates are constructed, see Section 2.4.3.2 Kernel Density Estimators in Probability and Statistics with R.",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Quantitative Data</span>"
    ]
  },
  {
    "objectID": "03-compare.html",
    "href": "03-compare.html",
    "title": "4  Comparing Samples",
    "section": "",
    "text": "4.1 Comparing histograms\nIn statistical analysis it is common to want to compare two samples from different groups or “populations”. When comparing two different groups of data, we might want to answer questions about the properties of the data such as:\nIn order to answer these questions, graphical methods of presenting the data can be useful such as histograms or density plots.\nFor example, we might wish to compare the distribution of the BMI of patients who are given the epidural anesthetic in the traditional sitting position with the distribution of the BMI of patients in the hamstring stretch group. In order to do this, we first need to calculate the BMI of all patients in the EPIDURAL data set, since BMI is not one of the variables measured.\nThen, in order to make it easier to plot the BMI for the two groups separately, we can create two subsets of the data using the subset() function. The first, BMI_sitting, contains the BMI values for the patients that were given the epidural anesthetic in the traditional sitting position. BMI_hamstring similarly stores BMI values, but for the patients given the anesthetic in the hamstring stretch position.\nFinally, we want to actually view the shape of the distributions for the two groups to see if they are similar. We can do this using two separate histograms of BMI. It doesn’t make any sense to compare histograms when the bin widths or the units used on the axes are different, so the following code ensures that, for both histograms, the width of each bin is 5 units, the x-axes range from 20 to 60 and the y-axes range from 0 to 17.\nThe line of code par(mfrow = c(1, 2)) is used to view the histograms side by side. This means that plots will be created in a \\(1\\times 2\\) grid (i.e. 1 row and 2 columns), so two plots can be seen together. par(mfrow = c(1, 1)) sets this back to only one plot being shown at a time.",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Comparing Samples</span>"
    ]
  },
  {
    "objectID": "03-compare.html#comparing-histograms",
    "href": "03-compare.html#comparing-histograms",
    "title": "4  Comparing Samples",
    "section": "",
    "text": "R Code\n\n\n\nEPIDURAL$BMI &lt;- EPIDURAL$kg/(EPIDURAL$cm/100)^2\n\n\n\n\n\n\nR Code\n\n\n\nBMI_sitting &lt;- subset(x = EPIDURAL,\n                      subset = (treatment == \"Traditional Sitting\"),\n                      select = BMI)\n\nBMI_hamstring &lt;- subset(x = EPIDURAL,\n                        subset = (treatment == \"Hamstring Stretch\"),\n                        select = BMI)\n\n\n\n\n\n\n\nR CodePlots\n\n\n\npar(mfrow = c(1, 2))\n\nhist(x = BMI_sitting$BMI,\n     breaks = seq(from = 20, to = 60, by = 5),\n     col = \"burlywood\",\n     ylim = c(0, 17),\n     main = \"Traditional Sitting Group\",\n     xlab = \"BMI\",\n     ylab = \"Frequency\")\n\nhist(x = BMI_hamstring$BMI,\n     breaks = seq(from = 20, to = 60, by = 5),\n     col = \"burlywood4\",\n     ylim = c(0, 17),\n     main = \"Hamstring Stretch Group\",\n     xlab = \"BMI\",\n     ylab = \"Frequency\")\n\npar(mfrow = c(1, 1))\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nTask\n\n\nHow would you compare the two distributions shown in the histograms above?\n\n Both distributions are skewed to the left. Both distributions are skewed to the right. The distribution for the traditional sitting group is more extremely skewed than the distribution for the hamstring stretch group. The distribution for the hamstring stretch group is more extremely skewed than the distribution for the traditional sitting group. The distribution for the traditional sitting group is symmetric whereas the distribution for the hamstring stretch group is skewed.",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Comparing Samples</span>"
    ]
  },
  {
    "objectID": "03-compare.html#comparing-density-estimates",
    "href": "03-compare.html#comparing-density-estimates",
    "title": "4  Comparing Samples",
    "section": "4.2 Comparing density estimates",
    "text": "4.2 Comparing density estimates\nRather than histograms, we may wish to compare the distributions of BMI in these two groups using kernel density estimates. The following code plots the kernel density estimate of the BMI for the traditional sitting group against the estimate of the distribution for the BMI of the hamstring stretch group.\n\nR CodePlots\n\n\n\nplot(density(x = BMI_sitting$BMI),\n     col = \"burlywood\",\n     lwd = 2,\n     xlim = c(20, 60),\n     main = \"Kernel Density Estimates of BMI\",\n     xlab = \"BMI\")\n\nlines(density(x = BMI_hamstring$BMI),\n      col = \"burlywood4\",\n      lwd = 2)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nAgain we can see that both distributions are right-skewed, but that the skew for the hamstring stretch group is slightly more extreme.\n\nFurther examples of comparing the distributions of two samples are given in Section 2.7.3 Comparing Samples of Probability and Statistics with R.",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Comparing Samples</span>"
    ]
  },
  {
    "objectID": "03-compare.html#sec-qq",
    "href": "03-compare.html#sec-qq",
    "title": "4  Comparing Samples",
    "section": "4.3 QQ Plots",
    "text": "4.3 QQ Plots\nA useful plot for assessing whether data is normally distributed is a normal quantile-quantile (QQ) plot. This uses the quantiles of the standard normal distribution as the \\(x\\) co-ordinates and the quantiles from the data as the \\(y\\) co-ordinates. If the data of interest follows a normal distribution, then we would expect to see the points lying roughly along a straight line.\nNormal QQ plots can be created in R using the function qqnorm(). The only argument this function needs is y = which gives the vector of data we want to check is normally distributed or not.\nWe can add a straight line to an existing normal QQ plot using the function qqline(), which also takes the same vector of data in the argument y =.\nThe code below creates side-by-side normal QQ plots comparing the distributions of BMI in the group of patients given the epidural anesthetic in the traditional sitting position and in the hamstring stretch position with a standard normal distribution. The argument main = has been included in each qqnorm() function to show the group in the title of the plot.\n\nR CodeOutput\n\n\n\npar(mfrow = c(1, 2))\n\nqqnorm(y = BMI_sitting$BMI,\n       main = \"Traditional Sitting Group\")\nqqline(y = BMI_sitting$BMI)\n\nqqnorm(y = BMI_hamstring$BMI,\n       main = \"Hamstring Stretch Group\")\nqqline(y = BMI_hamstring$BMI)\n\npar(mfrow = c(1, 1))\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nWe can see in both of these QQ plots that the majority of points roughly follow the plotted straight line. For both groups, the higher quantiles in the distribution of BMI start to stray away from this straight line. This is because both these distributions are right-skewed, suggesting they do not follow a normal distribution.\nWe can again see that the distribution for the hamstring stretch group (the right-hand plot) is more extremely right-skewed than that for the traditional sitting group. This is shown in these plots because the large quantiles stray further from the straight line in the hamstring stretch group than in the traditional sitting group.\n\n\nTask\n\n\nCreate a new subset of the TITANIC3 data frame that contains the ages of all passengers who survived the sinking. Plot the quantiles of the distribution of age against the quantiles of a standard normal distribution in a QQ plot.\n\n\nSolution\n\n\nR CodePlots\n\n\n\nage_survived &lt;- subset(x = TITANIC3,\n                       subset = (survived == \"Yes\"),\n                       select = age)\n\nqqnorm(y = age_survived$age)\nqqline(y = age_survived$age)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nTask\n\n\nDo you think that the ages of passengers who survived the sinking of the Titanic follow a normal distribution?\nYesNoCan’t say\n\n\n\nYou can read more about how normal QQ plots are constructed in Section 4.3.7 Normal (Gaussian) Distribution in Probability and Statistics with R (specifically pages 301-306).",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Comparing Samples</span>"
    ]
  },
  {
    "objectID": "04-exercises.html",
    "href": "04-exercises.html",
    "title": "5  Further Exercises",
    "section": "",
    "text": "Exercise 1\nThe data set VIT2005 from the PASWR2 package stores information relating to 218 different apartments in Vitoria, Spain. For a full list of the variables included and the information they represent, use the code help(VIT2005).\nYou can load VIT2005 into your Environment tab using the following code.",
    "crumbs": [
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Further Exercises</span>"
    ]
  },
  {
    "objectID": "04-exercises.html#exercise-1",
    "href": "04-exercises.html#exercise-1",
    "title": "5  Further Exercises",
    "section": "",
    "text": "R Code\n\n\n\nlibrary(PASWR2)\ndata(\"VIT2005\")\n\n\n\n\n\nThe variable out details how much of an apartment is exposed to the elements. It has levels \"E25\", \"E50\", \"E75\" and \"E100\" corresponding to 25%, 50%, 75% and 100% exposure respectively.\nCreate a frequency table, a pie chart and a barplot in base R which show the number of apartments from VIT2005 within each category of the out variable.\nYou may wish to relabel and reorder the categories of out first of all.\nThe variable area is a numeric variable detailing the size (in square metres) of each apartment.\n\nCreate a new categorical variable, called size, indicating whether an apartment is considered \"Small\", \"Medium\" or \"Large\". Apartments smaller than 100m2 should be labelled as \"Small\", those between 100m2 and 150m2 should be labelled as \"Medium\" and any apartments larger than 150m2 should be labelled as \"Large\".\nThe function cut() will be useful for this.\nUsing this new categorical variable size, create a barplot in base R to investigate whether the proportion of apartments in each level of exposure is different for small, medium and large apartments.\nMake sure that apartment size is placed along the x-axis, there is a different bar for each level of exposure and that the y-axis shows proportion, not frequency.\n\ntotalprice gives the market price (in Euros) for each apartment.\n\nCreate a histogram in base R showing the shape of the distribution of apartment prices. Superimpose a kernel density estimate of the distribution on the histogram.\nInvestigate whether the distribution of apartment price is normal using a QQ plot. Do you think this is a normal distribution?\n\nUse three histograms, created using base R, to compare the distributions of apartment prices for small, medium and large apartments. Make sure you are using the same breaks = and range along the y-axes in all plots so that the distributions can be easily compared.\nWhat differences are there between these distributions?\nRemember to subset the data first so that the first plot is only for prices of small apartments etc.",
    "crumbs": [
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Further Exercises</span>"
    ]
  },
  {
    "objectID": "04-exercises.html#exercise-2",
    "href": "04-exercises.html#exercise-2",
    "title": "5  Further Exercises",
    "section": "Exercise 2",
    "text": "Exercise 2\n\nThe file “babies.csv” contains data on the birth weight of babies born to different mothers and whether each mother currently smokes or does not smoke (a full list of the variables included in this data set can be found here).\nDownload the data from Moodle and load the data set into your Environment tab using the code below and use babies to recreate the following two plots using base R.\n\nR Code\n\n\n\nbabies &lt;- read.csv(file = \"babies.csv\")\n\n\n\n\n\nPlots\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nPlots",
    "crumbs": [
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Further Exercises</span>"
    ]
  },
  {
    "objectID": "04-exercises.html#exercise-3",
    "href": "04-exercises.html#exercise-3",
    "title": "5  Further Exercises",
    "section": "Exercise 3",
    "text": "Exercise 3\n\nNote This exercise asks you to use the ggplot2 package to create plots. Use it as additional practice only once you have looked at Appendix A of the lab.\nThe file “babies.csv” contains data on the birth weight of babies born to different mothers and whether each mother currently smokes or does not smoke (a full list of the variables included in this data set can be found here).\nDownload the data from Moodle and load the data set into your Environment tab using the code below and use babies to recreate the following two plots using ggplot2.\n\nR Code\n\n\n\nbabies &lt;- read.csv(file = \"babies.csv\")\n\n\n\n\n\nPlots\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nPlots",
    "crumbs": [
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Further Exercises</span>"
    ]
  },
  {
    "objectID": "05-summary.html",
    "href": "05-summary.html",
    "title": "6  Summary of Functions",
    "section": "",
    "text": "Barplots\nbarplot(height = ,\n        legend.text = ,\n        beside = FALSE,\n        col = ,\n        main = ,\n        xlab = ,\n        ylab = ,\n        ylim = )",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Summary of Functions</span>"
    ]
  },
  {
    "objectID": "05-summary.html#dot-charts",
    "href": "05-summary.html#dot-charts",
    "title": "6  Summary of Functions",
    "section": "Dot Charts",
    "text": "Dot Charts\n\ndotchart(x = ,\n         bg = ,\n         main = ,\n         xlab = ,\n         ylab = )",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Summary of Functions</span>"
    ]
  },
  {
    "objectID": "05-summary.html#pie-charts",
    "href": "05-summary.html#pie-charts",
    "title": "6  Summary of Functions",
    "section": "Pie Charts",
    "text": "Pie Charts\n\npie(x = ,\n    radius = ,\n    col = ,\n    main = )",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Summary of Functions</span>"
    ]
  },
  {
    "objectID": "05-summary.html#stem-and-leaf-plots",
    "href": "05-summary.html#stem-and-leaf-plots",
    "title": "6  Summary of Functions",
    "section": "Stem and Leaf Plots",
    "text": "Stem and Leaf Plots\n\nstem(x = , scale = 1)",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Summary of Functions</span>"
    ]
  },
  {
    "objectID": "05-summary.html#histograms",
    "href": "05-summary.html#histograms",
    "title": "6  Summary of Functions",
    "section": "Histograms",
    "text": "Histograms\n\nhist(x = ,\n     breaks = ,\n     freq = TRUE,\n     right = TRUE,\n     include.lowest = TRUE,\n     col = ,\n     main = ,\n     xlab = ,\n     ylab = ,\n     ylim = )",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Summary of Functions</span>"
    ]
  },
  {
    "objectID": "05-summary.html#kernel-density-estimators",
    "href": "05-summary.html#kernel-density-estimators",
    "title": "6  Summary of Functions",
    "section": "Kernel Density Estimators",
    "text": "Kernel Density Estimators\n\ndensity(x)\n\n\nlines(col = , lwd = )\n\n\nplot(col = ,\n     lwd = ,\n     main = ,\n     xlab = ,\n     ylab = ,)",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Summary of Functions</span>"
    ]
  },
  {
    "objectID": "05-summary.html#qq-plots",
    "href": "05-summary.html#qq-plots",
    "title": "6  Summary of Functions",
    "section": "QQ Plots",
    "text": "QQ Plots\n\nqqnorm(y = , main = )\n\n\nqqline(y = )",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Summary of Functions</span>"
    ]
  },
  {
    "objectID": "06-ggplot.html",
    "href": "06-ggplot.html",
    "title": "Appendix A — ggplot2",
    "section": "",
    "text": "A.1 Barplots\nIn Sections 2, 3 and 4, the functions used to create the plots and graphs we have seen so far exist in “base R”. This means that the functions, such as barplot(), hist() and density(), can just be used without having to first load any specific packages.\nOne useful package that can be used to create plots and graphs is called ggplot2 (the “gg” stands for “grammar of graphics”). As the developers put it:\nIn order to use ggplot2, you must make sure it is first installed on your device and then load it into your RStudio session.\nGraphs made using ggplot2 are done so in layers (different lines of code). Data is mapped to a geometric object (this tells R what type of plot to construct) and the variables are mapped to different aspects of the plot through an aesthetic function (this states, for example, which variables should be used for the x-axis and which for the y-axis). Other visual elements of the plot can be altered with additional layers.\nThe basic setup of a ggplot2 graph starts with the function ggplot(). The argument that this function takes is:\nAdditional layers can be added after the ggplot() function using the + operator. For example, the standard setup for a graph using ggplot2 would be as follows in the code below.\nHere, you would replace dataframe with the name of the data frame you want to use. The layer geom_object() would also be replaced with the function for the geometric object you want to use. The aes() function is where you can specify what variables you want to include in your plot.\nSome of the geometric objects you can use with ggplot2, as well as their associated options for within the aesthetic function, aes(), are listed in Table A.1.\nLet’s make our first graph using ggplot2. We can recreate the barplot showing the number of patients from the EPIDURAL data set that fall into the three categories indicating how easy it was to find where to administer the epidural anesthetic, seen in Section 2.2.\nTo create the basic barplot, we only need to provide the arguments data = EPIDURAL within the ggplot() function. We want to use the geometric object function geom_bar() to create a barplot and provide x = ease within the aes() function which maps the levels of ease to the x-axis.\nThis creates a very simplistic barplot, where the bars are labelled with each level of the variable ease and are coloured grey. ggplot2 uses a default “theme” which colours the background grey and includes grid lines in white.\nWe can add titles and axes labels to ggplot2 graphs in an additional layer using the function labs(). This takes the arguments title =, x = and y = as shown in the code below.\nWe were also able to produce barplots in base R where the height of each bar was split based on the levels of a categorical variable (for example, splitting by the different physicians in Section 2.5). We can do the same using ggplot2 by including the aesthetic argument fill = doctor in the aes() function. This means that we want to “fill” each bar to show how many of the patients in each level of ease were seen by each physician.\nNote that the colours used by ggplot2 are chosen automatically. A different one is assigned to each doctor because we have used the argument fill = doctor. A legend is also included in the plot automatically, showing which colour corresponds to which doctor. The title “doctor” is used for the legend since this is the variable name.\nTo change the title of the legend, we need to include another layer in the code with the function guides(). We can specify the title using guide_legend(\"Title\") as shown in the code below. This is passed to the argument fill = because “doctor” has been passed to the same fill = argument within the aes() function in geom_bar().\nBy default, barplots showing bivariate data are “stacked” in ggplot2. If we wanted to create separate bars for each doctor within the different levels of ease, then we need to include the argument position = \"dodge\" within the geom_bar() function. Note that this is outside the aes() function, as shown in the code below.",
    "crumbs": [
      "Appendices",
      "<span class='chapter-number'>A</span>  <span class='chapter-title'>`ggplot2`</span>"
    ]
  },
  {
    "objectID": "06-ggplot.html#sec-ggbars",
    "href": "06-ggplot.html#sec-ggbars",
    "title": "Appendix A — ggplot2",
    "section": "",
    "text": "R CodePlots\n\n\n\nggplot(data = EPIDURAL) +\n  geom_bar(aes(x = ease))\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nR CodePlots\n\n\n\nggplot(data = EPIDURAL) +\n  geom_bar(aes(x = ease)) +\n  labs(title = \"Ease of Locating Anesthesia Administering Location in Patients\",\n       x = \"Ease\", y = \"Frequency\")\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nR CodePlots\n\n\n\nggplot(data = EPIDURAL) +\n  geom_bar(aes(x = ease, fill = doctor)) +\n  labs(title = \"Ease of Locating Anesthesia Administering Location in Patients\",\n       x = \"Ease\", y = \"Frequency\")\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nR CodePlots\n\n\n\nggplot(data = EPIDURAL) +\n  geom_bar(aes(x = ease, fill = doctor), position = \"dodge\") +\n  labs(title = \"Ease of Locating Anesthesia Administering Location in Patients\",\n       x = \"Ease\", y = \"Frequency\") +\n  guides(fill = guide_legend(\"Physician\"))\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nTask\n\n\nComplete the code below to create the barplot showing the number of passengers who survived and did not survive in each class from the TITANIC3 data set beneath.\n\nR CodePlots\n\n\n\nggplot(data = TITANIC) +\n\ngeom_bar(aes(x =, fill =, position =) +\n\n\nlabs(title = \"Passengers Surviving the Titanic Sinking in each Class\",\n\n\nx = \"Class\", y = \"Frequency\") +\n\n\nguides(= guide_legend(\"Did the passenger survive?\"))\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nSolution\n\n\nR CodePlots\n\n\n\nggplot(data = TITANIC3) +\n  geom_bar(aes(x = pclass, fill = survived), position = \"dodge\") +\n  labs(title = \"Passengers Surviving the Titanic Sinking in each Class\",\n       x = \"Class\", y = \"Frequency\") +\n  guides(fill = guide_legend(\"Did the passenger survive?\"))",
    "crumbs": [
      "Appendices",
      "<span class='chapter-number'>A</span>  <span class='chapter-title'>`ggplot2`</span>"
    ]
  },
  {
    "objectID": "06-ggplot.html#sec-gghist",
    "href": "06-ggplot.html#sec-gghist",
    "title": "Appendix A — ggplot2",
    "section": "A.2 Histograms",
    "text": "A.2 Histograms\nHistograms are easy to make in ggplot2 using the function geom_histogram(). It is possible to specify the binwidth used to create the bars by including the argument binwidth = within this function (but outside the aes() function).\nThe code below creates a histogram showing the weights of all patients in the EPIDURAL data set. The binwidth has been set so that each bar has a range of 10kg.\n\nR CodePlots\n\n\n\nggplot(data = EPIDURAL) +\n  geom_histogram(aes(x = kg), binwidth = 10) +\n  labs(title = \"Patient Weights from the EPIDURAL data set\",\n       x = \"Weight (kg)\", y = \"Frequency\")\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nWe can change the binwidth = argument so that the interval each bar covers is increased or decreased. In the code below, we have changed the argument to binwidth = 50 so each bar covers a range of 50kg, resulting in fewer and wider bars.\n\nR CodePlots\n\n\n\nggplot(data = EPIDURAL) +\n  geom_histogram(aes(x = kg), binwidth = 50) +\n  labs(title = \"Patient Weights from the EPIDURAL data set\",\n       x = \"Weight (kg)\", y = \"Density\")\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nTask\n\n\nComplete the code to create a histogram, using ggplot2, showing the ages of all passengers on the Titanic.\n\nR CodePlots\n\n\n\nggplot(data = TITANIC3) +\n\ngeom_histgeom_histogramhistogramgghistogram(, binwidth = 10) +\n\n\nlabs(title = \"Ages of Passengers on the Titanic\",\n\n\nx = \"Age\", y = \"Frequency\")\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nSolution\n\n\nR CodePlots\n\n\n\nggplot(data = TITANIC3) +\n  geom_histogram(aes(x = age), binwidth = 10) +\n  labs(title = \"Ages of Passengers on the Titanic\",\n       x = \"Age\", y = \"Frequency\")",
    "crumbs": [
      "Appendices",
      "<span class='chapter-number'>A</span>  <span class='chapter-title'>`ggplot2`</span>"
    ]
  },
  {
    "objectID": "06-ggplot.html#sec-ggkern",
    "href": "06-ggplot.html#sec-ggkern",
    "title": "Appendix A — ggplot2",
    "section": "A.3 Kernel Density Estimators",
    "text": "A.3 Kernel Density Estimators\nTo create plots of kernel density estimates in ggplot2, we use the function geom_density(). A simple plot showing the kernel density estimate of the weights of all patients from the EPIDURAL data set is created using the code below.\n\nR CodePlots\n\n\n\nggplot(data = EPIDURAL) +\n  geom_density(aes(x = kg)) +\n  labs(title = \"Density of Patient Weights\",\n       x = \"Weight (kg)\", y = \"Density\")\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nWe are able to superimpose a density estimate above a histogram by creating the histogram and density curve as two separate layers after the ggplot() function. For example, in the code below the histogram is created first and then the density plot is built on top of it.\nRemember that the histogram needs to be a density histogram, and not a frequency histogram, in order to be able to superimpose a density curve. We can create a density histogram in ggplot2 by including the argument y = after_stat(density) within the aes() function in geom_histogram().\n\nR CodePlots\n\n\n\nggplot(data = EPIDURAL) +\n  geom_histogram(aes(x = kg, y = after_stat(density)), binwidth = 10) +\n  geom_density(aes(x = kg)) +\n  labs(title = \"Density of Patient Weights\",\n       x = \"Weight (kg)\", y = \"Density\")\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nSection 4 looked at comparing the distributions of BMI values for patients in the two treatment groups (traditional sitting and hamstring stretch). We can use ggplot2 to create side-by-side plots showing a histogram and kernel density estimate of these distributions for the two groups.\nIn order to create a plot for each treatment group, we need to use the function facet_grid(). This splits the plots made across different rows and/or columns. We need to include the names of categorical variables in the style of a formula using the ~ operator. The levels of the variable to the left of ~ will make up the rows, and if a variable is included to the right of ~ then the levels of this will make up the columns that the plots are split across. Using the formula . ~ treatment means we have one column for the traditional sitting group and another for the hamstring stretch group.\nIn the code below we have coloured the histogram a different colour for each group using the argument fill = treatment within the aes() argument in geom_histogram(). This automatically creates a legend showing which colour is for which group, but because the columns of the plot are already labelled, this legend is unnecessary. We can remove the legend by including fill = \"none\" within the guides() argument.\n\nR CodePlots\n\n\n\nggplot(data = EPIDURAL) +\n  geom_histogram(aes(x = BMI, y = after_stat(density), fill = treatment), binwidth = 5) +\n  geom_density(aes(x = BMI)) +\n  facet_grid(. ~ treatment) +\n  labs(title = \"Density of Patients' BMI\",\n       x = \"Weight (kg)\", y = \"Density\") +\n  guides(fill = \"none\")\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nWe can see from the plots above that both distributions are right skewed, however the skew in the hamstring stretch group is slightly more extreme.\n\n\nTask\n\n\nComplete the code below to create the following histogram and density plots which show the distribution of passenger age for each class of passengers on board the Titanic.\n\nR CodePlots\n\n\n\nggplot(data = TITANIC3) +\n\ngeom_histogram(aes(x = age, y =, fill =),\n\n\nbinwidth = 5) +\n\n\ngeom_density(aes(x = age)) +\n\n\nfacet_grid() +\n\n\nlabs(title = \"Density of Passenger Ages\",\n\n\nx = \"Age\", y = \"Density\") +\n\n\nguides(fill = \"none\")\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nSolution\n\n\nR CodePlots\n\n\n\nggplot(data = TITANIC3) +\n  geom_histogram(aes(x = age, y = after_stat(density), fill = pclass),\n                 binwidth = 5) +\n  geom_density(aes(x = age)) +\n  facet_grid(pclass ~ .) +\n  labs(title = \"Density of Passenger Ages\",\n       x = \"Age\", y = \"Density\") +\n  guides(fill = \"none\")\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nggplot2 can be used to create many different types of plots and graphs, not just those detailed above. For further examples of constructing barplots, histograms and kernel density estimates in ggplot2, as well as an introduction to the other plots it can be used to create, see Section 2.9.5 Graphics with ggplot2 of Probability and Statistics with R.",
    "crumbs": [
      "Appendices",
      "<span class='chapter-number'>A</span>  <span class='chapter-title'>`ggplot2`</span>"
    ]
  }
]