{
  "hash": "f254425cf60cac604cb2e411dae24a28",
  "result": {
    "engine": "knitr",
    "markdown": "# Sampling distribution for $\\bar X - \\bar Y$\n\n\n\n\n\nFor two independent normal random variables $X$ and $Y$, with distributions $X\\sim N(\\mu_X,\\,\\sigma_X)$ and $Y\\sim N(\\mu_Y,\\,\\sigma_Y)$ respectively, the distribution of $\\bar X-\\bar Y$ is,\n\n$$\n\\bar X-\\bar Y\\sim N\\Bigg(\\mu_X-\\mu_Y,\\,\\sqrt{\\frac{\\sigma_X^2}{n_X}+\\frac{\\sigma_y^2}{n_Y}}\\Bigg)\n$$\n\nwhere $n_X$ is the size of the sample taken from the distribution for $X$ and $n_Y$ is the size of the sample taken from the distribution for $Y$.\n\nWe can show that this result is true by sampling from the distributions of $X$ and $Y$ in R and creating a new sampling distribution for $\\bar X -\\bar Y$.\n\nSpecifically, we will;\n\n1. Draw $m=$ 20,000 samples of size $n_X=$ 120 from the distribution $X\\sim N(90,\\,12)$ and calculate the mean of each of these samples.\n2. Draw $m=$ 20,000 samples of size $n_Y=$ 96 from the distribution $Y\\sim N(40,\\,10)$ and calculate the mean of each of these samples.\n3. Calculate the difference between the sample means from the distribution for $X$ and from the distribution for $Y$ - that is $\\bar X-\\bar Y$.\n4. Check whether the kernel density estimate of the distribution of these differences is similar to the expected normal distribution, as stated above.\n\n:::{.question}\n::::{.question-header}\nTask\n::::\n::::{.question-container .webex-check}\nUsing the statement above about the distribution of $\\bar X-\\bar Y$, what distribution would you expect the differences in sample means to follow?\n\n\n::: {.cell}\n\n:::\n\n\n<div class='webex-radiogroup' id='radio_QHPAKZTHXH'><label><input type=\"radio\" autocomplete=\"off\" name=\"radio_QHPAKZTHXH\" value=\"\"></input> <span>$N\\Big(90,\\,\\sqrt{\\textstyle\\frac{12^2}{120}+\\textstyle\\frac{10^2}{96}}\\Big)$</span></label><label><input type=\"radio\" autocomplete=\"off\" name=\"radio_QHPAKZTHXH\" value=\"\"></input> <span>$N\\Big(50,\\,\\sqrt{\\textstyle\\frac{12}{120}+\\textstyle\\frac{10}{96}}\\Big)$</span></label><label><input type=\"radio\" autocomplete=\"off\" name=\"radio_QHPAKZTHXH\" value=\"\"></input> <span>$N\\Big(50,\\,\\sqrt{\\textstyle\\frac{12^2}{20,000}+\\textstyle\\frac{10^2}{20,000}}\\Big)$</span></label><label><input type=\"radio\" autocomplete=\"off\" name=\"radio_QHPAKZTHXH\" value=\"answer\"></input> <span>$N\\Big(50,\\,\\sqrt{\\textstyle\\frac{12^2}{120}+\\textstyle\\frac{10^2}{96}}\\Big)$</span></label></div>\n\n\n\n<div class='webex-solution'><button>Solution</button>\n\nWe know that $X\\sim N(90,\\,12)$ and that we want to take samples of size 120 from this distribution. Therefore, we can say that $\\mu_X=90$, $\\sigma_X=12$ and $n_X=120$.\n\nWe also know that $Y\\sim N(40,\\,10)$ and that we want to take samples of size 96 from this distribution, so $\\mu_Y=40$, $\\sigma_Y=10$ and $n_Y=96$.\n\nPlugging these values into the given distribution for $\\bar X-\\bar Y$ tells us that,\n\n$$\n\\bar X-\\bar Y\\sim N\\Big(90-40=50,\\,\\sqrt{\\textstyle\\frac{12^2}{120}+\\textstyle\\frac{10^2}{96}}\\Big)\n$$\n\n</div>\n\n::::\n:::\n\n:::{.question}\n::::{.question-header}\nTask\n::::\n::::{.question-container .webex-check}\nComplete the code below draw 20,000 samples of size 120 from the $N(90,\\, 12)$ distribution and save the mean of each sample in a vector called `meansX`.\n\nLet `m` represent the number of samples you want to draw, and `nx` represent the size each sample should be i.e. $n_X$\n\n::: panel-tabset\n## R Code\n::: {.webex-code}\n`m <- `<input class='webex-solveme nospaces' size='5' data-answer='[\"20000\"]'/>\n\n<ul style=\"margin-top: -0.8em; margin-left:-2em;\">\n`nx <- `<input class='webex-solveme nospaces' size='3' data-answer='[\"120\"]'/>\n</ul>\n<ul style=\"margin-top:1.6em; margin-left:-2em;\">\n`meansX <- `<select class='webex-select'><option value='blank'></option><option value=''>vector(m)</option><option value='answer'>numeric(m)</option><option value=''>c(m)</option><option value=''>list(m)</option><option value=''>data.frame(m)</option></select>\n</ul>\n\n<ul style=\"margin-top:1.6em; margin-left:-2em;\">\n<select class='webex-select'><option value='blank'></option><option value='answer'>for</option><option value=''>while</option><option value=''>if</option></select>`(`<input class='webex-solveme nospaces' size='12' data-answer='[\"i in 1:m\",\"i in 1:20000\"]'/>`){`\n</ul>\n<ul style=\"margin-top:-0.8em; margin-left:0.6em;\">\n`meansX[i] <- mean(`<input class='webex-solveme nospaces' size='5' data-answer='[\"rnorm\"]'/>`(nx, mean = `<input class='webex-solveme nospaces' size='2' data-answer='[\"90\"]'/>`, sd = `<input class='webex-solveme nospaces' size='2' data-answer='[\"12\"]'/>`))`\n</ul>\n<ul style=\"margin-top:-0.8em; margin-left:-2em;\">\n`}`\n</ul>\n\n:::\n:::\n\n<div class='webex-solution'><button>Solution</button>\n\n::: panel-tabset\n## R Code\n\n::: {.cell}\n\n```{.r .cell-code}\nm <- 20000\nnx <- 120\n\nmeansX <- numeric(m)\n\nfor(i in 1:m){\n  meansX[i] <- mean(rnorm(nx, mean = 90, sd = 12))\n}\n```\n:::\n\n:::\n\n</div>\n\n::::\n:::\n\nSimilarly, we can draw 20,000 samples of size $n_Y=$ 96 from the $N(40,\\, 10)$ distribution and calculate the mean of each sample using the following code. As we've seen before, this makes use of a for loop to draw each sample and calculate its mean, before saving the mean in the vector `meansY`.\n\n::: panel-tabset\n## R Code\n\n::: {.cell}\n\n```{.r .cell-code}\nm <- 20000\nny <- 96\n\nmeansY <- numeric(m)\n\nfor(i in 1:m){\n  meansY[i] <- mean(rnorm(ny, mean = 40, sd = 10))\n}\n```\n:::\n\n:::\n\nWe can then calculate the difference between each pair of means and store these differences in the data frame `XY`. We use a data frame, rather than a vector here, so that we can go on to plot the distribution of differences using `ggplot2`.\n\n::: panel-tabset\n## R Code\n\n::: {.cell}\n\n```{.r .cell-code}\nXY <- data.frame(diff = meansX - meansY)\n```\n:::\n\n:::\n\nFinally, we can use `ggplot2` to plot the kernel density estimate of the differences between each pair of sample means from the $N(90,\\,12)$ and $N(40,\\,10)$ distributions. We do this using the `geom_density()` function.\n\nWe know that $\\bar X-\\bar Y$ follows the $N\\Big(50,\\,\\sqrt{\\textstyle\\frac{12^2}{120}+\\textstyle\\frac{10^2}{96}}\\Big)$ distribution, so we can superimpose this above the kernel density estimate to assess how similar they are. We do this by including the layer `stat_function()`. Because the distribution we want to show is a normal distribution, we use the argument `fun = dnorm`. The mean and standard deviation, $50$ and $\\sqrt{\\textstyle\\frac{12^2}{120}+\\textstyle\\frac{10^2}{96}}$ respectively, are included within a list given to the argument `args =`. We can also set some stylistic choices of how this normal distribution should appear using the `col =`, `linetype =`, `fill =`, `alpha =` and `geom =` arguments.\n\n::: panel-tabset\n## R Code\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = XY) +\n  geom_density(aes(x = diff), fill = \"cadetblue3\") +\n  stat_function(fun = dnorm, args = list(mean = 50,\n                sd = sqrt(12^2/120 + 10^2/96)),\n                geom = \"area\", col = \"black\", linetype = 2,\n                fill = \"black\", alpha = 0.2) +\n  labs(x = expression(bar(X)-bar(Y)), y = \"Density\")\n```\n:::\n\n\n## Plots\n\n::: {.cell}\n::: {.cell-output-display}\n![](02-X-Y_files/figure-html/XY3.2-1.png){width=672}\n:::\n:::\n\n:::\n\n:::{.question}\n::::{.question-header}\nTask\n::::\n::::{.question-container .webex-check}\nDo you think the kernel density estimate of the distribution of the differences between pairs of sample means is approximately equal to the $N\\Big(50,\\,\\sqrt{\\textstyle\\frac{12^2}{120}+\\textstyle\\frac{10^2}{96}}\\Big)$ distribution?\n\n<select class='webex-select'><option value='blank'></option><option value='answer'>Yes</option><option value=''>No</option><option value=''>Can't say</option></select>\n::::\n:::\n\n<!--computing empirical and theoretical probability-->\nWe can use our calculated differences between the sample means of $X$ and $Y$ to estimate probabilities for $\\bar X-\\bar Y$. For example, you might be asked, what is the probability that the difference between the mean of $X$ and the mean of $Y$ is greater than 48?\n\nWe can use the values of differences between the pairs of sample means to answer this. We use a logical statement, `XY$diff > 48`, to identify which of the calculated differences are greater than 48. This logical statement returns 20,000 values - `TRUE` if the corresponding difference was greater than 48 and `FALSE` if the difference was less than or equal to 48. We can then plug this logical vector into the `mean()` function to tell us the proportion of differences that were greater than 48. This proportion is a good approximation of the true probability $P\\big(\\bar X-\\bar Y>48\\big)$ and using the code below, we see that this is roughly equal to 0.9097.\n\n::: panel-tabset\n## R Code\n\n::: {.cell}\n\n```{.r .cell-code}\nmean(XY$diff > 48)\n```\n:::\n\n\n## Output\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.9097\n```\n\n\n:::\n:::\n\n:::\n\nBecause we have used our samples to calculate this probability, this is known as an *empirical* probability. We could also find the true, theoretical probability that $P\\big(\\bar X-\\bar Y>48\\big)$ by using the fact that $\\bar X-\\bar Y\\sim N\\Big(50,\\,\\sqrt{\\textstyle\\frac{12^2}{120}+\\textstyle\\frac{10^2}{96}}\\Big)$.\n\nWe can use the function `pnorm()` to find the probability that $P\\big(\\bar X-\\bar Y\\leq 48\\big)$. Then, in order to find $P\\big(\\bar X-\\bar Y>48\\big)$, we simply calculate $1-$ the result from `pnorm()`. This is shown in the code below.\n\n::: panel-tabset\n## R Code\n\n::: {.cell}\n\n```{.r .cell-code}\n1-pnorm(48, mean = 50, sd = sqrt(12^2/120 + 10^2/96))\n```\n:::\n\n\n## Output\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.9091942\n```\n\n\n:::\n:::\n\n:::\n\nNotice how close the empirical probability we calculated from our samples is to the true, theoretical probability.\n\n---\n\nYou can follow a similar example of using R to create a sample sampling distribution for $\\bar X-\\bar Y$ in Section [6.5.2 Sampling Distribution for $\\bar X-\\bar Y$ When Sampling from Two Independent Normal Populations](https://read.kortext.com/reader/pdf/92741/375){target=\"_blank\"} in *Probability and Statistics with R*.\n\n\n\n\n\n\n\n\n\n\n",
    "supporting": [
      "02-X-Y_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}