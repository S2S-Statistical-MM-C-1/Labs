[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "S2S Lab 6",
    "section": "",
    "text": "Welcome to the sixth S2S lab. This lab expands on the concept of sampling distributions (introduced in Lab 5) to look at the scenario of sampling from continuous distributions other than the normal distribution. To help us do this, we introduce an important result in statistics know as the central limit theorem. This section of the lab follows Section 6.5.1.2 Second Case: Sampling Distribution of \\(\\bar X\\) When \\(X\\) Is Not a Normal Random Variable of Probability and Statistics with R.\nWe will also look at creating a sampling distribution for the difference between two means, when both of the orginal random variables do come from a normal distribution. This second section of the lab is based on Section 6.5.2 Sampling Distribution for \\(\\bar X - \\bar Y\\) When Sampling from Two Independent Normal Populations of Probability and Statistics with R.",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Welcome!</span>"
    ]
  },
  {
    "objectID": "01-clt.html",
    "href": "01-clt.html",
    "title": "2  Sampling Distribution of \\(\\bar{X}\\)",
    "section": "",
    "text": "2.1 Central Limit Theorem\nSuppose we were to take multiple random samples, each of the same size, from a distribution. We would be able to calculate the mean of each sample, i.e. each sample mean, and be left with many different values of \\(\\bar X\\). The distribution of all of these sample means is called the sampling distribution of \\(\\bar X\\).\nAn important result regarding the sampling distribution of \\(\\bar X\\) is that, provided the sample size is sufficiently large, the sampling distribution of \\(\\bar X\\) will follow a normal distribution. For this to be true, the random variable \\(X\\) does not need to follow a normal distribution itself (like in Section 6.5.1.1 of Probability and Statistics with R). This result is know as the Central Limit Theorem.\nFormally, for a random variable \\(X\\) which follows any distribution with known mean, \\(\\mu\\), and standard deviation, \\(\\sigma\\), then\n\\[\nZ=\\frac{\\bar X-\\mu}{\\frac{\\sigma}{\\sqrt{n}}}\\sim N(0,\\, 1)\n\\] as \\(n\\rightarrow\\infty\\).\nThis can be rephrased to say that the sampling distribution of \\(\\bar X\\) is approximately \\(N\\Big(\\mu,\\,\\frac{\\sigma}{\\sqrt{n}}\\Big)\\), provided the size of the sample taken, \\(n\\), is sufficiently large.\nThis term sufficiently large should make you wonder, how big does a sample need to be to be considered sufficiently large? This actually depends on the distribution that the random variable \\(X\\) follows.\nLet’s look at an example of sampling from different distributions to determine how big a sample we need for the sampling distribution of \\(\\bar X\\) to be considered normal. Specifically, we will sample from the \\(\\mbox{Unif}(-11,\\, 41)\\) and \\(\\mbox{Expo}\\Big(\\textstyle\\frac{1}{15}\\Big)\\) distributions. Note that both these distributions have mean and standard deviation approximately equal to 15 (you should try and show this yourself using results from Stats 2R Probability).\nTo see if the sampling distribution of \\(\\bar X\\) is indeed normal, with mean \\(\\mu=15\\) and standard deviation \\(\\sigma=\\textstyle\\frac{15}{\\sqrt{2}}\\), we want to draw \\(m=10,000\\) random samples of size \\(n=2\\) from both the \\(\\mbox{Unif}(-11,\\, 41)\\) and \\(\\mbox{Expo}\\Big(\\textstyle\\frac{1}{15}\\Big)\\) distributions and use these samples to calculate 10,000 values of the sample mean, \\(\\bar x\\). We can then plot the distribution of these 10,000 sample means and compare it to the \\(N\\Big(15,\\,\\textstyle\\frac{15}{\\sqrt{2}}\\Big)\\) distribution for both cases.\nTo start with, let’s set up two empty vectors, means_unif_2 and means_expo_2, which will be used to store each of the 10,000 means calculated from samples taken from the Uniform and Exponential distributions respectively. This is done using the function numeric() which creates an empty vector with length equal to the value you provide as the argument, in this case m = 10,000.\nTo draw the samples from each distribution and calculate the mean, a for loop is used. For the Uniform distribution, runif() is used to draw a random sample of size \\(n=2\\) from the \\(\\mbox{Unif}(-11,\\, 41)\\) distribution, and then the function mean() is used to calculate the mean of these two values. The for loop stores this mean as one of the values in the vector means_unif_2, and repeats until 10,000 random samples have been drawn and used to calculate a mean.\nThe same process is used to draw the samples from the Exponential distribution, except the function rexp() is used to draw the random samples (for more details on R’s probability functions and flow control, see Lab 3: Section 4 and Lab 3: Appendix C respectively).\nBefore we plot either of these sampling distributions, the sample means can be stored within a data frame. The following code creates the data frame, means_2, which has a column storing the value of the mean calculated for each sample, and a second column stating which distribution this sample mean was from.\nNow, we are ready to plot the two sampling distributions of \\(\\bar X\\) from the \\(\\mbox{Unif}(-11,\\, 41)\\) and \\(\\mbox{Expo}\\Big(\\textstyle\\frac{1}{15}\\Big)\\) distributions. This can be done using the ggplot2 package (see Lab 4: Appendix A) using the following code.\nLet’s take a look at each layer in turn.\nUsing stat_function() as a layer in a ggplot2 plot allows you to draw any defined function above the rest of the figure. This is useful when you want to include plots of data which are not from the data frame provided in the data = argument of the ggplot() function. The arguments that stat_function() can be supplied with are:\nIt seems that a sample size of \\(n=2\\) is not sufficiently large to give a sampling distribution of \\(\\bar X\\) which follows the normal distribution, when we are sampling from the Exponential distribution. In order for the Central Limit Theorem to hold true then, we need to take larger samples from the \\(\\mbox{Expo}\\Big(\\textstyle\\frac{1}{15}\\Big)\\) distribution.\nLet’s take samples of size \\(n=10\\) and \\(n=40\\) from both the \\(\\mbox{Unif}(-11,\\, 41)\\) and \\(\\mbox{Expo}\\Big(\\textstyle\\frac{1}{15}\\Big)\\) distributions, to investigate how the sample size affects the sampling distribution of \\(\\bar X\\).\nIn the code below, we take 10,000 random samples of size \\(n=10\\) from the Uniform and Exponential distributions and then save the mean of each sample in either the vector means_unif_10, if the sample was taken from the Uniform distribution, or means_expo_10, if the sample was from the Exponential distribution.\nSimilarly, we can take samples of size \\(n=40\\) from each distribution and save the mean of each sample in a vector using the following code.\nNow that we have all of the sample means saved in various vectors, we will need to compile them all into a data frame in order for us to be able to plot their respective distributions using ggplot2. The code below creates the data frame means, which stores each sample mean, along with the distribution the sample was taken from and the size of the sample.\nNote that we are including the sample means from the samples of size \\(n=2\\) in this data frame for completeness.\nWe can then plot the two sampling distributions of \\(\\bar X\\) from the \\(\\mbox{Unif}(-11,\\, 41)\\) and \\(\\mbox{Expo}\\Big(\\textstyle\\frac{1}{15}\\Big)\\) distributions when the sample size is \\(n=10\\) using the code below. We have to subset the data from means to show only the means which are from a sample size of \\(n=10\\). Also, because the sample size has changed, the distribution that the Central Limit Theorem states \\(\\bar X\\) will follow in both cases is now \\(N\\Big(15,\\,\\textstyle\\frac{15}{\\sqrt{10}}\\Big)\\), so this is the distribution we want to superimpose using stat_function().\nWe can also show the sampling distributions of \\(\\bar X\\) from the Uniform and Exponential distributions when the sample size is \\(n=40\\). This done using the code below. Again, note that the distribution the Central Limit Theorem states the sampling distribution of \\(\\bar X\\) will follow is now \\(N\\Big(15,\\,\\textstyle\\frac{15}{\\sqrt{40}}\\Big)\\) because the sample size has changed.\nSection 6.5.1.2 Second Case: Sampling Distribution of \\(\\bar X\\) When \\(X\\) Is Not a Normal Random Variable of Probability and Statistics with R details a similar example of finding the distribution of \\(\\bar X\\) through sampling.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Sampling Distribution of $\\bar{X}$</span>"
    ]
  },
  {
    "objectID": "01-clt.html#central-limit-theorem",
    "href": "01-clt.html#central-limit-theorem",
    "title": "2  Sampling Distribution of \\(\\bar{X}\\)",
    "section": "",
    "text": "Task\n\n\nIf we were to take samples of size \\(n=2\\) from the \\(\\mbox{Unif}(-11,\\, 41)\\) distribution, what distribution would \\(\\bar X\\) follow, according to the Central Limit Theorem?\n\n \\(N\\Big(-11,\\,\\textstyle\\frac{41}{\\sqrt{2}}\\Big)\\) \\(N\\Big(15,\\,\\textstyle\\frac{15}{\\sqrt{2}}\\Big)\\) \\(\\mbox{Unif}\\Big(-11,\\,41\\Big)\\) \\(N\\Big(15,\\,15\\Big)\\)\n\n\n\nSolution\n\nIf \\(X\\sim\\mbox{Unif}(-11,\\, 41)\\), then we can show that,\n\n\\(E[X]=15=\\mu\\)\n\\(sd(X)\\approx 15=\\sigma\\)\n\nWe can then use these values to show that, according to the Central Limit Theorem,\n\\[\n\\bar X\\sim N\\Big(15,\\,\\textstyle\\frac{15}{\\sqrt{2}}\\Big)\n\\]\n\n\n\n\n\nTask\n\n\nIf we were to take samples of size \\(n=2\\) from the \\(\\mbox{Expo}\\Big(\\textstyle\\frac{1}{15}\\Big)\\) distribution, what distribution would \\(\\bar X\\) follow, according to the Central Limit Theorem?\n\n \\(N\\Big(15,\\,\\textstyle\\frac{15}{\\sqrt{2}}\\Big)\\) \\(N\\Big(15,\\,15\\Big)\\) \\(\\mbox{Expo}\\Big(\\textstyle\\frac{1}{15}\\Big)\\) \\(N\\Big(\\textstyle\\frac{1}{15},\\,\\textstyle\\frac{15}{\\sqrt{2}}\\Big)\\)\n\n\n\nSolution\n\nIf \\(X\\sim \\mbox{Expo}\\Big(\\textstyle\\frac{1}{15}\\Big)\\), then we can show that,\n\n\\(E[X]=15=\\mu\\)\n\\(sd(X)=15=\\sigma\\)\n\nWe can then use these values to show that, according to the Central Limit Theorem,\n\\[\n\\bar X\\sim N\\Big(15,\\,\\textstyle\\frac{15}{\\sqrt{2}}\\Big)\n\\]\n\n\n\n\n\n\nR Code\n\n\n\nm &lt;- 10000\n\nmeans_unif_2 &lt;- numeric(m)\nmeans_expo_2 &lt;- numeric(m)\n\n\n\n\n\n\n\nR Code\n\n\n\nfor(i in 1:m){\n  means_unif_2[i] &lt;- mean(runif(n = 2, min = -11, max = 41))\n}\n\nfor(i in 1:m){\n  means_expo_2[i] &lt;- mean(rexp(n = 2, rate = 1/15))\n}\n\n\n\n\n\n\nR CodeOutput\n\n\n\nmeans_2 &lt;- data.frame(mean = c(means_unif_2, means_expo_2),\n                      distribution = rep(c(\"Uniform\", \"Exponential\"),\n                                         each = m))\n\nmeans_2$distribution &lt;- factor(x = means_2$distribution,\n                               levels = c(\"Uniform\", \"Exponential\"))\n\nhead(means_2)\n\n\n\n\n\n       mean distribution\n1 18.871554      Uniform\n2  1.734411      Uniform\n3  8.062075      Uniform\n4 25.843355      Uniform\n5 -3.788757      Uniform\n6  8.705695      Uniform\n\n\n\n\n\n\n\nR CodePlots\n\n\n\nggplot(data = means_2) +\n  geom_density(aes(x = mean), fill = \"skyblue\") +\n  facet_grid(distribution ~ .) +\n  coord_cartesian(xlim = c(-11, 41)) +\n  labs(title = \"Simulated sampling distributions of the sample mean\",\n       subtitle = \"Sample size n = 2\",\n       x = expression(bar(x)), y = \"Density\") +\n  stat_function(fun = dnorm, args = list(mean = 15, sd = 15/sqrt(2)),\n                col = \"black\", linetype = 2, fill = \"black\",\n                alpha = 0.2, geom = \"area\")\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\ngeom_density(): this tells ggplot2 that we want to create a kernel density estimate of the means stored within the data frame means_2, along the x-axis.\nfacet_grid(): because means_2 stores the means for samples taken from both the Uniform and Exponential distributions, we want two different plots of the sampling distribution of \\(\\bar X\\) from each. Here we specify that we want each row of plots to be for a different distribution.\ncoord_cartesian(): we can specify the range of values we want to show along the x-axis and limit this range to a sensible one to show the full scope of each distribution.\nlabs(): this allows us to give the plots some axes labels and a title.\nstat_function(): this superimposes a defined function above the density plots already created. According to the Central Limit Theorem, the sampling distribution of \\(\\bar X\\) from both the \\(\\mbox{Unif}(-11,\\, 41)\\) and \\(\\mbox{Expo}\\Big(\\textstyle\\frac{1}{15}\\Big)\\) distributions should be approximately \\(N\\Big(15, \\textstyle\\frac{15}{\\sqrt{2}}\\Big)\\) when the sample size is \\(n=2\\), so this is the distribution we want to show.\n\n\n\nfun =: this is the name of the function in R that will calculate the values to be plotted against different values along the x-axis. If you wish to plot a probability distribution, then use the name of the function that calculates the corresponding values of the probability density function (PDF) e.g. for the normal distribution, use dnorm, or for the exponential distribution, use dexp.\nargs =: this is a list of all the argument values to be provided the R function named in the fun = argument. Different functions will require different arguments, so check that the ones you provide make sense with the function you’ve stated in the fun = argument.\ngeom =: this is the name of the geometric object you want to use to show the data. Examples include \"area\" to plot the area under the curve, \"point\" to plot points representing the value at different points along the x-axis, or \"polygon\" to plot the area between the minimum value along the x-axis, the maximum value and the area under the curve.\ncol =: this is the colour to use for the line on the plot representing the function.\nlinetype =: this is an integer value indicating which style of line you would like to plot.\nfill =: this is the colour to be used to fill in the area under the curve. In order for this to be used, the argument `geom\nalpha =: this sets the opacity of the fill colour. You can set this argument to be any value between 0 and 1 - a value of 1 means the colour will be fully opaque and a value of 0 means the colour will be transparent.\n\n\n\nTask\n\n\nDo you think the the sampling distribution of \\(\\bar X\\), when samples of size \\(n=2\\) are taken from the \\(\\mbox{Unif}(-11,\\,41)\\) distribution, is approximately normal?\nYesNoCan’t say\n\n\n\n\nTask\n\n\nWhat about the sampling distribution of \\(\\bar X\\) when samples of size \\(n=2\\) are taken from the \\(\\mbox{Expo}\\Big(\\textstyle\\frac{1}{15}\\Big)\\) distribution - is it approximately normal?\nYesNoCan’t say\n\n\n\n\n\n\nR Code\n\n\n\nmeans_unif_10 &lt;- numeric(m)\nmeans_expo_10 &lt;- numeric(m)\n\nfor(i in 1:m){\n  means_unif_10[i] &lt;- mean(runif(n = 10, min = -11, max = 41))\n}\n\nfor(i in 1:m){\n  means_expo_10[i] &lt;- mean(rexp(n = 10, rate = 1/15))\n}\n\n\n\n\n\n\nR Code\n\n\n\nmeans_unif_40 &lt;- numeric(m)\nmeans_expo_40 &lt;- numeric(m)\n\nfor(i in 1:m){\n  means_unif_40[i] &lt;- mean(runif(n = 40, min = -11, max = 41))\n}\n\nfor(i in 1:m){\n  means_expo_40[i] &lt;- mean(rexp(n = 40, rate = 1/15))\n}\n\n\n\n\n\n\nTask\n\n\nComplete the code below to draw 10,000 samples of size \\(n=100\\) from the \\(\\mbox{Unif}(-11,\\,41)\\) distribution, and another 10,000 samples of size \\(n=100\\) from the \\(\\mbox{Expo}\\Big(\\textstyle\\frac{1}{15}\\Big)\\) distribution.\n\nR Code\n\n\n\nmeans_unif_100 &lt;- numeric(m)\n\nmeans_expo_100 &lt;- numeric(m)\n\n\nfor(i in){\n\n\nmeans_unif_100[] &lt;- mean(rexprunifrnormrpois(n =,\n\n\nmin = -11, max = 41))\n\n\n}\n\n\nfor(i in){\n\n\nmeans_expo_100[] &lt;- mean(rexprunifrnormrpois(n =, rate =))\n\n\n}\n\n\n\n\n\n\n\nSolution\n\n\nR Code\n\n\n\nmeans_unif_100 &lt;- numeric(m)\nmeans_expo_100 &lt;- numeric(m)\n\nfor(i in 1:m){\n  means_unif_100[i] &lt;- mean(runif(n = 100, \n                                  min = -11, max = 41))\n}\n\nfor(i in 1:m){\n  means_expo_100[i] &lt;- mean(rexp(n = 100, rate = 1/15))\n}\n\n\n\n\n\n\n\n\n\n\nR Code\n\n\n\nmeans &lt;- data.frame(mean = c(means_unif_2, means_expo_2,\n                             means_unif_10, means_expo_10,\n                             means_unif_40, means_expo_40,\n                             means_unif_100, means_expo_100),\n                    distribution = rep(rep(c(\"Uniform\", \"Exponential\"),\n                                           each = m), times = 4),\n                    size = rep(c(\"n = 2\", \"n = 10\", \"n = 40\", \"n = 100\"),\n                               each = 2*m))\n\nmeans$distribution &lt;- factor(means$distribution,\n                             levels = c(\"Uniform\", \"Exponential\"))\n\nmeans$size &lt;- factor(means$size, levels = c(\"n = 2\", \"n = 10\",\n                                            \"n = 40\", \"n = 100\"))\n\n\n\n\n\n\nR CodePlots\n\n\n\nggplot(data = subset(means, subset = (size == \"n = 10\"))) +\n  geom_density(aes(x = mean), fill = \"skyblue\") +\n  facet_grid(distribution ~ .) +\n  coord_cartesian(xlim = c(-1, 31)) +\n  labs(title = \"Simulated sampling distributions of the sample mean\",\n       subtitle = \"Sample size n = 10\",\n       x = expression(bar(x)), y = \"Density\") +\n  stat_function(fun = dnorm, args = list(mean = 15, sd = 15/sqrt(10)),\n                geom = \"area\", col = \"black\", linetype = 2,\n                fill = \"black\", alpha = 0.2)\n\n\n\n\n\n\n\n\nSimulated sampling distributions of the sample mean for samples of size n = 10 from a Unif(−11,41) and an Expo(1/15) distributions with superimposed normal distributions.\n\n\n\n\n\n\n\n\n\nR CodePlots\n\n\n\nggplot(data = subset(means, subset = (size == \"n = 40\"))) +\n  geom_density(aes(x = mean), fill = \"skyblue\") +\n  facet_grid(distribution ~ .) +\n  coord_cartesian(xlim = c(6, 24)) +\n  labs(title = \"Simulated sampling distributions of the sample mean\",\n       subtitle = \"Sample size n = 40\",\n       x = expression(bar(x)), y = \"Density\") +\n  stat_function(fun = dnorm, args = list(mean = 15, sd = 15/sqrt(40)),\n                geom = \"area\", col = \"black\", linetype = 2,\n                fill = \"black\", alpha = 0.2)\n\n\n\n\n\n\n\n\nSimulated sampling distributions of the sample mean for samples of size n = 40 from a Unif(−11,41) and an Expo(1/15) distributions with superimposed normal distributions.\n\n\n\n\n\n\n\n\n\nTask\n\n\nComplete the code below to plot the sampling distribution of \\(\\bar X\\) for the samples of size \\(n=100\\) taken from the \\(\\mbox{Unif}(-11,\\, 41)\\) and \\(\\mbox{Expo}\\Big(\\textstyle\\frac{1}{15}\\Big)\\) distributions. Superimpose the normal distribution that each sampling distribution follows according to the Central Limit Theorem.\n\nR CodePlots\n\n\n\nggplot(data = subset(means, subset = (size == \"n = 100\"))) +\n\ngeom_densgeom_densitydensity(aes(x = mean), fill = \"skyblue\") +\n\n\nfacet_grid() +\n\n\ncoord_cartesian(xlim = c(9, 21)) + labs(title = \"Simulated sampling distributions of the sample mean\",\n\n\nsubtitle = \"Sample size n = 100\", x = expression(bar(x)), y = \"Density\") +\n\n\nstat_function(fun = dnorm, args = list(mean =, sd =),\n\n\ngeom =, col = \"black\", linetype = 2, fill = \"black\", alpha = 0.2)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nSolution\n\n\nR CodePlots\n\n\n\nggplot(data = subset(means, subset = (size == \"n = 100\"))) +\n  geom_density(aes(x = mean), fill = \"skyblue\") +\n  facet_grid(distribution ~ .) +\n  coord_cartesian(xlim = c(9, 21)) +\n  labs(title = \"Simulated sampling distributions of the sample mean\",\n       subtitle = \"Sample size n = 100\",\n       x = expression(bar(x)), y = \"Density\") +\n  stat_function(fun = dnorm, args = list(mean = 15, sd = 15/sqrt(100)),\n                geom = \"area\", col = \"black\", linetype = 2,\n                fill = \"black\", alpha = 0.2)",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Sampling Distribution of $\\bar{X}$</span>"
    ]
  },
  {
    "objectID": "02-X-Y.html",
    "href": "02-X-Y.html",
    "title": "3  Sampling distribution for \\(\\bar X - \\bar Y\\)",
    "section": "",
    "text": "For two independent normal random variables \\(X\\) and \\(Y\\), with distributions \\(X\\sim N(\\mu_X,\\,\\sigma_X)\\) and \\(Y\\sim N(\\mu_Y,\\,\\sigma_Y)\\) respectively, the distribution of \\(\\bar X-\\bar Y\\) is,\n\\[\n\\bar X-\\bar Y\\sim N\\Bigg(\\mu_X-\\mu_Y,\\,\\sqrt{\\frac{\\sigma_X^2}{n_X}+\\frac{\\sigma_y^2}{n_Y}}\\Bigg)\n\\]\nwhere \\(n_X\\) is the size of the sample taken from the distribution for \\(X\\) and \\(n_Y\\) is the size of the sample taken from the distribution for \\(Y\\).\nWe can show that this result is true by sampling from the distributions of \\(X\\) and \\(Y\\) in R and creating a new sampling distribution for \\(\\bar X -\\bar Y\\).\nSpecifically, we will;\n\nDraw \\(m=\\) 20,000 samples of size \\(n_X=\\) 120 from the distribution \\(X\\sim N(90,\\,12)\\) and calculate the mean of each of these samples.\nDraw \\(m=\\) 20,000 samples of size \\(n_Y=\\) 96 from the distribution \\(Y\\sim N(40,\\,10)\\) and calculate the mean of each of these samples.\nCalculate the difference between the sample means from the distribution for \\(X\\) and from the distribution for \\(Y\\) - that is \\(\\bar X-\\bar Y\\).\nCheck whether the kernel density estimate of the distribution of these differences is similar to the expected normal distribution, as stated above.\n\n\n\nTask\n\n\nUsing the statement above about the distribution of \\(\\bar X-\\bar Y\\), what distribution would you expect the differences in sample means to follow?\n\n \\(N\\Big(50,\\,\\sqrt{\\textstyle\\frac{12^2}{120}+\\textstyle\\frac{10^2}{96}}\\Big)\\) \\(N\\Big(50,\\,\\sqrt{\\textstyle\\frac{12}{120}+\\textstyle\\frac{10}{96}}\\Big)\\) \\(N\\Big(50,\\,\\sqrt{\\textstyle\\frac{12^2}{20,000}+\\textstyle\\frac{10^2}{20,000}}\\Big)\\) \\(N\\Big(90,\\,\\sqrt{\\textstyle\\frac{12^2}{120}+\\textstyle\\frac{10^2}{96}}\\Big)\\)\n\n\n\nSolution\n\nWe know that \\(X\\sim N(90,\\,12)\\) and that we want to take samples of size 120 from this distribution. Therefore, we can say that \\(\\mu_X=90\\), \\(\\sigma_X=12\\) and \\(n_X=120\\).\nWe also know that \\(Y\\sim N(40,\\,10)\\) and that we want to take samples of size 96 from this distribution, so \\(\\mu_Y=40\\), \\(\\sigma_Y=10\\) and \\(n_Y=96\\).\nPlugging these values into the given distribution for \\(\\bar X-\\bar Y\\) tells us that,\n\\[\n\\bar X-\\bar Y\\sim N\\Big(90-40=50,\\,\\sqrt{\\textstyle\\frac{12^2}{120}+\\textstyle\\frac{10^2}{96}}\\Big)\n\\]\n\n\n\n\n\nTask\n\n\nComplete the code below draw 20,000 samples of size 120 from the \\(N(90,\\, 12)\\) distribution and save the mean of each sample in a vector called meansX.\nLet m represent the number of samples you want to draw, and nx represent the size each sample should be i.e. \\(n_X\\)\n\nR Code\n\n\n\nm &lt;-\n\nnx &lt;-\n\n\nmeansX &lt;-vector(m)numeric(m)c(m)list(m)data.frame(m)\n\n\nforwhileif(){\n\n\nmeansX[i] &lt;- mean((nx, mean =, sd =))\n\n\n}\n\n\n\n\n\n\n\nSolution\n\n\nR Code\n\n\n\nm &lt;- 20000\nnx &lt;- 120\n\nmeansX &lt;- numeric(m)\n\nfor(i in 1:m){\n  meansX[i] &lt;- mean(rnorm(nx, mean = 90, sd = 12))\n}\n\n\n\n\n\n\n\nSimilarly, we can draw 20,000 samples of size \\(n_Y=\\) 96 from the \\(N(40,\\, 10)\\) distribution and calculate the mean of each sample using the following code. As we’ve seen before, this makes use of a for loop to draw each sample and calculate its mean, before saving the mean in the vector meansY.\n\nR Code\n\n\n\nm &lt;- 20000\nny &lt;- 96\n\nmeansY &lt;- numeric(m)\n\nfor(i in 1:m){\n  meansY[i] &lt;- mean(rnorm(ny, mean = 40, sd = 10))\n}\n\n\n\n\nWe can then calculate the difference between each pair of means and store these differences in the data frame XY. We use a data frame, rather than a vector here, so that we can go on to plot the distribution of differences using ggplot2.\n\nR Code\n\n\n\nXY &lt;- data.frame(diff = meansX - meansY)\n\n\n\n\nFinally, we can use ggplot2 to plot the kernel density estimate of the differences between each pair of sample means from the \\(N(90,\\,12)\\) and \\(N(40,\\,10)\\) distributions. We do this using the geom_density() function.\nWe know that \\(\\bar X-\\bar Y\\) follows the \\(N\\Big(50,\\,\\sqrt{\\textstyle\\frac{12^2}{120}+\\textstyle\\frac{10^2}{96}}\\Big)\\) distribution, so we can superimpose this above the kernel density estimate to assess how similar they are. We do this by including the layer stat_function(). Because the distribution we want to show is a normal distribution, we use the argument fun = dnorm. The mean and standard deviation, \\(50\\) and \\(\\sqrt{\\textstyle\\frac{12^2}{120}+\\textstyle\\frac{10^2}{96}}\\) respectively, are included within a list given to the argument args =. We can also set some stylistic choices of how this normal distribution should appear using the col =, linetype =, fill =, alpha = and geom = arguments.\n\nR CodePlots\n\n\n\nggplot(data = XY) +\n  geom_density(aes(x = diff), fill = \"cadetblue3\") +\n  stat_function(fun = dnorm, args = list(mean = 50,\n                sd = sqrt(12^2/120 + 10^2/96)),\n                geom = \"area\", col = \"black\", linetype = 2,\n                fill = \"black\", alpha = 0.2) +\n  labs(x = expression(bar(X)-bar(Y)), y = \"Density\")\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nTask\n\n\nDo you think the kernel density estimate of the distribution of the differences between pairs of sample means is approximately equal to the \\(N\\Big(50,\\,\\sqrt{\\textstyle\\frac{12^2}{120}+\\textstyle\\frac{10^2}{96}}\\Big)\\) distribution?\nYesNoCan’t say\n\n\n\nWe can use our calculated differences between the sample means of \\(X\\) and \\(Y\\) to estimate probabilities for \\(\\bar X-\\bar Y\\). For example, you might be asked, what is the probability that the difference between the mean of \\(X\\) and the mean of \\(Y\\) is greater than 48?\nWe can use the values of differences between the pairs of sample means to answer this. We use a logical statement, XY$diff &gt; 48, to identify which of the calculated differences are greater than 48. This logical statement returns 20,000 values - TRUE if the corresponding difference was greater than 48 and FALSE if the difference was less than or equal to 48. We can then plug this logical vector into the mean() function to tell us the proportion of differences that were greater than 48. This proportion is a good approximation of the true probability \\(P\\big(\\bar X-\\bar Y&gt;48\\big)\\) and using the code below, we see that this is roughly equal to 0.90905.\n\nR CodeOutput\n\n\n\nmean(XY$diff &gt; 48)\n\n\n\n\n\n[1] 0.90905\n\n\n\n\n\nBecause we have used our samples to calculate this probability, this is known as an empirical probability. We could also find the true, theoretical probability that \\(P\\big(\\bar X-\\bar Y&gt;48\\big)\\) by using the fact that \\(\\bar X-\\bar Y\\sim N\\Big(50,\\,\\sqrt{\\textstyle\\frac{12^2}{120}+\\textstyle\\frac{10^2}{96}}\\Big)\\).\nWe can use the function pnorm() to find the probability that \\(P\\big(\\bar X-\\bar Y\\leq 48\\big)\\). Then, in order to find \\(P\\big(\\bar X-\\bar Y&gt;48\\big)\\), we simply calculate \\(1-\\) the result from pnorm(). This is shown in the code below.\n\nR CodeOutput\n\n\n\n1-pnorm(48, mean = 50, sd = sqrt(12^2/120 + 10^2/96))\n\n\n\n\n\n[1] 0.9091942\n\n\n\n\n\nNotice how close the empirical probability we calculated from our samples is to the true, theoretical probability.\n\nYou can follow a similar example of using R to create a sample sampling distribution for \\(\\bar X-\\bar Y\\) in Section 6.5.2 Sampling Distribution for \\(\\bar X-\\bar Y\\) When Sampling from Two Independent Normal Populations in Probability and Statistics with R.",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Sampling distribution for $\\bar X - \\bar Y$</span>"
    ]
  },
  {
    "objectID": "03-exercises.html",
    "href": "03-exercises.html",
    "title": "4  Further Exercises",
    "section": "",
    "text": "Exercise 1\nSuppose \\(X\\sim\\mbox{Bi}(16,\\,0.5)\\). Investigate whether sample sizes of \\(n=2\\), \\(n=5\\), \\(n=10\\), \\(n=50\\) and \\(n=100\\) are sufficiently large for the sampling distribution of \\(\\bar X\\) to follow the normal distribution, as stated by the Central Limit Theorem.\nFor each different sample size, you should,\nHint You can draw a random sample from the Binomial distribution using the function rbinom(). Use the help() function to find out which arguments need to be provided to rbinom().",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Further Exercises</span>"
    ]
  },
  {
    "objectID": "03-exercises.html#exercise-1",
    "href": "03-exercises.html#exercise-1",
    "title": "4  Further Exercises",
    "section": "",
    "text": "Draw 10,000 random samples from \\(X\\sim\\mbox{Bi}(16,\\,0.5)\\).\nCalculate the mean of each of these samples.\nPlot the kernel density estimate of the sampling distribution for \\(\\bar X\\).\nSuperimpose the distribution that the Central Limit Theorem states the sampling distribution for \\(\\bar X\\) should follow above the kernel density estimate - use the mean and standard deviation of \\(X\\) to find which distribution this should be.",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Further Exercises</span>"
    ]
  },
  {
    "objectID": "03-exercises.html#exercise-2",
    "href": "03-exercises.html#exercise-2",
    "title": "4  Further Exercises",
    "section": "Exercise 2",
    "text": "Exercise 2\nThe number of honeybees found in commercial beehives made by company \\(X\\) has a mean of 35,000 and a standard deviation of 12,000. The number of honeybees found in beehives made by company \\(Y\\) also has a mean of 35,000, but a standard deviation of 20,000. Both these hive sizes follow a normal distribution.\n\nSuppose 40 beehives have been randomly sampled from company \\(X\\) and 22 beehives have been randomly sampled from company \\(Y\\). Calculate the probability that the mean number of honeybees found in the beehives sampled from company \\(X\\) is at least 2,000 bees more than the mean number found in the sample from company \\(Y\\)’s beehives.\nSimulate taking the samples of beehives from companies \\(X\\) and \\(Y\\) by drawing 15,000 versions of the samples from the respective distributions. Calculate the sample mean in each case and use these to estimate the probability found in part (a). Is this empirical probability similar to the theoretical probability?\nIt might help to show the kernel density estimate of the sampling distribution of \\(\\bar X-\\bar Y\\) in a plot, with the normal distribution it is expected to follow superimposed on top.",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Further Exercises</span>"
    ]
  }
]