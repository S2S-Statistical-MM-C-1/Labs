---
title: "S2S Lab 5 Task Solutions"
output:
  pdf_document:
    number_sections: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(knitr)
library(PASWR2)
library(MASS)
```

# Welcome!

# Sampling Distribution of $\bar X$

**What is the mean of the random variable $X$?**

3.5

**What is the variance of the random variable $X$?**

2.9167

## Sampling with replacement

```{r, echo=FALSE}
samples_w <- expand.grid(Draw1 = 1:6, Draw2 = 1:6)
sample_w_means <- apply(X = samples_w, MARGIN = 1, FUN = mean)
sample_w_variances <- apply(X = samples_w, MARGIN = 1, FUN = var)
samples_w <- cbind(samples_w, Mean = sample_w_means, Variance = sample_w_variances)
samplingdist_mean_w <- fractions(table(samples_w$Mean)/36)
samplingdist_var_w <- fractions(table(samples_w$Variance)/36)
```

**What is the mean of the sampling distribution for $\bar X$?**

```{r with-ans1}
means_w <- unique(samples_w$Mean)
mean_Xbar_w <- sum(means_w*samplingdist_mean_w)
mean_Xbar_w
```

**What is the variance of the sampling distribution for $\bar X$?**

```{r with-ans2}
means_w <- unique(samples_w$Mean)
var_Xbar_w <- sum(means_w^2*samplingdist_mean_w)-(mean_Xbar_w)^2
var_Xbar_w
```

**What is the mean of the sampling distribution for $S^2$?**

```{r with-ans3}
vars_w <- unique(samples_w$Variance)
mean_S2_w <- sum(vars_w*samplingdist_var_w)
mean_S2_w
```

## Sampling without replacement

```{r, echo=FALSE}
samples_wo <- srs(popvalues = 1:6, n = 2)
dimnames(samples_wo) <- list(NULL, c("Draw1", "Draw2"))
sample_wo_means <- apply(X = samples_wo, MARGIN = 1, FUN = mean)
sample_wo_variances <- apply(X = samples_wo, MARGIN = 1, FUN = var)
samples_wo <- data.frame(samples_wo, Mean = sample_wo_means,
                         Variance = sample_wo_variances)
samplingdist_mean_wo <- fractions(table(samples_wo$Mean)/15)
samplingdist_var_wo <- fractions(table(samples_wo$Variance)/15)
```

**What is the mean of the sampling distribution for $\bar X$, when sampling without replacement?**

```{r wo-ans1}
means_wo <- unique(samples_wo$Mean)
mean_Xbar_wo <- sum(means_wo*samplingdist_mean_wo)
mean_Xbar_wo
```

**What is the variance of the sampling distribution for $\bar X$, when sampling without replacement?**

```{r wo-ans2}
means_wo <- unique(samples_wo$Mean)
var_Xbar_wo <- sum(means_wo^2*samplingdist_mean_wo)-(mean_Xbar_wo)^2
var_Xbar_wo
```

**What is the expected value of the sampling distribution for $S^2$, when sampling without replacement?**

```{r wo-ans3}
vars_wo <- unique(samples_wo$Variance)
mean_S2_wo <- sum(vars_wo*samplingdist_var_wo)
mean_S2_wo
```








