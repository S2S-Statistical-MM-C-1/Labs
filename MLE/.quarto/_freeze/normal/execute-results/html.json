{
  "hash": "69e2fc35efc785f249c6f96e09fa3ddf",
  "result": {
    "engine": "knitr",
    "markdown": "# Normal Distribution (Examples 7.24 & 7.25)\n\n\n\n\n\n<!--MLE for sigma^2-->\n\nSuppose $\\left\\{X_1,X_2,\\dots,X_n\\right\\}$ is a random sample from a $N\\left(\\mu, \\sigma\\right)$ distribution, where $\\mu$ is **known**. Find the maximum likelihood estimator of $\\sigma^2$, by hand. The questions below should help you understand the steps required to find the *MLE*.\n\n:::{.question}\n::::{.question-header}\nTask\n::::\n::::{.question-container}\n\n::: {.cell}\n\n:::\n\n\n:::: {.webex-check}\n**What is the probability density function (pdf) of a random variable $X\\sim{N}\\left(\\mu,\\sigma\\right)$**\n<div class='webex-radiogroup' id='radio_SXOVIPLFJU'><label><input type=\"radio\" autocomplete=\"off\" name=\"radio_SXOVIPLFJU\" value=\"\"></input> <span>$f(x)=\\frac{(\\sigma^2)^\\mu x^{\\mu-1}\\exp(-\\sigma^2x)}{\\Gamma(\\mu)}$</span></label><label><input type=\"radio\" autocomplete=\"off\" name=\"radio_SXOVIPLFJU\" value=\"answer\"></input> <span>$f(x)=\\frac{1}{\\sqrt{2\\pi\\sigma^2}}\\exp\\left(-\\frac{(x-\\mu)^2}{2\\sigma^2}\\right)$</span></label><label><input type=\"radio\" autocomplete=\"off\" name=\"radio_SXOVIPLFJU\" value=\"\"></input> <span>$f(x)=\\frac{\\mu}{2\\pi\\sigma^2}\\exp\\left(-\\frac{(x-\\mu)^2}{\\sigma^2}\\right)$</span></label><label><input type=\"radio\" autocomplete=\"off\" name=\"radio_SXOVIPLFJU\" value=\"\"></input> <span>$f(x)=\\mu\\exp(-\\mu x)$</span></label></div>\n\n::::\n\n\n<div class='webex-solution'><button>Solution</button>\n\nThe pdf of a random variable $X\\sim{N}\\left(\\mu,\\sigma\\right)$ is given by,\n\n$$\nf(x)=\\frac{1}{\\sqrt{2\\pi\\sigma^2}}\\exp\\left(-\\frac{(x-\\mu)^2}{2\\sigma^2}\\right),\\,\\,\\,\\,\\,\\,\\,\\,\\,\\,\\,-\\infty<x<\\infty.\n$$\nSee the [Probability Formula Sheet](https://gla-my.sharepoint.com/:b:/g/personal/mitchum_bock_glasgow_ac_uk/EYMw7JaKJPhJqtx7U2y8014BpMoLnJ1iyb-ELxDb8hvGYg?e=BQm80L){target=\"_blank\"}.\n\n\n</div>\n\n::::\n:::\n\n:::{.question}\n::::{.question-header}\nTask\n::::\n::::{.question-container}\n\n::: {.cell}\n\n:::\n\n::::{.webex-check}\n**What is the likelihood function of a random sample of $n$, normally distributed random variables with mean $\\mu$ and standard deviation $\\sigma$?**\n<div class='webex-radiogroup' id='radio_BKTDOZTXOU'><label><input type=\"radio\" autocomplete=\"off\" name=\"radio_BKTDOZTXOU\" value=\"\"></input> <span>$L(\\sigma^2|\\mathbb{x})=\\prod_{i=1}^n\\frac{\\mu}{2\\pi\\sigma^2}\\exp\\left(-\\frac{(x_i-\\mu)^2}{\\sigma^2}\\right)$</span></label><label><input type=\"radio\" autocomplete=\"off\" name=\"radio_BKTDOZTXOU\" value=\"\"></input> <span>$L(\\sigma^2|\\mathbb{x})=\\prod_{i=1}^n\\mu\\exp(-\\mu x_i)$</span></label><label><input type=\"radio\" autocomplete=\"off\" name=\"radio_BKTDOZTXOU\" value=\"\"></input> <span>$L(\\sigma^2|\\mathbb{x})=\\prod_{i=1}^n\\frac{(\\sigma^2)^\\mu x_i^{\\mu-1}\\exp(-\\sigma^2x_i)}{\\Gamma(\\mu)}$</span></label><label><input type=\"radio\" autocomplete=\"off\" name=\"radio_BKTDOZTXOU\" value=\"answer\"></input> <span>$L(\\sigma^2|\\mathbb{x})=\\prod_{i=1}^n\\frac{1}{\\sqrt{2\\pi\\sigma^2}}\\exp\\left(-\\frac{(x_i-\\mu)^2}{2\\sigma^2}\\right)$</span></label></div>\n\n::::\n\n\n<div class='webex-solution'><button>Solution</button>\n\nThe likelihood of $n$ random variables is given by the product of the $n$ probability density functions. In this case, the likelihood function of $n$ normally distributed random variables is given by,\n\n$$\n\\begin{align}\nL(\\sigma^2|\\mathbb{x})&=\\prod_{i=1}^nf(x_i)\\\\\n&=\\prod_{i=1}^n\\frac{1}{\\sqrt{2\\pi\\sigma^2}}\\exp\\left(-\\frac{(x_i-\\mu)^2}{2\\sigma^2}\\right)\n\\end{align}\n$$ {#eq-normallike}\n\n</div>\n\n::::\n:::\n\n:::{.question}\n::::{.question-header}\nTask\n::::\n::::{.question-container}\n\n::: {.cell}\n\n:::\n\n::::{.webex-check}\n**By taking the natural logarithm of the likelihood function, what is the log-likelihood function of $n$, normally distributed random variables with mean $\\mu$ and standard deviation $\\sigma$?**\n\n*You will need to work this out by hand and simplify the logarithm of the likelihood function.*\n<div class='webex-radiogroup' id='radio_ACRPGVQEGB'><label><input type=\"radio\" autocomplete=\"off\" name=\"radio_ACRPGVQEGB\" value=\"answer\"></input> <span>$\\ln L(\\sigma^2|\\mathbb{x})=-\\frac{n}{2}\\ln(2\\pi)-\\frac{n}{2}\\ln(\\sigma^2)-\\frac{\\sum_{i=1}^n(x_i-\\mu)^2}{2\\sigma^2}$</span></label><label><input type=\"radio\" autocomplete=\"off\" name=\"radio_ACRPGVQEGB\" value=\"\"></input> <span>$\\ln L(\\sigma^2|\\mathbb{x})=\\ln\\left[\\sum_{i=1}^n\\frac{1}{\\sqrt{2\\pi\\sigma^2}}\\right]+\\ln\\left[\\sum_{i=1}^n\\exp\\left(-\\frac{(x_i-\\mu)^2}{2\\sigma^2}\\right)\\right]$</span></label><label><input type=\"radio\" autocomplete=\"off\" name=\"radio_ACRPGVQEGB\" value=\"\"></input> <span>$\\ln L(\\sigma^2|\\mathbb{x})=-\\frac{n}{2}\\ln(2\\pi)-\\frac{n}{2}\\ln(\\sigma^2)-\\exp\\left(\\frac{\\sum_{i=1}^n(x_i-\\mu)^2}{2\\sigma^2}\\right)$</span></label><label><input type=\"radio\" autocomplete=\"off\" name=\"radio_ACRPGVQEGB\" value=\"\"></input> <span>$\\ln L(\\sigma^2|\\mathbb{x})=\\prod_{i=1}^n\\ln\\left[(2\\pi\\sigma^2)^{-\\frac{1}{2}}\\right]+\\sum_{i=1}^n\\left(-\\frac{(x_i-\\mu)^2}{2\\sigma^2}\\right)$</span></label></div>\n\n::::\n\n\n<div class='webex-solution'><button>Solution</button>\n\nThe log-likelihood can be found as follows,\n\n$$\n\\begin{align}\n\\ln L(\\sigma^2|\\mathbb{x})&=\\ln\\left[\\prod_{i=1}^n\\frac{1}{\\sqrt{2\\pi\\sigma^2}}\\exp\\left(-\\frac{(x_i-\\mu)^2}{2\\sigma^2}\\right)\\right]\\\\\n&=\\ln\\left[\\prod_{i=1}^n\\frac{1}{\\sqrt{2\\pi\\sigma^2}}\\right]+\\ln\\left[\\prod_{i=1}^n\\exp\\left(-\\frac{(x_i-\\mu)^2}{2\\sigma^2}\\right)\\right]\\\\\n&=\\sum_{i=1}^n\\ln\\left[(2\\pi\\sigma^2)^{-\\frac{1}{2}}\\right]+\\sum_{i=1}^n\\left(-\\frac{(x_i-\\mu)^2}{2\\sigma^2}\\right)\\\\\n&=-\\frac{1}{2}\\sum_{i=1}^n\\ln[2\\pi]-\\frac{1}{2}\\sum_{i=1}^n\\ln[\\sigma^2]-\\frac{\\sum_{i=1}^n(x_i-\\mu)^2}{2\\sigma^2}\\\\\n&=-\\frac{n}{2}\\ln(2\\pi)-\\frac{n}{2}\\ln(\\sigma^2)-\\frac{\\sum_{i=1}^n(x_i-\\mu)^2}{2\\sigma^2} \n\\end{align}\n$$ {#eq-normalloglike}\n\nThis is the function for which we want to find the value that maximizes it, as this will be the maximum likelihood estimator (MLE).\n\n</div>\n\n::::\n:::\n\n:::{.question}\n::::{.question-header}\nTask\n::::\n::::{.question-container}\n\n::: {.cell}\n\n:::\n\n::::{.webex-check}\n**What is the next step required to find the value of $\\sigma^2$ that maximises $\\ln L(\\sigma^2|\\mathbb{x})$?**\n<div class='webex-radiogroup' id='radio_OUDEGDVXOS'><label><input type=\"radio\" autocomplete=\"off\" name=\"radio_OUDEGDVXOS\" value=\"answer\"></input> <span>Differentiate $\\ln L(\\sigma^2|\\mathbb{x})$ with respect to $\\sigma^2$ and set equal to 0.</span></label><label><input type=\"radio\" autocomplete=\"off\" name=\"radio_OUDEGDVXOS\" value=\"\"></input> <span>Differentiate $L(\\sigma^2|\\mathbb{x})$ with respect to $\\mu$ and set equal to 0.</span></label><label><input type=\"radio\" autocomplete=\"off\" name=\"radio_OUDEGDVXOS\" value=\"\"></input> <span>Differentiate $L(\\sigma^2|\\mathbb{x})$ with respect to $\\sigma^2$ and set equal to 0.</span></label><label><input type=\"radio\" autocomplete=\"off\" name=\"radio_OUDEGDVXOS\" value=\"\"></input> <span>Differentiate $\\ln L(\\sigma^2|\\mathbb{x})$ with respect to $\\mu$ and set equal to 0.</span></label></div>\n\n::::\n\n\n<div class='webex-solution'><button>Solution</button>\n\nThe first order derivative of the log-likelihood function ([ -@eq-normalloglike]) is given by,\n\n$$\n\\begin{align}\n\\frac{\\partial\\ln L(\\sigma^2|\\mathbb{x})}{\\partial\\sigma^2}&=-\\frac{n}{2\\sigma^2}+\\frac{\\sum_{i=1}^n(x_i-\\mu)^2}{2(\\sigma^2)^2}=0\n\\end{align}\n$$\n\nThe solution to this equation is given by $\\sigma^2=\\frac{\\sum_{i=1}^n(x_i-\\mu)^2}{n}$ (try and show this yourself). \n\n</div>\n\n::::\n:::\n\n:::{.question}\n::::{.question-header}\nTask\n::::\n::::{.question-container}\n\n::: {.cell}\n\n:::\n\n::::{.webex-check}\n**What is the final step required to ensure that a maximum has been found?**\n<div class='webex-radiogroup' id='radio_QCWNOWYEOV'><label><input type=\"radio\" autocomplete=\"off\" name=\"radio_QCWNOWYEOV\" value=\"\"></input> <span>Take the second order derivative of the log-likelihood function and ensure it is positive at $\\widehat{\\sigma^2}$.</span></label><label><input type=\"radio\" autocomplete=\"off\" name=\"radio_QCWNOWYEOV\" value=\"\"></input> <span>Take the second order derivative of the likelihood function and ensure it is positive at $\\widehat{\\sigma^2}$.</span></label><label><input type=\"radio\" autocomplete=\"off\" name=\"radio_QCWNOWYEOV\" value=\"answer\"></input> <span>Take the second order derivative of the log-likelihood function and ensure it is negative at $\\widehat{\\sigma^2}$.</span></label><label><input type=\"radio\" autocomplete=\"off\" name=\"radio_QCWNOWYEOV\" value=\"\"></input> <span>Take the second order derivative of the likelihood function and ensure it is negative at $\\widehat{\\sigma^2}$.</span></label></div>\n\n::::\n\n<div class='webex-solution'><button>Solution</button>\n\nThe second order derivative of the log-likelihood function is,\n\n$$\n\\begin{align}\n\\frac{\\partial^2\\ln L(\\sigma^2|\\mathbb{x})}{\\partial(\\sigma^2)^2}=\\frac{n}{2(\\sigma^2)^2}-\\frac{\\sum_{i=1}^n(x_i-\\mu)^2}{(\\sigma^2)^3}\n\\end{align}\n$$\n\nThen, to ensure that a maximum of the log-likelihood function has been found, we need to show that $\\frac{\\partial^2\\ln L(\\sigma^2|\\mathbb{x})}{\\partial(\\sigma^2)^2}<0$ when $\\sigma^2=\\frac{\\sum_{i=1}^n(x_i-\\mu)^2}{n}$.\n\nThat is, we want to check that when we sub in $\\sigma^2=\\frac{\\sum_{i=1}^n(x_i-\\mu)^2}{n}$,\n\n$$\n\\begin{align}\n\\frac{\\partial^2\\ln L(\\sigma^2|\\mathbb{x})}{\\partial(\\sigma^2)^2}=\\frac{n}{2(\\sigma^2)^2}-\\frac{\\sum_{i=1}^n(x_i-\\mu)^2}{(\\sigma^2)^3}&<0\\\\\n\\frac{n\\sigma^2}{2}-\\sum_{i=1}^n(x_i-\\mu)^2&<0\\\\\n\\frac{n}{2}\\frac{\\sum_{i=1}^n(x_i-\\mu)^2}{n}-\\sum_{i=1}^n(x_i-\\mu)^2&<0\\\\\n-\\frac{1}{2}\\sum_{i=1}^n(x_i-\\mu)^2&<0\n\\end{align}\n$$\n\nwhich is true since $\\sum_{i=1}^n(x_i-\\mu)^2>0$.\n\nTherefore, the **maximum likelihood estimate** of $\\sigma^2$ is $\\widehat{\\sigma^2}(\\mathbb{x})=\\frac{\\sum_{i=1}^n(x_i-\\mu)^2}{n}$.\n\n</div>\n\n\n::::\n:::\n\n\n**Simulating a sample and it's corresponding MLE**\n\nWe can draw 1000 random samples from a $N(4, 1)$ distribution, to verify that our maximum likelihood estimator $\\widehat{\\sigma^2}(\\mathbb{x})=\\frac{\\sum_{i=1}^n(x_i-\\mu)^2}{n}$ gives a reasonably close estimate to the true parameter $\\sigma^2=1$.\n\nTo start with, draw and save the samples in the vector `x` using the code below. Here, the function `set.seed()` has been used so that the random numbers selected when `rnorm()` is used are always the same, no matter how many times the code is run. It doesn't matter what value is used inside `set.seed()`, as long as it is always the same value each time the code is run, the random values will remain the same.  If you use the value `123` as in this code, you will get the same results as shown below.\n\n::: panel-tabset\n## R Code\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(123)\nn <- 1000\nmu <- 4\nsigma <- 1\nx <- rnorm(n = n, mean = mu, sd = sigma)\n```\n:::\n\n:::\n\nIn the quiz questions above, we saw that the log-likelihood function is given by,\n\n$$\n\\ln L(\\sigma^2|\\mathbb{x})=-\\frac{n}{2}\\ln(2\\pi)-\\frac{n}{2}\\ln(\\sigma^2)-\\frac{\\sum_{i=1}^n(x_i-\\mu)^2}{2\\sigma^2}\n$$\n\nWrite a function in R called `loglike_sigma2` which will take the values in `x` and a given value for $\\sigma^2$, and return the value of $\\ln L(\\sigma^2|\\mathbb{x})$ using the code:\n\n::: panel-tabset\n## R code\n\n::: {.cell}\n\n```{.r .cell-code}\nloglike_sigma2 <- function(sigma2){\n  -n/2*log(2*pi) - n/2*log(sigma2) - (sum((x-mu)^2))/(2*sigma2)\n}\n```\n:::\n\n:::\n\nCalculate the value of the maximum likelihood estimator (MLE), $\\widehat{\\sigma^2}=\\frac{\\sum_{i=1}^n(x_i-\\mu)^2}{n}$, based on the simulated data stored in `x` using:\n\n::: panel-tabset\n## R Code\n\n::: {.cell}\n\n```{.r .cell-code}\nmle_sigma2 <- sum((x-mu)^2)/n\n```\n:::\n\n:::\n\nThis tells us that $\\widehat{\\sigma^2}=0.983$, based on this observed sample.\n\nUse `ggplot2` to show a plot of the log-likelihood function ([ -@eq-normalloglike]) and add a vertical line at the maximum likelihood estimate $\\widehat{\\sigma^2}=0.983$ using:\n\n::: panel-tabset\n## R code\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data.frame(x = c(0.5, 2.45)), aes(x = x)) +\n  stat_function(fun = loglike_sigma2, n = 200) +\n  labs(x = expression(sigma^2),\n       y = \"log-likelihood\") +\n  geom_vline(xintercept = mle_sigma2, lty = \"dashed\")\n```\n:::\n\n\n## Plots\n\n::: {.cell}\n::: {.cell-output-display}\n![](normal_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n:::\n\nThe reason that this estimate is not **exactly** equal to $\\sigma^2=1$, which we used to draw the random sample, is because the maximum likelihood estimator is dependent on the sample observed. It gives us an *estimate* of the true population parameter, based on the sample. As we can see in the plot, this estimate is relatively close to the true population parameter $\\sigma^2=1$.\n\nAfter having defined the function `loglike_sigma2`, we could use the function `optimize()` to find the maximum likelihood estimate. When the code below is run, we see again that the value that maximizes this function is $\\widehat{\\sigma^2}=0.983$ which is in agreement with what we found 'by hand'.\n\n::: panel-tabset\n## R Code\n\n::: {.cell}\n\n```{.r .cell-code}\noptimize(f = loglike_sigma2, interval = c(0.5, 2.5), maximum = TRUE)\n```\n:::\n\n\n## Output\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n$maximum\n[1] 0.9827153\n\n$objective\n[1] -1410.231\n```\n\n\n:::\n:::\n\n:::\n\nWe could also use the `nlm()` function to find the value that maximizes the log-likelihood function, but remember this actually only finds *minimum* values of a given function, so we first have to define the negative of the log-likelihood function, `negloglike_sigma2`.\n\n::: panel-tabset\n## R Code\n\n::: {.cell}\n\n```{.r .cell-code}\nnegloglike_sigma2 <- function(sigma2){\n  (-1)*loglike_sigma2(sigma2)\n}\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nnlm(f = negloglike_sigma2, p = 0.5)$estimate\n```\n:::\n\n\n## Output\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.9827351\n```\n\n\n:::\n:::\n\n:::\n\nThis again shows us that the value that maximizes of the log-likelihood function ([ -@eq-normalloglike]) is $\\widehat{\\sigma^2}=0.983$, based on our observed sample.\n\n---\n\nYou can find more examples of finding maximum likelihood estimators, both 'by hand' and using R in [Section 7.3.2 Likelihood and Maximum Likelihood Estimators](https://read.kortext.com/reader/pdf/92741/419){target=\"_blank\"} of *Probability and Statistics with R*.\n\n\n\n\n\n\n\n\n",
    "supporting": [
      "normal_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}