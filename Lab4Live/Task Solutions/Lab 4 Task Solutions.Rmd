---
title: "S2S Lab 4 Task Solutions"
output:
  pdf_document:
    number_sections: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(knitr)
library(PASWR2)
data("EPIDURAL")
```

# Welcome!

# Qualitative Data

## Tables

**The levels of `ease` are automatically presented in alphabetical order. Can you reorder the labels so that they go in the order `"Easy"`, `"Difficult"` and `"Impossible"`?**

```{r qual-ans1.1}
EPIDURAL$ease <- factor(x = EPIDURAL$ease,
                        levels = c("Easy", "Difficult", "Impossible"))
levels(EPIDURAL$ease)
```

The function `levels()` can be used to see the levels of a factor variable, as well as the order they are stored in.

We can update the frequency table `epi_freq` so that the different levels of `ease` now appear in a sensible order.

```{r qual-ans1.2}
epi_freq <- table(EPIDURAL$ease)
epi_freq
```

**The `TITANIC3` data set from the `PASWR2` package contains information on the survival status of passengers on the Titanic. Load this data set into your Environment tab and create a frequency table showing the number of passengers who survived and the number who did not.**

**Remember to explore the data set using the `help()` and `str()` functions. It might help to rename the levels of the `survived` variable so they are clear.**

```{r qual-ans2}
data("TITANIC3")

TITANIC3$survived <- factor(x = TITANIC3$survived, labels = c("No", "Yes"))

table(TITANIC3$survived)
```

**What proportion of passengers survived the Titanic sinking?**

We can find the proportion of survivors by using the `prop.table()` function.

```{r qual-ans3}
prop.table(table(TITANIC3$survived))
```

## Barplots

**Complete the code below to create a barplot which shows the number of passengers on the Titanic belonging to 1^st^, 2^nd^ and 3^rd^ class respectively.**

```{r qual-ans4, out.width='60%', ,fig.align='center'}
barplot(height = table(TITANIC3$pclass),
        col = c("gray32", "gray95", "seashell3"),
        main = "Number of Titanic Passengers in each Class",
        xlab = "Class",
        ylab = "Frequency")
```

## Dot Charts

## Pie Charts

**Create a pie chart showing the proportion of passengers on the Titanic in each class.**

```{r qual-ans5, fig.align='center', out.width='60%'}
pie(x = table(TITANIC3$pclass),
    col = c("gray32", "gray95", "seashell3"),
    main = "Class of Titanic Passengers")
```

## Bivariate Data

**Create a two-way contingency table showing the number of passengers who survived and did not survive in each of the three classes (1^st^, 2^nd^ and 3^rd^).**

```{r qual-ans6}
table(TITANIC3$pclass, TITANIC3$survived)
```

**How many 3^rd^ class passengers survived the sinking of the Titanic?**

181

**Create a barplot showing the proportion of passengers in each class who survived and the proportion who did not.**

**Make sure the bars are side-by-side, and that the "class" variable is shown along the x-axis.**

```{r qual-ans7, out.width='60%', fig.align='center'}
surv_prop <- prop.table(table(TITANIC3$pclass, TITANIC3$survived), margin = 1)

barplot(height = t(surv_prop),
        legend.text = TRUE,
        beside = TRUE,
        main = "Proportion of Passengers Surviving the Titanic Sinking in each Class",
        xlab = "Class",
        ylab = "Proportion")
```

# Quantitative Data

## Stem and Leaf Plots

**How would you describe the shape of the distribution of patients' weights?**

Right-skewed

## Strip Charts

**Complete the code below to create a stripchart showing the distribution of passenger ages in each class on board the Titanic.**

```{r quant-ans2, fig.height=5, out.width='60%', fig.align='center'}
stripchart(x = age ~ pclass,
           data = TITANIC3,
           method = "stack",
           pch = 20,
           col = c("gray32", "gray95", "seashell3"),
           main = "Ages of Passenegers on the Titanic",
           xlab = "Age",
           ylab = "Class")
```

## Histograms

**What single value would you provide to the `breaks =` argument to create the density histogram of passenger ages on the Titanic shown below?**

```{r quant-ans3.1, echo=FALSE, fig.align="center", out.width='60%'}
hist(x = TITANIC3$age,
     breaks = 8,
     freq = FALSE,
     main = "Ages of Passengers on the Titanic",
     xlab = "Age")
```

**If you instead wanted to provide the argument `breaks =` with a sequence generated using the `seq()` function, how would you do this?**

Both chunks of code below will produce the same histogram shown above.

```{r quant-ans3.3, eval=FALSE, fig.align="center"}
hist(x = TITANIC3$age,
     breaks = 8,
     freq = FALSE,
     main = "Ages of Passengers on the Titanic",
     xlab = "Age")
```

```{r quant-ans3.4, eval=FALSE, fig.align="center"}
hist(x = TITANIC3$age,
     breaks = seq(from = 0, to = 80, by = 10),
     freq = FALSE,
     main = "Ages of Passengers on the Titanic",
     xlab = "Age")
```

## Kernel Density Estimators

**Create a plot only showing the kernel density estimate for distribution of passenger ages on the Titanic.**

```{r quant-ans4, out.width='60%', fig.align='center'}
age_dens <- density(x = TITANIC3$age, na.rm = TRUE)

plot(age_dens, col = "gray32", lwd = 2,
     main = "Density of Passeneger Ages")
```

# Comparing Samples

## Comparing Histograms

**How would you compare the two distributions shown in the histograms above?**

* "Both distributions are skewed to the right."
* "The distribution for the hamstring stretch group is more extremely skewed than the distribution for the traditional sitting group."

## Comparing Density Estimates

## QQ Plots

**Create a new subset of the `TITANIC3` data frame that contains the ages of all passengers who survived the sinking. Plot the quantiles of the distribution of age against the quantiles of a standard normal distribution in a QQ plot.**

```{r comp-ans2, out.width='60%', fig.align='center'}
age_survived <- subset(x = TITANIC3,
                       subset = (survived == "Yes"),
                       select = age)

qqnorm(y = age_survived$age)
qqline(y = age_survived$age)
```

**Do you think that the ages of passengers who survived the sinking of the Titanic follow a normal distribution?**

No

# ggplot2

## Barplots

**Complete the code below to create the barplot showing the number of passengers who survived and did not survive in each class from the `TITANIC3` data set beneath.**

```{r gg-ans1.1, echo=FALSE, fig.align='center', out.width='60%'}
ggplot(data = TITANIC3) +
  geom_bar(aes(x = pclass, fill = survived), position = "dodge") +
  labs(title = "Passengers Surviving the Titanic Sinking in each Class",
       x = "Class", y = "Frequency") +
  guides(fill = guide_legend("Did the passenger survive?"))
```

```{r gg-ans1.2, eval=FALSE}
ggplot(data = TITANIC3) +
  geom_bar(aes(x = pclass, fill = survived), position = "dodge") +
  labs(title = "Passengers Surviving the Titanic Sinking in each Class",
       x = "Class", y = "Frequency") +
  guides(fill = guide_legend("Did the passenger survive?"))
```

## Histograms

**Create a histogram, using ggplot2, showing the ages of all passengers on the Titanic. Label your plot appropriately and consider using different binwidths to explore the shape of the distribution.**

```{r gg-ans2, warning=FALSE, fig.align='center', out.width='60%'}
ggplot(data = TITANIC3) +
  geom_histogram(aes(x = age), binwidth = 10) +
  labs(title = "Ages of Passengers on the Titanic",
       x = "Age", y = "Frequency")
```

## Kernel Density Estimators

**Complete the code below to create the following histogram and density plots which show the distribution of passenger age for each class of passengers on board the Titanic.**

```{r gg-ans3.1, echo=FALSE, warning=FALSE, fig.align='center', out.width='60%'}
ggplot(data = TITANIC3) +
  geom_histogram(aes(x = age, y = after_stat(density), fill = pclass),
                 binwidth = 5) +
  geom_density(aes(x = age)) +
  facet_grid(pclass ~ .) +
  labs(title = "Density of Passenger Ages",
       x = "Age", y = "Density") +
  guides(fill = "none")
```

```{r gg-ans3.2, eval=FALSE, warning=FALSE, fig.align='center'}
ggplot(data = TITANIC3) +
  geom_histogram(aes(x = age, y = after_stat(density), fill = pclass),
                 binwidth = 5) +
  geom_density(aes(x = age)) +
  facet_grid(pclass ~ .) +
  labs(title = "Density of Passenger Ages",
       x = "Age", y = "Density") +
  guides(fill = "none")
```






