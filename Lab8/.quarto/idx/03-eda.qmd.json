{"title":"Exploratory Analysis","markdown":{"yaml":{"title":"Exploratory Analysis","number-sections":true},"headingText":"Reading in the data","containsRefs":false,"markdown":"\n\n```{r setup, include=FALSE}\nknitr::opts_chunk$set(echo=TRUE, eval=TRUE, comment=NA)\nlibrary(webexercises)\nlibrary(PASWR2)\nlibrary(knitr)\nlibrary(kableExtra)\nlibrary(ggplot2)\nlibrary(tidyverse)\n```\n\n\nThe observed yields can be found in the file *yields.csv*.\n\nTo read *yields.csv* into R, you will first need to download it from [Moodle](https://moodle.gla.ac.uk/mod/folder/view.php?id=4944039){target=\"_blank\"} and save it somewhere accessible. Then, set your working directory in R to point to wherever you have saved this file. For a reminder on setting your working directory, see [Lab 3 Section 2.1](https://moodle.gla.ac.uk/pluginfile.php/9073238/mod_resource/content/4/01-reading.html#directory){target=\"_blank\"}.\n\nTo load the data frame into the **Environment** tab and call it `yields`, we can use the code below.\n\n```{r, echo = FALSE}\nyields <- read.csv(\"data/yields_long.csv\")\n```\n\n::: panel-tabset\n## R Code\n\n```{r, eval = FALSE}\nyields <- read.csv(file = \"yields.csv\")\n```\n:::\n\nIt is always good practise to open the original file to check, for example, for any missing values and the column headings used. Make sure to check that the data frame is saved in R as you would expect. Once you have read `yields` into your R session, we should explore its contents.\n\n::: panel-tabset\n## R Code\n\n```{r, eval = FALSE}\nhead(yields)\n```\n\n## Output\n\n```{r, echo = FALSE}\nhead(yields)\n```\n:::\n\nWe can see that there are 3 columns in `yields`,\n\n-   `fertiliser`: this is a categorical variable stating whether fertiliser was used or not in the field.\n\n-   `crop`: this is a categorical variable stating whether the crop grown in the field was potatoes or wheat.\n\n-   `yield`: this is the yield (in tonnes) of the crop harvested from each field.\n\n<!---   `supermarket`: this is a binary variable; a 1 indicates that the yield from that particular field has been sold to supermarkets and a 0 indicates that the field's yield has been sold elsewhere or kept.-->\n\nBecause `fertiliser` and `crop` are columns of categorical data, we should switch them to be factors. In the code below, note that the argument `levels =` is used with `fertiliser` and `crop` because they are already labelled in the dataset<!--, however the argument `labels =` is used with `supermarket` to relabel each observation from a 0 or 1.-->\n\n::: panel-tabset\n## R Code\n\n```{r}\nyields$fertiliser <- factor(x = yields$fertiliser, \n                            levels = c(\"Used\", \"Not used\"))\n\nyields$crop <- factor(x = yields$crop, \n                      levels = c(\"potato\", \"wheat\"))\n```\n:::\n\n```{r, echo=FALSE}\n#yields$supermarket <- factor(x = yields$supermarket,\n#                             labels = c(\"elsewhere\", \"supermarket\"))\n```\n\n## Summary statistics\n\nSince we are interested in finding any differences between the mean yields of potatoes from fertilised and unfertilised fields, it makes sense to split the data into distinct subsets. `potato_fertilised` and `potato_unfertilised`, created using the code below, store the potato yields where fertiliser was used and fertiliser was not used respectively.\n\n::: panel-tabset\n## R Code\n\n```{r}\npotato_fertilised <- subset(x = yields,\n                            subset = (fertiliser == \"Used\" & crop == \"potato\"))\n\npotato_unfertilised <- subset(x = yields,\n                              subset = (fertiliser == \"Not used\" & crop == \"potato\"))\n```\n:::\n\n::: question\n::: question-header\nTask\n:::\n\n::: question-container\nSimilarly, we are interested in differences between the mean yields of wheat from fertilised and unfertilised fields.\n\nCreate two subsets, `wheat_fertilised` which stores the wheat yields from fields where fertiliser was used, and `wheat_unfertilised` which stores the wheat yields from fields where fertiliser was not used.\n\n`r hide(\"Solution\")`\n\n::: panel-tabset\n## R Code\n\n```{r}\nwheat_fertilised <- subset(x = yields,\n                           subset = (fertiliser == \"Used\" & crop == \"wheat\"))\n\nwheat_unfertilised <- subset(x = yields,\n                             subset = (fertiliser == \"Not used\" & crop == \"wheat\"))\n```\n:::\n\n`r unhide()`\n:::\n:::\n\nNow that we have sensible subsets from the data, we can summarise the yield of crops from each type of field in some way. It would be appropriate to find the sample mean yield, for example, in each case and present these in a table within the statistical report.\n\nThe `mean()` function can be used to find the mean of a vector of numerical values. The only argument that the `mean()` function takes is,\n\n-   `x =`: this is the vector of values to calculate the mean of. This can be numeric or logical.\n\n::: question\n::: question-header\nTask\n:::\n\n::: question-container\nUse the function `mean()` to find the mean yield of potatoes from each type of field, and the mean yield of wheat from each type of field.\n\nWithin the **Exploratory Analysis** section of your report, include the values you calculate in a table similar to the one below. Make sure to caption your table appropriately, and write a short paragraph which introduces where these values come from.\n\n```{r, echo = FALSE}\ndata.frame(Crop = c(\"Potato\", \"Wheat\"), Fertilised = c(\"\", \"\"), Unfertilised = c(\"\", \"\")) %>%\n  column_to_rownames(\"Crop\") %>%\n  kable(table.attr = 'data-quarto-disable-processing=\"true\"; style=\"width:50%;\"') %>%\n  kable_styling(bootstrap_options = c(\"striped\")) %>%\n  kable_paper(position = \"center\") %>%\n  column_spec(1, bold = TRUE, border_right = TRUE)\n```\n\n`r hide(\"Solution\")`\n\nIn order to find the mean yield in each case we're interested in, the following code can be used.\n\n::: panel-tabset\n## R Code\n\n```{r, eval = FALSE}\nmean(x = potato_fertilised$yield)\nmean(x = potato_unfertilised$yield)\nmean(x = wheat_fertilised$yield)\nmean(x = wheat_unfertilised$yield)\n```\n\n## Output\n\n```{r, echo = FALSE}\nmean(potato_fertilised$yield)\nmean(potato_unfertilised$yield)\nmean(wheat_fertilised$yield)\nmean(wheat_unfertilised$yield)\n```\n:::\n\nThese values can then be rounded to 2 decimal places and input into a table in the report such as,\n\n```{r tbl-yield_means, echo = FALSE}\n#| label: tbl-yield_means\n#| tbl-cap: Sample mean yield of potato and wheat yields from fields where fertiliser was and was not used.\n\ndata.frame(Crop = c(\"Potato\", \"Wheat\"), \n           Fertilised = c(round(mean(potato_fertilised$yield), 2),\n                          round(mean(wheat_fertilised$yield), 2)), \n           Unfertilised = c(round(mean(potato_unfertilised$yield), 2), \n                            round(mean(wheat_unfertilised$yield), 2))) %>%\n  column_to_rownames(\"Crop\") %>%\n  kable(table.attr = 'data-quarto-disable-processing=\"true\"; style=\"width:50%;\"') %>%\n  kable_styling(bootstrap_options = c(\"striped\")) %>%\n  kable_paper(position = \"center\") %>%\n  column_spec(1, bold = TRUE, border_right = TRUE)\n```\n\n`r unhide()`\n:::\n:::\n\nFor any output we include in the **Exploratory Analysis** section of the statistical report, we want to explain the initial impressions that this output provides and what we might then expect a formal answer to the aims to be. We can use @tbl-yield_means to informally compare the yield of each crop in the presence and absence of fertiliser.\n\n::: question\n::: question-header\nTask\n:::\n\n::: {.question-container .webex-check}\n```{r MCQ1, echo=FALSE}\noptsQ1 <- c(answer = \"The sample mean yield of potatoes from fertilised fields seems to be approximately equal to the sample mean yield of potatoes from unfertilised fields.\",\n            \"The sample mean yield of potatoes from fertilised fields is equal to the sample mean yield of potatoes from unfertilised fields.\",\n            \"The sample mean yield of potatoes from fertilised fields is substantially different from the sample mean yield of potatoes from unfertilised fields.\")\n```\n\nHow do the sample mean yields of potatoes from fertilised and unfertilised fields compare to each other? `r longmcq(sample(optsQ1))`\n:::\n:::\n\n::: question\n::: question-header\nTask\n:::\n\n::: {.question-container .webex-check}\n```{r MCQ2, echo=FALSE}\noptsQ2 <- c(\"The sample mean yield of wheat from fertilised fields seems to be approximately equal to the sample mean yield of wheat from unfertilised fields.\",\n            \"The sample mean yield of wheat from fertilised fields is equal to the sample mean yield of wheat from unfertilised fields.\",\n            answer = \"The sample mean yield of wheat from fertilised fields is substantially different from the sample mean yield of wheat from unfertilised fields.\")\n```\n\nHow do the sample means of wheat yields from fertilised and unfertilised fields compare to each other? `r longmcq(sample(optsQ2))`\n:::\n:::\n\n````{=html}\n<!--\nWe are also interested in the population proportion of crops that the farmers might expect to sell to supermarkets.\n\nWe can think of whether or not a field's yield is sold to supermarkets as being a realisation from a Bernoulli trial with some unknown probability of being sold to supermarkets, $\\pi$. In other words, the `r nrow(yields)` values in the supermarket column come from a $\\mbox{Bernoulli}(\\pi)$ distribution and we are interested in finding $\\pi$.\n\nA good place to start with this part of the analysis is to state what the *sample proportion*, $p$, of fields' yields sold to supermarkets is. We can find $p$ by again using the `mean()` function.\n\n::: question\n::: question-header\nTask\n:::\n::: question-container\nWhat is the sample proportion of all yields which are sold to supermarkets? $p=$`r fitb(round(mean(yields$supermarket == \"supermarket\"), 1:7))`\n\n`r hide(\"Solutions\")` Since we are interested in the proportion of yields of all crops which are sold to supermarkets, we need to use the full data set `yields`, rather than any of the subsets we created. The sample proportion of all yields which are sold to supermarkets can be found using the code below.\n\n::: panel-tabset\n## R Code\n```{r, eval=FALSE}\nmean(yields$supermarket == \"supermarket\")\n```\n\n## Output\n```{r, echo=FALSE}\nmean(yields$supermarket == \"supermarket\")\n```\n:::\n\nTherefore, $p=0.3857$. `r unhide()`\n:::\n:::\n\n::: question\n::: question-header\nTask\n:::\n::: question-container\nAdd a sentence to your report which states what the sample proportion of field's yields sold to supermarkets is.\n:::\n:::\n-->\n````\n\n## Exploratory plots\n\nIn order to informally answer the [aims](02-intro.qmd#sec-aims) of our analysis, it is also a good idea to produce some appropriate plots that will graphically summarise the information contained in the data. For a reminder of how to create various plots in R, see [Lab 4](https://moodle.gla.ac.uk/pluginfile.php/9073320/mod_resource/content/6/index.html){target=\"_blank\"}.\n\n### Aim 1\n\n**Is there a difference between the mean yields of potatoes from fields that were fertilised and fields that were unfertilised?**\n\n::: question\n::: question-header\nTask\n:::\n\n::: {.question-container .webex-check}\n```{r MCQ3, echo=FALSE}\noptsQ3.1 <- c(\"Barplots\", answer = \"Histograms\", \"Pie charts\")\noptsQ3.2 <- c(answer = \"Kernel density estimates\", \"Dot charts\")\noptsQ3.3 <- c(answer = \"Boxplots\")\n```\n\nWhat might some sensible plots for summarising the yield of potatoes from the two types of fields be? `r longmcq(sample(c(optsQ3.1, optsQ3.2, optsQ3.3)))`\n:::\n:::\n\nTo investigate our first aim, we will use a histogram here but there are other sensible options for presenting quantitative data. A histogram allows us to roughly see the spread of the distribution of potato yields from the sample and consider things such as,\n\n-   whether the population means of the two groups might be equal.\n\n-   if the population standard deviations look approximately equal between the groups.\n\nThe code below can be used to create two side-by-side histograms of potato yields from fertilised and unfertilised fields. So that they are comparable, the binwidths and range of the axes are forced to be the same. This is done by specifying the same sequence in the `breaks =` argument and the same range of the y-axis in the `ylim =` argument for both histograms.\n\n::: panel-tabset\n## R Code\n\n```{r, eval = FALSE}\npar(mfrow = c(2, 1))\n\nhist(x = potato_fertilised$yield,\n     breaks = seq(from = 25, to = 50, by = 2.5),\n     col = \"darkseagreen\",\n     ylim = c(0, 30),\n     main = \"Potato Yield from Fertilised Fields\",\n     xlab = \"Yield (tonnes)\")\n\nhist(x = potato_unfertilised$yield,\n     breaks = seq(from = 25, to = 50, by = 2.5),\n     col = \"darkseagreen1\",\n     ylim = c(0, 30),\n     main = \"Potato Yield from Unfertilised Fields\",\n     xlab = \"Yield (tonnes)\")\n\npar(mfrow = c(1, 1))\n```\n\n## Plots\n\n```{r, echo = FALSE}\npar(mfrow = c(2, 1))\n\nhist(x = potato_fertilised$yield,\n     breaks = seq(from = 25, to = 50, by = 2.5),\n     col = \"darkseagreen\",\n     ylim = c(0, 30),\n     main = \"Potato Yield from Fertilised Fields\",\n     xlab = \"Yield (tonnes)\")\n\nhist(x = potato_unfertilised$yield,\n     breaks = seq(from = 25, to = 50, by = 2.5),\n     col = \"darkseagreen1\",\n     ylim = c(0, 30),\n     main = \"Potato Yield from Unfertilised Fields\",\n     xlab = \"Yield (tonnes)\")\n\npar(mfrow = c(1, 1))\n```\n:::\n\nNow, we can consider some questions that might be useful to informally answer the aim, or inform the statistical method we could use to formally answer it.\n\n::: question\n::: question-header\nTask\n:::\n\n::: {.question-container .webex-check}\n```{r MCQ4, echo=FALSE}\noptsQ4 <- c(answer = \"The sample mean yield of potatoes from fertilised fields seems to be approximately equal to the sample mean yield of potatoes from unfertilised fields.\",\n            \"The sample mean yield of potatoes from fertilised fields is equal to the sample mean yield of potatoes from unfertilised fields.\",\n            \"The sample mean yield of potatoes from fertilised fields is substantially different from the sample mean yield of potatoes from unfertilised fields.\")\n```\n\nHow do the sample mean yields of potatoes from fertilised and unfertilised fields compare to each other? `r longmcq(sample(optsQ4))`\n:::\n:::\n\n::: question\n::: question-header\nTask\n:::\n\n::: {.question-container .webex-check}\n```{r MCQ5, echo=FALSE}\noptsQ5 <- c(answer = \"The sample standard deviation of potato yields from fertilised fields seems to be approximately equal to the sample standard deviation of potato yields from unfertilised fields.\",\n            \"The sample standard deviation of potato yields from fertilised fields is much smaller than the sample standard deviation of potato yields from unfertilised fields.\",\n            \"The sample standard deviation of potato yields from fertilised fields is equal to the sample standard deviation of potato yields from unfertilised fields.\")\n```\n\nHow do the sample standard deviations of potato yields from fertilised and unfertilised fields compare to each other? `r longmcq(sample(optsQ5))`\n:::\n:::\n\n::: question\n::: question-header\nTask\n:::\n\n::: question-container\nAdd the histograms you have created in R to the **Exploratory Analysis** section of your statistical report. Make sure to caption your figure appropriately.\n\nWrite a paragraph that describes what the histograms show, the initial comparisons between the two groups of potato yield and how this relates to the aims of the analysis.\n\n`r hide(\"Copying plots from R\")` Once you have created a plot in the **Plots** tab of R studio, saving it to your clipboard is easy!\n\n![Copying plots from the Plots tab in R studio.](images/copy_plots.gif){#fig-cpoy_plots} You can resize the plot in the pop-up window so it is a useful size. Then, once you click **Copy Plot** it is ready to paste wherever you need it.\n\n`r unhide()`\n:::\n:::\n\nWhen it comes to formally looking for a statistical difference between the mean potato yields from the two types of field (we'll look at this in depth in Lab 9), it may be useful to know whether the yields from both types of field follow a normal distribution. We could use the histograms produced above to comment on this assumption of normality, but another useful to plot to show is a QQ plot.\n\nThe code below produces two side-by-side QQ plots; one for the potato yields from fertilised fields and one for the potato yields from unfertilised fields.\n\n::: panel-tabset\n## R Code\n\n```{r, eval = FALSE}\npar(mfrow = c(1, 2))\n\nqqnorm(y = potato_fertilised$yield,\n       main = \"Potato Yield from Fertilised Fields\")\nqqline(y = potato_fertilised$yield)\n\nqqnorm(y = potato_unfertilised$yield,\n       main = \"Potato Yield from Unfertilised Fields\")\nqqline(y = potato_unfertilised$yield)\n\npar(mfrow = c(1, 1))\n```\n\n## Plots\n\n```{r, echo = FALSE}\npar(mfrow = c(1, 2))\n\nqqnorm(y = potato_fertilised$yield,\n       main = \"Potato Yield from\\nFertilised Fields\")\nqqline(y = potato_fertilised$yield)\n\nqqnorm(y = potato_unfertilised$yield,\n       main = \"Potato Yield from\\nUnfertilised Fields\")\nqqline(y = potato_unfertilised$yield)\n\npar(mfrow = c(1, 1))\n```\n:::\n\n::: question\n::: question-header\nTask\n:::\n\n::: {.question-container .webex-check}\n```{r MCQ6, echo=FALSE}\noptsQ6 <- c(answer = \"The potato yield seems to reasonably follow a normal distribution for both types of field.\",\n            \"The potato yield from fertilised fields seems to reasonably follow a normal distribtion, whereas the potato yield from unfertilised fields does not.\",\n            \"The potato yield from unfertilised fields seems to reasonably follow a normal distribtion, whereas the potato yield from fertilised fields does not.\")\n```\n\nHow would you describe the normality of potato yields from fertilised and unfertilised fields from the sample? `r longmcq(sample(optsQ6))`\n:::\n:::\n\n::: question\n::: question-header\nTask\n:::\n\n::: question-container\nAdd the QQ plots you have created in R to the **Exploratory Analysis** section of your statistical report. Make sure to caption the figure appropriately.\n\nWrite a paragraph that describes what the QQ plots show, describing how closely the yields appear to follow a normal distribution.\n:::\n:::\n\n### Aim 2\n\n**Is there a difference between the mean yields of wheat from fields that were fertilised and fields that were unfertilised?**\n\nOur second aim is similar to the first, but focuses on wheat yields rather than potato yields. Therefore, the same type of plots will be useful to us here, as long as this time they are produced using the subsets `wheat_fertilised` and `wheat_unfertilised` created earlier.\n\nA histogram of wheat yield from fertilised fields and from unfertilised fields will allow us to consider things such as,\n\n-   whether the population means of the two groups seem to be equal\n\n-   if the population standard deviations look approximately equal between the groups.\n\nThe code below creates two side-by-side histograms of wheat yields from fertilised and unfertilised fields. The binwidths used, set by the `break =` argument, and the range of the y-axis, set by the `ylim =` argument, are kept consistent across the two histograms so they are comparable.\n\n::: panel-tabset\n## R Code\n\n```{r, eval = FALSE}\npar(mfrow = c(2, 1))\n\nhist(x = wheat_fertilised$yield,\n     breaks = seq(from = 12, to = 32, by = 1),\n     col = \"brown\",\n     ylim = c(0, 40),\n     main = \"Wheat Yield from Fertilised Fields\",\n     xlab = \"Yield (tonnes)\")\n\nhist(x = wheat_unfertilised$yield,\n     breaks = seq(from = 12, to = 32, by = 1),\n     col = \"brown1\",\n     ylim = c(0, 40),\n     main = \"Wheat Yield from Unfertilised Fields\",\n     xlab = \"Yield (tonnes)\")\n\npar(mfrow = c(1, 1))\n```\n\n## Plots\n\n```{r, echo = FALSE}\npar(mfrow = c(2, 1))\n\nhist(x = wheat_fertilised$yield,\n     breaks = seq(from = 12, to = 32, by = 1),\n     col = \"brown\",\n     ylim = c(0, 40),\n     main = \"Wheat Yield from Fertilised Fields\",\n     xlab = \"Yield (tonnes)\")\n\nhist(x = wheat_unfertilised$yield,\n     breaks = seq(from = 12, to = 32, by = 1),\n     col = \"brown1\",\n     ylim = c(0, 40),\n     main = \"Wheat Yield from Unfertilised Fields\",\n     xlab = \"Yield (tonnes)\")\n\npar(mfrow = c(1, 1))\n```\n:::\n\nThe histograms can help give an initial impression of what an informal answer to the second aim might be.\n\n::: question\n::: question-header\nTask\n:::\n\n::: {.question-container .webex-check}\n```{r MCQ7, echo=FALSE}\noptsQ7 <- c(\"The sample mean yield of wheat from fertilised fields seems to be approximately equal to the sample mean yield of wheat from unfertilised fields.\",\n            \"The sample mean yield of wheat from fertilised fields is equal to the sample mean yield of wheat from unfertilised fields.\",\n            answer = \"The sample mean yield of wheat from fertilised fields is substantially different from the sample mean yield of wheat from unfertilised fields.\")\n```\n\nHow do the sample means of wheat yields from fertilised and unfertilised fields compare to each other? `r longmcq(sample(optsQ7))`\n:::\n:::\n\n::: question\n::: question-header\nTask\n:::\n\n::: {.question-container .webex-check}\n```{r MCQ8, echo=FALSE}\noptsQ8 <- c(\"The sample standard deviation of wheat yields from fertilised fields seems to be approximately equal to the sample standard deviation of wheat yields from unfertilised fields.\",\n            \"The sample standard deviation of wheat yields from fertilised fields is much smaller than the sample standard deviation of wheat yields from unfertilised fields.\",\n            answer = \"The sample standard deviation of wheat yields from fertilised fields seems to be greater than the sample standard deviation of wheat yields from unfertilised fields.\")\n```\n\nHow do the sample standard deviations of wheat yields from fertilised and unfertilised fields compare to each other? `r longmcq(sample(optsQ8))`\n:::\n:::\n\n::: question\n::: question-header\nTask\n:::\n\n::: question-container\nAdd the histograms you have created in R to the **Exploratory Analysis** section of your statistical report. Make sure to caption your figure appropriately.\n\nWrite a paragraph that describes what the histograms show, the initial comparisons between the two groups of wheat yield and how this relates to the aims of the analysis.\n:::\n:::\n\nTo help us choose a suitable statistical method to formally answer whether there is a difference in the mean yields of wheat from fertilised and unfertilised fields, we want to assess whether each group of yields follows a normal distribution. This can be done using QQ plots again.\n\nThe code below creates two side-by-side QQ plots; one for the wheat yields from ferilised fields and one for the wheat yields from unfertilised fields.\n\n::: panel-tabset\n## R Code\n\n```{r, eval = FALSE}\npar(mfrow = c(1, 2))\n\nqqnorm(y = wheat_fertilised$yield,\n       main = \"Wheat Yield from Fertilised Fields\")\nqqline(y = wheat_fertilised$yield)\n\nqqnorm(y = wheat_unfertilised$yield,\n       main = \"Wheat Yield from Unfertilised Fields\")\nqqline(y = wheat_unfertilised$yield)\n\npar(mfrow = c(1, 1))\n```\n\n## Plots\n\n```{r, echo = FALSE}\npar(mfrow = c(1, 2))\n\nqqnorm(y = wheat_fertilised$yield,\n       main = \"Wheat Yield from\\nFertilised Fields\")\nqqline(y = wheat_fertilised$yield)\n\nqqnorm(y = wheat_unfertilised$yield,\n       main = \"Wheat Yield from\\nUnfertilised Fields\")\nqqline(y = wheat_unfertilised$yield)\n\npar(mfrow = c(1, 1))\n```\n:::\n\n::: question\n::: question-header\nTask\n:::\n\n::: {.question-container .webex-check}\n```{r MCQ9, echo=FALSE}\noptsQ9 <- c(answer = \"The wheat yield seems to reasonably follow a normal distribution for both types of field.\",\n            \"The wheat yield from fertilised fields seems to reasonably follow a normal distribtion, whereas the wheat yield from unfertilised fields does not.\",\n            \"The wheat yield from unfertilised fields seems to reasonably follow a normal distribtion, whereas the wheat yield from fertilised fields does not.\")\n```\n\nHow would you describe the normality of wheat yields from fertilised and unfertilised fields from the sample? `r longmcq(sample(optsQ9))`\n:::\n:::\n\n::: question\n::: question-header\nTask\n:::\n\n::: question-container\nAdd the QQ plots you have created in R to the **Exploratory Analysis** section of your statistical report. Make sure to caption the figure appropriately.\n\nWrite a paragraph that describes what the QQ plots show, describing how closely the yields appear to follow a normal distribution.\n:::\n:::\n\n````{=html}\n<!--\n### Aim 3\n\n**What proportion of field's yields might the farmers expect to sell to supermarkets?**\n\nThe variable `supermarket` within the `yields` dataset is a *qualitative* variable since it is categorical and shows whether the yield from a particular field has been sold to supermarkets or not. Therefore, to summarise graphically, we need to think about appropriate plots for qualitative data.\n\nOne such graph could be a barplot. The code below can be used to first create a table showing the proportion of the total number of fields which have their yields both sold and not sold to supermarkets. This is done using the `table()` and the `prop.table()` functions.\n\n::: panel-tabset\n## R Code\n```{r, eval=FALSE}\n#supermarket_props <- prop.table(table(yields$supermarket))\n#supermarket_props\n```\n## Output\n```{r, echo=FALSE}\n#supermarket_props <- prop.table(table(yields$supermarket))\n#supermarket_props\n```\n:::\n\nThen, this table `supermarket_props` is used to create a barplot which visually shows the proportion of fields' yields that were sold to supermarkets and the proportion that were sold elsewhere.\n\n::: panel-tabset\n## R Code\n```{r, eval=FALSE}\n#barplot(height = supermarket_props,\n#        main = \"Proportion of Yields Sold to Supermarkets\",\n#        xlab = \"Sold To\",\n#        ylab = \"Proportion\")\n```\n## Plots\n```{r, echo=FALSE}\n#barplot(height = supermarket_props,\n#        main = \"Proportion of Yields Sold to Supermarkets\",\n#        xlab = \"Sold To\",\n#        ylab = \"Proportion\")\n```\n:::\n\nWe can use the barplot to informally compare the proportion of fields' yields which are sold to supermarkets and which end up elsewhere.\n\n::: question\n::: question-header\nTask\n:::\n::: question-container\nAdd the bar plot created in R to the **Exploratory Analysis** section of your statistical report. Make sure to caption the figure appropriately.\n\nCompare the two proportions of yields which are sold to supermarkets and which end up elsewhere. Which is greater and roughly what is the value of each? What might you expect the population proportion of yields sold to supermarkets to be?\n:::\n:::\n-->\n````\n\n::: question\n::: question-header\nTask\n:::\n\n::: question-container\nSave your statistical report so far. It should now contain a full **Introduction** and **Exploratory Analysis** section.\n\nWe will add to the same statistical report in Lab 9 by working on the **Statistical Analysis** and **Conclusion**.\n:::\n:::\n\n::: webex-highlight\nSo far, we have seen from the exploratory analysis that:\n\n-   the sample mean yield of potatoes from fertilised and from unfertilised fields are approximately equal.\n\n-   the sample standard deviations of potatoes from fertilised and from unfertilised fields are approximately equal.\n\n-   the yields of potatoes from fertilised and unfertilised fields both approximately follow a normal distribution.\n\n-   the sample mean yield of wheat from fertilised is greater than the sample mean yield of wheat from unfertilised fields.\n\n-   the sample standard deviation of wheat yields from fertilised fields is greater than the sample standard deviation of wheat yields from unfertilised fields.\n\n-   the yields of wheat from fertilised and unfertilised fields both approximately follow a normal distribution.\n:::\n","srcMarkdownNoYaml":"\n\n```{r setup, include=FALSE}\nknitr::opts_chunk$set(echo=TRUE, eval=TRUE, comment=NA)\nlibrary(webexercises)\nlibrary(PASWR2)\nlibrary(knitr)\nlibrary(kableExtra)\nlibrary(ggplot2)\nlibrary(tidyverse)\n```\n\n## Reading in the data\n\nThe observed yields can be found in the file *yields.csv*.\n\nTo read *yields.csv* into R, you will first need to download it from [Moodle](https://moodle.gla.ac.uk/mod/folder/view.php?id=4944039){target=\"_blank\"} and save it somewhere accessible. Then, set your working directory in R to point to wherever you have saved this file. For a reminder on setting your working directory, see [Lab 3 Section 2.1](https://moodle.gla.ac.uk/pluginfile.php/9073238/mod_resource/content/4/01-reading.html#directory){target=\"_blank\"}.\n\nTo load the data frame into the **Environment** tab and call it `yields`, we can use the code below.\n\n```{r, echo = FALSE}\nyields <- read.csv(\"data/yields_long.csv\")\n```\n\n::: panel-tabset\n## R Code\n\n```{r, eval = FALSE}\nyields <- read.csv(file = \"yields.csv\")\n```\n:::\n\nIt is always good practise to open the original file to check, for example, for any missing values and the column headings used. Make sure to check that the data frame is saved in R as you would expect. Once you have read `yields` into your R session, we should explore its contents.\n\n::: panel-tabset\n## R Code\n\n```{r, eval = FALSE}\nhead(yields)\n```\n\n## Output\n\n```{r, echo = FALSE}\nhead(yields)\n```\n:::\n\nWe can see that there are 3 columns in `yields`,\n\n-   `fertiliser`: this is a categorical variable stating whether fertiliser was used or not in the field.\n\n-   `crop`: this is a categorical variable stating whether the crop grown in the field was potatoes or wheat.\n\n-   `yield`: this is the yield (in tonnes) of the crop harvested from each field.\n\n<!---   `supermarket`: this is a binary variable; a 1 indicates that the yield from that particular field has been sold to supermarkets and a 0 indicates that the field's yield has been sold elsewhere or kept.-->\n\nBecause `fertiliser` and `crop` are columns of categorical data, we should switch them to be factors. In the code below, note that the argument `levels =` is used with `fertiliser` and `crop` because they are already labelled in the dataset<!--, however the argument `labels =` is used with `supermarket` to relabel each observation from a 0 or 1.-->\n\n::: panel-tabset\n## R Code\n\n```{r}\nyields$fertiliser <- factor(x = yields$fertiliser, \n                            levels = c(\"Used\", \"Not used\"))\n\nyields$crop <- factor(x = yields$crop, \n                      levels = c(\"potato\", \"wheat\"))\n```\n:::\n\n```{r, echo=FALSE}\n#yields$supermarket <- factor(x = yields$supermarket,\n#                             labels = c(\"elsewhere\", \"supermarket\"))\n```\n\n## Summary statistics\n\nSince we are interested in finding any differences between the mean yields of potatoes from fertilised and unfertilised fields, it makes sense to split the data into distinct subsets. `potato_fertilised` and `potato_unfertilised`, created using the code below, store the potato yields where fertiliser was used and fertiliser was not used respectively.\n\n::: panel-tabset\n## R Code\n\n```{r}\npotato_fertilised <- subset(x = yields,\n                            subset = (fertiliser == \"Used\" & crop == \"potato\"))\n\npotato_unfertilised <- subset(x = yields,\n                              subset = (fertiliser == \"Not used\" & crop == \"potato\"))\n```\n:::\n\n::: question\n::: question-header\nTask\n:::\n\n::: question-container\nSimilarly, we are interested in differences between the mean yields of wheat from fertilised and unfertilised fields.\n\nCreate two subsets, `wheat_fertilised` which stores the wheat yields from fields where fertiliser was used, and `wheat_unfertilised` which stores the wheat yields from fields where fertiliser was not used.\n\n`r hide(\"Solution\")`\n\n::: panel-tabset\n## R Code\n\n```{r}\nwheat_fertilised <- subset(x = yields,\n                           subset = (fertiliser == \"Used\" & crop == \"wheat\"))\n\nwheat_unfertilised <- subset(x = yields,\n                             subset = (fertiliser == \"Not used\" & crop == \"wheat\"))\n```\n:::\n\n`r unhide()`\n:::\n:::\n\nNow that we have sensible subsets from the data, we can summarise the yield of crops from each type of field in some way. It would be appropriate to find the sample mean yield, for example, in each case and present these in a table within the statistical report.\n\nThe `mean()` function can be used to find the mean of a vector of numerical values. The only argument that the `mean()` function takes is,\n\n-   `x =`: this is the vector of values to calculate the mean of. This can be numeric or logical.\n\n::: question\n::: question-header\nTask\n:::\n\n::: question-container\nUse the function `mean()` to find the mean yield of potatoes from each type of field, and the mean yield of wheat from each type of field.\n\nWithin the **Exploratory Analysis** section of your report, include the values you calculate in a table similar to the one below. Make sure to caption your table appropriately, and write a short paragraph which introduces where these values come from.\n\n```{r, echo = FALSE}\ndata.frame(Crop = c(\"Potato\", \"Wheat\"), Fertilised = c(\"\", \"\"), Unfertilised = c(\"\", \"\")) %>%\n  column_to_rownames(\"Crop\") %>%\n  kable(table.attr = 'data-quarto-disable-processing=\"true\"; style=\"width:50%;\"') %>%\n  kable_styling(bootstrap_options = c(\"striped\")) %>%\n  kable_paper(position = \"center\") %>%\n  column_spec(1, bold = TRUE, border_right = TRUE)\n```\n\n`r hide(\"Solution\")`\n\nIn order to find the mean yield in each case we're interested in, the following code can be used.\n\n::: panel-tabset\n## R Code\n\n```{r, eval = FALSE}\nmean(x = potato_fertilised$yield)\nmean(x = potato_unfertilised$yield)\nmean(x = wheat_fertilised$yield)\nmean(x = wheat_unfertilised$yield)\n```\n\n## Output\n\n```{r, echo = FALSE}\nmean(potato_fertilised$yield)\nmean(potato_unfertilised$yield)\nmean(wheat_fertilised$yield)\nmean(wheat_unfertilised$yield)\n```\n:::\n\nThese values can then be rounded to 2 decimal places and input into a table in the report such as,\n\n```{r tbl-yield_means, echo = FALSE}\n#| label: tbl-yield_means\n#| tbl-cap: Sample mean yield of potato and wheat yields from fields where fertiliser was and was not used.\n\ndata.frame(Crop = c(\"Potato\", \"Wheat\"), \n           Fertilised = c(round(mean(potato_fertilised$yield), 2),\n                          round(mean(wheat_fertilised$yield), 2)), \n           Unfertilised = c(round(mean(potato_unfertilised$yield), 2), \n                            round(mean(wheat_unfertilised$yield), 2))) %>%\n  column_to_rownames(\"Crop\") %>%\n  kable(table.attr = 'data-quarto-disable-processing=\"true\"; style=\"width:50%;\"') %>%\n  kable_styling(bootstrap_options = c(\"striped\")) %>%\n  kable_paper(position = \"center\") %>%\n  column_spec(1, bold = TRUE, border_right = TRUE)\n```\n\n`r unhide()`\n:::\n:::\n\nFor any output we include in the **Exploratory Analysis** section of the statistical report, we want to explain the initial impressions that this output provides and what we might then expect a formal answer to the aims to be. We can use @tbl-yield_means to informally compare the yield of each crop in the presence and absence of fertiliser.\n\n::: question\n::: question-header\nTask\n:::\n\n::: {.question-container .webex-check}\n```{r MCQ1, echo=FALSE}\noptsQ1 <- c(answer = \"The sample mean yield of potatoes from fertilised fields seems to be approximately equal to the sample mean yield of potatoes from unfertilised fields.\",\n            \"The sample mean yield of potatoes from fertilised fields is equal to the sample mean yield of potatoes from unfertilised fields.\",\n            \"The sample mean yield of potatoes from fertilised fields is substantially different from the sample mean yield of potatoes from unfertilised fields.\")\n```\n\nHow do the sample mean yields of potatoes from fertilised and unfertilised fields compare to each other? `r longmcq(sample(optsQ1))`\n:::\n:::\n\n::: question\n::: question-header\nTask\n:::\n\n::: {.question-container .webex-check}\n```{r MCQ2, echo=FALSE}\noptsQ2 <- c(\"The sample mean yield of wheat from fertilised fields seems to be approximately equal to the sample mean yield of wheat from unfertilised fields.\",\n            \"The sample mean yield of wheat from fertilised fields is equal to the sample mean yield of wheat from unfertilised fields.\",\n            answer = \"The sample mean yield of wheat from fertilised fields is substantially different from the sample mean yield of wheat from unfertilised fields.\")\n```\n\nHow do the sample means of wheat yields from fertilised and unfertilised fields compare to each other? `r longmcq(sample(optsQ2))`\n:::\n:::\n\n````{=html}\n<!--\nWe are also interested in the population proportion of crops that the farmers might expect to sell to supermarkets.\n\nWe can think of whether or not a field's yield is sold to supermarkets as being a realisation from a Bernoulli trial with some unknown probability of being sold to supermarkets, $\\pi$. In other words, the `r nrow(yields)` values in the supermarket column come from a $\\mbox{Bernoulli}(\\pi)$ distribution and we are interested in finding $\\pi$.\n\nA good place to start with this part of the analysis is to state what the *sample proportion*, $p$, of fields' yields sold to supermarkets is. We can find $p$ by again using the `mean()` function.\n\n::: question\n::: question-header\nTask\n:::\n::: question-container\nWhat is the sample proportion of all yields which are sold to supermarkets? $p=$`r fitb(round(mean(yields$supermarket == \"supermarket\"), 1:7))`\n\n`r hide(\"Solutions\")` Since we are interested in the proportion of yields of all crops which are sold to supermarkets, we need to use the full data set `yields`, rather than any of the subsets we created. The sample proportion of all yields which are sold to supermarkets can be found using the code below.\n\n::: panel-tabset\n## R Code\n```{r, eval=FALSE}\nmean(yields$supermarket == \"supermarket\")\n```\n\n## Output\n```{r, echo=FALSE}\nmean(yields$supermarket == \"supermarket\")\n```\n:::\n\nTherefore, $p=0.3857$. `r unhide()`\n:::\n:::\n\n::: question\n::: question-header\nTask\n:::\n::: question-container\nAdd a sentence to your report which states what the sample proportion of field's yields sold to supermarkets is.\n:::\n:::\n-->\n````\n\n## Exploratory plots\n\nIn order to informally answer the [aims](02-intro.qmd#sec-aims) of our analysis, it is also a good idea to produce some appropriate plots that will graphically summarise the information contained in the data. For a reminder of how to create various plots in R, see [Lab 4](https://moodle.gla.ac.uk/pluginfile.php/9073320/mod_resource/content/6/index.html){target=\"_blank\"}.\n\n### Aim 1\n\n**Is there a difference between the mean yields of potatoes from fields that were fertilised and fields that were unfertilised?**\n\n::: question\n::: question-header\nTask\n:::\n\n::: {.question-container .webex-check}\n```{r MCQ3, echo=FALSE}\noptsQ3.1 <- c(\"Barplots\", answer = \"Histograms\", \"Pie charts\")\noptsQ3.2 <- c(answer = \"Kernel density estimates\", \"Dot charts\")\noptsQ3.3 <- c(answer = \"Boxplots\")\n```\n\nWhat might some sensible plots for summarising the yield of potatoes from the two types of fields be? `r longmcq(sample(c(optsQ3.1, optsQ3.2, optsQ3.3)))`\n:::\n:::\n\nTo investigate our first aim, we will use a histogram here but there are other sensible options for presenting quantitative data. A histogram allows us to roughly see the spread of the distribution of potato yields from the sample and consider things such as,\n\n-   whether the population means of the two groups might be equal.\n\n-   if the population standard deviations look approximately equal between the groups.\n\nThe code below can be used to create two side-by-side histograms of potato yields from fertilised and unfertilised fields. So that they are comparable, the binwidths and range of the axes are forced to be the same. This is done by specifying the same sequence in the `breaks =` argument and the same range of the y-axis in the `ylim =` argument for both histograms.\n\n::: panel-tabset\n## R Code\n\n```{r, eval = FALSE}\npar(mfrow = c(2, 1))\n\nhist(x = potato_fertilised$yield,\n     breaks = seq(from = 25, to = 50, by = 2.5),\n     col = \"darkseagreen\",\n     ylim = c(0, 30),\n     main = \"Potato Yield from Fertilised Fields\",\n     xlab = \"Yield (tonnes)\")\n\nhist(x = potato_unfertilised$yield,\n     breaks = seq(from = 25, to = 50, by = 2.5),\n     col = \"darkseagreen1\",\n     ylim = c(0, 30),\n     main = \"Potato Yield from Unfertilised Fields\",\n     xlab = \"Yield (tonnes)\")\n\npar(mfrow = c(1, 1))\n```\n\n## Plots\n\n```{r, echo = FALSE}\npar(mfrow = c(2, 1))\n\nhist(x = potato_fertilised$yield,\n     breaks = seq(from = 25, to = 50, by = 2.5),\n     col = \"darkseagreen\",\n     ylim = c(0, 30),\n     main = \"Potato Yield from Fertilised Fields\",\n     xlab = \"Yield (tonnes)\")\n\nhist(x = potato_unfertilised$yield,\n     breaks = seq(from = 25, to = 50, by = 2.5),\n     col = \"darkseagreen1\",\n     ylim = c(0, 30),\n     main = \"Potato Yield from Unfertilised Fields\",\n     xlab = \"Yield (tonnes)\")\n\npar(mfrow = c(1, 1))\n```\n:::\n\nNow, we can consider some questions that might be useful to informally answer the aim, or inform the statistical method we could use to formally answer it.\n\n::: question\n::: question-header\nTask\n:::\n\n::: {.question-container .webex-check}\n```{r MCQ4, echo=FALSE}\noptsQ4 <- c(answer = \"The sample mean yield of potatoes from fertilised fields seems to be approximately equal to the sample mean yield of potatoes from unfertilised fields.\",\n            \"The sample mean yield of potatoes from fertilised fields is equal to the sample mean yield of potatoes from unfertilised fields.\",\n            \"The sample mean yield of potatoes from fertilised fields is substantially different from the sample mean yield of potatoes from unfertilised fields.\")\n```\n\nHow do the sample mean yields of potatoes from fertilised and unfertilised fields compare to each other? `r longmcq(sample(optsQ4))`\n:::\n:::\n\n::: question\n::: question-header\nTask\n:::\n\n::: {.question-container .webex-check}\n```{r MCQ5, echo=FALSE}\noptsQ5 <- c(answer = \"The sample standard deviation of potato yields from fertilised fields seems to be approximately equal to the sample standard deviation of potato yields from unfertilised fields.\",\n            \"The sample standard deviation of potato yields from fertilised fields is much smaller than the sample standard deviation of potato yields from unfertilised fields.\",\n            \"The sample standard deviation of potato yields from fertilised fields is equal to the sample standard deviation of potato yields from unfertilised fields.\")\n```\n\nHow do the sample standard deviations of potato yields from fertilised and unfertilised fields compare to each other? `r longmcq(sample(optsQ5))`\n:::\n:::\n\n::: question\n::: question-header\nTask\n:::\n\n::: question-container\nAdd the histograms you have created in R to the **Exploratory Analysis** section of your statistical report. Make sure to caption your figure appropriately.\n\nWrite a paragraph that describes what the histograms show, the initial comparisons between the two groups of potato yield and how this relates to the aims of the analysis.\n\n`r hide(\"Copying plots from R\")` Once you have created a plot in the **Plots** tab of R studio, saving it to your clipboard is easy!\n\n![Copying plots from the Plots tab in R studio.](images/copy_plots.gif){#fig-cpoy_plots} You can resize the plot in the pop-up window so it is a useful size. Then, once you click **Copy Plot** it is ready to paste wherever you need it.\n\n`r unhide()`\n:::\n:::\n\nWhen it comes to formally looking for a statistical difference between the mean potato yields from the two types of field (we'll look at this in depth in Lab 9), it may be useful to know whether the yields from both types of field follow a normal distribution. We could use the histograms produced above to comment on this assumption of normality, but another useful to plot to show is a QQ plot.\n\nThe code below produces two side-by-side QQ plots; one for the potato yields from fertilised fields and one for the potato yields from unfertilised fields.\n\n::: panel-tabset\n## R Code\n\n```{r, eval = FALSE}\npar(mfrow = c(1, 2))\n\nqqnorm(y = potato_fertilised$yield,\n       main = \"Potato Yield from Fertilised Fields\")\nqqline(y = potato_fertilised$yield)\n\nqqnorm(y = potato_unfertilised$yield,\n       main = \"Potato Yield from Unfertilised Fields\")\nqqline(y = potato_unfertilised$yield)\n\npar(mfrow = c(1, 1))\n```\n\n## Plots\n\n```{r, echo = FALSE}\npar(mfrow = c(1, 2))\n\nqqnorm(y = potato_fertilised$yield,\n       main = \"Potato Yield from\\nFertilised Fields\")\nqqline(y = potato_fertilised$yield)\n\nqqnorm(y = potato_unfertilised$yield,\n       main = \"Potato Yield from\\nUnfertilised Fields\")\nqqline(y = potato_unfertilised$yield)\n\npar(mfrow = c(1, 1))\n```\n:::\n\n::: question\n::: question-header\nTask\n:::\n\n::: {.question-container .webex-check}\n```{r MCQ6, echo=FALSE}\noptsQ6 <- c(answer = \"The potato yield seems to reasonably follow a normal distribution for both types of field.\",\n            \"The potato yield from fertilised fields seems to reasonably follow a normal distribtion, whereas the potato yield from unfertilised fields does not.\",\n            \"The potato yield from unfertilised fields seems to reasonably follow a normal distribtion, whereas the potato yield from fertilised fields does not.\")\n```\n\nHow would you describe the normality of potato yields from fertilised and unfertilised fields from the sample? `r longmcq(sample(optsQ6))`\n:::\n:::\n\n::: question\n::: question-header\nTask\n:::\n\n::: question-container\nAdd the QQ plots you have created in R to the **Exploratory Analysis** section of your statistical report. Make sure to caption the figure appropriately.\n\nWrite a paragraph that describes what the QQ plots show, describing how closely the yields appear to follow a normal distribution.\n:::\n:::\n\n### Aim 2\n\n**Is there a difference between the mean yields of wheat from fields that were fertilised and fields that were unfertilised?**\n\nOur second aim is similar to the first, but focuses on wheat yields rather than potato yields. Therefore, the same type of plots will be useful to us here, as long as this time they are produced using the subsets `wheat_fertilised` and `wheat_unfertilised` created earlier.\n\nA histogram of wheat yield from fertilised fields and from unfertilised fields will allow us to consider things such as,\n\n-   whether the population means of the two groups seem to be equal\n\n-   if the population standard deviations look approximately equal between the groups.\n\nThe code below creates two side-by-side histograms of wheat yields from fertilised and unfertilised fields. The binwidths used, set by the `break =` argument, and the range of the y-axis, set by the `ylim =` argument, are kept consistent across the two histograms so they are comparable.\n\n::: panel-tabset\n## R Code\n\n```{r, eval = FALSE}\npar(mfrow = c(2, 1))\n\nhist(x = wheat_fertilised$yield,\n     breaks = seq(from = 12, to = 32, by = 1),\n     col = \"brown\",\n     ylim = c(0, 40),\n     main = \"Wheat Yield from Fertilised Fields\",\n     xlab = \"Yield (tonnes)\")\n\nhist(x = wheat_unfertilised$yield,\n     breaks = seq(from = 12, to = 32, by = 1),\n     col = \"brown1\",\n     ylim = c(0, 40),\n     main = \"Wheat Yield from Unfertilised Fields\",\n     xlab = \"Yield (tonnes)\")\n\npar(mfrow = c(1, 1))\n```\n\n## Plots\n\n```{r, echo = FALSE}\npar(mfrow = c(2, 1))\n\nhist(x = wheat_fertilised$yield,\n     breaks = seq(from = 12, to = 32, by = 1),\n     col = \"brown\",\n     ylim = c(0, 40),\n     main = \"Wheat Yield from Fertilised Fields\",\n     xlab = \"Yield (tonnes)\")\n\nhist(x = wheat_unfertilised$yield,\n     breaks = seq(from = 12, to = 32, by = 1),\n     col = \"brown1\",\n     ylim = c(0, 40),\n     main = \"Wheat Yield from Unfertilised Fields\",\n     xlab = \"Yield (tonnes)\")\n\npar(mfrow = c(1, 1))\n```\n:::\n\nThe histograms can help give an initial impression of what an informal answer to the second aim might be.\n\n::: question\n::: question-header\nTask\n:::\n\n::: {.question-container .webex-check}\n```{r MCQ7, echo=FALSE}\noptsQ7 <- c(\"The sample mean yield of wheat from fertilised fields seems to be approximately equal to the sample mean yield of wheat from unfertilised fields.\",\n            \"The sample mean yield of wheat from fertilised fields is equal to the sample mean yield of wheat from unfertilised fields.\",\n            answer = \"The sample mean yield of wheat from fertilised fields is substantially different from the sample mean yield of wheat from unfertilised fields.\")\n```\n\nHow do the sample means of wheat yields from fertilised and unfertilised fields compare to each other? `r longmcq(sample(optsQ7))`\n:::\n:::\n\n::: question\n::: question-header\nTask\n:::\n\n::: {.question-container .webex-check}\n```{r MCQ8, echo=FALSE}\noptsQ8 <- c(\"The sample standard deviation of wheat yields from fertilised fields seems to be approximately equal to the sample standard deviation of wheat yields from unfertilised fields.\",\n            \"The sample standard deviation of wheat yields from fertilised fields is much smaller than the sample standard deviation of wheat yields from unfertilised fields.\",\n            answer = \"The sample standard deviation of wheat yields from fertilised fields seems to be greater than the sample standard deviation of wheat yields from unfertilised fields.\")\n```\n\nHow do the sample standard deviations of wheat yields from fertilised and unfertilised fields compare to each other? `r longmcq(sample(optsQ8))`\n:::\n:::\n\n::: question\n::: question-header\nTask\n:::\n\n::: question-container\nAdd the histograms you have created in R to the **Exploratory Analysis** section of your statistical report. Make sure to caption your figure appropriately.\n\nWrite a paragraph that describes what the histograms show, the initial comparisons between the two groups of wheat yield and how this relates to the aims of the analysis.\n:::\n:::\n\nTo help us choose a suitable statistical method to formally answer whether there is a difference in the mean yields of wheat from fertilised and unfertilised fields, we want to assess whether each group of yields follows a normal distribution. This can be done using QQ plots again.\n\nThe code below creates two side-by-side QQ plots; one for the wheat yields from ferilised fields and one for the wheat yields from unfertilised fields.\n\n::: panel-tabset\n## R Code\n\n```{r, eval = FALSE}\npar(mfrow = c(1, 2))\n\nqqnorm(y = wheat_fertilised$yield,\n       main = \"Wheat Yield from Fertilised Fields\")\nqqline(y = wheat_fertilised$yield)\n\nqqnorm(y = wheat_unfertilised$yield,\n       main = \"Wheat Yield from Unfertilised Fields\")\nqqline(y = wheat_unfertilised$yield)\n\npar(mfrow = c(1, 1))\n```\n\n## Plots\n\n```{r, echo = FALSE}\npar(mfrow = c(1, 2))\n\nqqnorm(y = wheat_fertilised$yield,\n       main = \"Wheat Yield from\\nFertilised Fields\")\nqqline(y = wheat_fertilised$yield)\n\nqqnorm(y = wheat_unfertilised$yield,\n       main = \"Wheat Yield from\\nUnfertilised Fields\")\nqqline(y = wheat_unfertilised$yield)\n\npar(mfrow = c(1, 1))\n```\n:::\n\n::: question\n::: question-header\nTask\n:::\n\n::: {.question-container .webex-check}\n```{r MCQ9, echo=FALSE}\noptsQ9 <- c(answer = \"The wheat yield seems to reasonably follow a normal distribution for both types of field.\",\n            \"The wheat yield from fertilised fields seems to reasonably follow a normal distribtion, whereas the wheat yield from unfertilised fields does not.\",\n            \"The wheat yield from unfertilised fields seems to reasonably follow a normal distribtion, whereas the wheat yield from fertilised fields does not.\")\n```\n\nHow would you describe the normality of wheat yields from fertilised and unfertilised fields from the sample? `r longmcq(sample(optsQ9))`\n:::\n:::\n\n::: question\n::: question-header\nTask\n:::\n\n::: question-container\nAdd the QQ plots you have created in R to the **Exploratory Analysis** section of your statistical report. Make sure to caption the figure appropriately.\n\nWrite a paragraph that describes what the QQ plots show, describing how closely the yields appear to follow a normal distribution.\n:::\n:::\n\n````{=html}\n<!--\n### Aim 3\n\n**What proportion of field's yields might the farmers expect to sell to supermarkets?**\n\nThe variable `supermarket` within the `yields` dataset is a *qualitative* variable since it is categorical and shows whether the yield from a particular field has been sold to supermarkets or not. Therefore, to summarise graphically, we need to think about appropriate plots for qualitative data.\n\nOne such graph could be a barplot. The code below can be used to first create a table showing the proportion of the total number of fields which have their yields both sold and not sold to supermarkets. This is done using the `table()` and the `prop.table()` functions.\n\n::: panel-tabset\n## R Code\n```{r, eval=FALSE}\n#supermarket_props <- prop.table(table(yields$supermarket))\n#supermarket_props\n```\n## Output\n```{r, echo=FALSE}\n#supermarket_props <- prop.table(table(yields$supermarket))\n#supermarket_props\n```\n:::\n\nThen, this table `supermarket_props` is used to create a barplot which visually shows the proportion of fields' yields that were sold to supermarkets and the proportion that were sold elsewhere.\n\n::: panel-tabset\n## R Code\n```{r, eval=FALSE}\n#barplot(height = supermarket_props,\n#        main = \"Proportion of Yields Sold to Supermarkets\",\n#        xlab = \"Sold To\",\n#        ylab = \"Proportion\")\n```\n## Plots\n```{r, echo=FALSE}\n#barplot(height = supermarket_props,\n#        main = \"Proportion of Yields Sold to Supermarkets\",\n#        xlab = \"Sold To\",\n#        ylab = \"Proportion\")\n```\n:::\n\nWe can use the barplot to informally compare the proportion of fields' yields which are sold to supermarkets and which end up elsewhere.\n\n::: question\n::: question-header\nTask\n:::\n::: question-container\nAdd the bar plot created in R to the **Exploratory Analysis** section of your statistical report. Make sure to caption the figure appropriately.\n\nCompare the two proportions of yields which are sold to supermarkets and which end up elsewhere. Which is greater and roughly what is the value of each? What might you expect the population proportion of yields sold to supermarkets to be?\n:::\n:::\n-->\n````\n\n::: question\n::: question-header\nTask\n:::\n\n::: question-container\nSave your statistical report so far. It should now contain a full **Introduction** and **Exploratory Analysis** section.\n\nWe will add to the same statistical report in Lab 9 by working on the **Statistical Analysis** and **Conclusion**.\n:::\n:::\n\n::: webex-highlight\nSo far, we have seen from the exploratory analysis that:\n\n-   the sample mean yield of potatoes from fertilised and from unfertilised fields are approximately equal.\n\n-   the sample standard deviations of potatoes from fertilised and from unfertilised fields are approximately equal.\n\n-   the yields of potatoes from fertilised and unfertilised fields both approximately follow a normal distribution.\n\n-   the sample mean yield of wheat from fertilised is greater than the sample mean yield of wheat from unfertilised fields.\n\n-   the sample standard deviation of wheat yields from fertilised fields is greater than the sample standard deviation of wheat yields from unfertilised fields.\n\n-   the yields of wheat from fertilised and unfertilised fields both approximately follow a normal distribution.\n:::\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"knitr"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["styles.css","include/webex.css"],"toc":true,"include-after-body":["include/webex.js"],"embed-resources":true,"number-sections":true,"output-file":"03-eda.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.4.553","editor":"visual","theme":["cosmo","custom.scss"],"title":"Exploratory Analysis"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}