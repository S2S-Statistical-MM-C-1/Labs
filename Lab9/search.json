[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "S2S Lab 9",
    "section": "",
    "text": "1 Introduction\nWelcome to the ninth S2S lab. Today we will complete the statistical report that we started in Lab 8 by completing the Statistical Analysis and Conclusion sections. If you have completed Lab 8, you should have the beginnings of a statistical analysis report saved.\nWe will take a look at different ways of calculating confidence intervals in different scenarios in R, which will allow us to complete the statistical report.",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Welcome!</span>"
    ]
  },
  {
    "objectID": "01-recap.html",
    "href": "01-recap.html",
    "title": "2  Lab 8 Recap",
    "section": "",
    "text": "We are continuing with statistical report writing which was first looked at in Lab 8. By the end of that lab, a statistical report with complete Introduction and Exploratory Analysis sections was produced, similar to the example report available on Moodle.\nA typical statistical report will follow the structure below.\n\n\nIntroduction: this is where you should write a short description of the problem and provide context such as the data and variables collected. The aims of the analysis should also be clearly stated here.\nExploratory Analysis: this is where you should include appropriate summary statistics and plots you’ve created from the data. These should provide an initial impression and informally answer the aims of your analysis. Any tables and/or figures included should always be clearly captioned.\nStatistical Analysis: this is where the aims of the analysis will be formally answered. Describe the statistical methods and techniques you will use to analyse the data and detail any assumption you are making about the data. Include any relevant output from the analysis you’ve completed (you should not include any code from your R script in a report) and interpret the output in the context of the problem.\nConclusion: use your interpretation to provide an answer to the aims of the analysis. Discuss how this formal conclusion compares to the initial impressions of the data from the Exploratory Analysis and discuss any limitations in your analysis, for example, are there any other techniques you may use in further analysis to provide a better result?\n\n\nA template for a general statistical report, using the structure above, is included at the top of the Lab section on Moodle which you can always use for reference, however in this lab we will be continuing to write the report produced in Lab 8 by focusing on sections (3) and (4).\nAs a reminder, we are investigating a dataset which held information on the annual yield of potatoes and wheat from fields which are fertilised and fields which are unfertilised.\nThese data were gathered by a group of farmers who are interested in investigating whether there is a difference in their mean yield of each crop when the fertiliser is applied, compared to when it is not applied. They apply the new fertiliser to a total of 130 fields where potatoes are grown and 90 fields where wheat is grown. 80 potato fields and 120 wheat fields were left unfertilised and the annual yield of crops from each field was recorded (in tonnes).\nThe data are saved on Moodle and will need to be downloaded and saved somewhere accessible. You may have already done this in Lab 8.\nTo complete the analysis in this Lab, the data need to be read in and any categorical variables saved as factors. This is a repeat of the steps completed in Lab 8, but make sure to run the code below again in your own R Studio window before starting Lab 9.\n\nR Code\n\n\n\nyields &lt;- read.csv(file = \"yields.csv\")\n\nyields$fertiliser &lt;- factor(x = yields$fertiliser, \n                            levels = c(\"Used\", \"Not used\"))\n\nyields$crop &lt;- factor(x = yields$crop, \n                      levels = c(\"potato\", \"wheat\"))\n\n\n\n\nSo far, analysis has been done using four subsets; potato_fertilised, potato_unfertilised, wheat_fertilised and wheat_unfertilised. We can create each of these again and have them saved in the Environment tab ready to use, using the following code.\n\nR Code\n\n\n\npotato_fertilised &lt;- subset(x = yields,\n                            subset = (fertiliser == \"Used\" & crop == \"potato\"))\n\npotato_unfertilised &lt;- subset(x = yields,\n                              subset = (fertiliser == \"Not used\" & crop == \"potato\"))\n\nwheat_fertilised &lt;- subset(x = yields,\n                           subset = (fertiliser == \"Used\" & crop == \"wheat\"))\n\nwheat_unfertilised &lt;- subset(x = yields,\n                             subset = (fertiliser == \"Not used\" & crop == \"wheat\"))\n\n\n\n\n\nSome of the key findings from an exploratory analysis of the data are that:\n\nthe sample mean yield of potatoes from fertilised and from unfertilised fields are approximately equal.\nthe sample standard deviation of potatoes from fertilised and from unfertilised fields are approximately equal.\nthe yields of potatoes from fertilised and unfertilised fields both approximately follow a normal distribution.\nthe sample mean yield of wheat from fertilised is greater than the sample mean yield of wheat from unfertilised fields.\nthe sample standard deviation of wheat yields from fertilised fields is greater than the sample standard deviation of wheat yields from unfertilised fields.\nthe yields of wheat from fertilised and unfertilised fields both approximately follow a normal distribution.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Lab 8 Recap</span>"
    ]
  },
  {
    "objectID": "02-statistical.html",
    "href": "02-statistical.html",
    "title": "3  Statistical Analysis",
    "section": "",
    "text": "3.1 Difference in Population Means\nIn this lab, we will formally answer the following aims in our statistical report.\nIn order to do this, we need to learn some new methods of calculating confidence intervals which will allow us to calculate a 95% confidence interval for the difference between the mean yield in each case.\nIn general, when we have two independent random variables which both follow normal distributions, say \\(X\\sim N(\\mu_X,\\,\\sigma_X)\\) and \\(Y\\sim N(\\mu_Y,\\,\\sigma_Y)\\), it is often of interest to find a range of values for the difference between the population means, \\(\\mu_X\\) and \\(\\mu_Y\\). This range of values can be found using a confidence interval for \\(\\mu_X-\\mu_Y\\), but we have to be aware of the variances of both distributions, as this can change the way the confidence interval is calculated. In order to construct these confidence intervals, random samples have to be drawn from the underlying distributions.\nWe will use the following notation in the formulae for confidence intervals for the difference in population means,",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Statistical Analysis</span>"
    ]
  },
  {
    "objectID": "02-statistical.html#sec-diff",
    "href": "02-statistical.html#sec-diff",
    "title": "3  Statistical Analysis",
    "section": "",
    "text": "\\(n_X\\): the size of the sample drawn from \\(X\\sim N(\\mu_X,\\,\\sigma_X)\\).\n\\(n_Y\\): the size of the sample drawn from \\(Y\\sim N(\\mu_Y,\\,\\sigma_Y)\\).\n\\(x_1, x_2, \\ldots , x_{n_X}\\): the sample taken from \\(X\\sim N(\\mu_X,\\,\\sigma_X)\\) with sample mean \\(\\bar{x}\\) and sample variance \\(s^2_X\\).\n\\(y_1, y_2, \\ldots , y_{n_Y}\\): the sample taken from \\(Y\\sim N(\\mu_Y,\\,\\sigma_Y)\\) with sample mean \\(\\bar{y}\\) and sample variance \\(s^2_Y\\).\n\n\n3.1.1 Variances are known and equal (8.2.3)\nIn the case where the population variances of both distributions are known and are equal, that is \\(\\sigma_X^2=\\sigma_Y^2=\\sigma^2\\), then a \\((1-\\alpha)\\cdot100\\%\\) confidence interval for the difference in the population means, \\(\\mu_X-\\mu_Y\\), is given by,\n\n\\[\\begin{equation} \\tag{8.11} \\label{eq:known-equal}\n\\begin{split}\nCI_{1-\\alpha}(\\mu_X-\\mu_Y)=\\Bigg[&\\left(\\bar x-\\bar y\\right)-z_{1-\\frac{\\alpha}{2}}\\cdot\\sigma\\sqrt{\\frac{1}{n_X}+\\frac{1}{n_Y}},\\\\\n&\\,\\,\\,\\,\\,\\,\\,\\,\\left(\\bar x-\\bar y\\right)+z_{1-\\frac{\\alpha}{2}}\\cdot\\sigma\\sqrt{\\frac{1}{n_X}+\\frac{1}{n_Y}}\\,\\Bigg]\n\\end{split}\n\\end{equation} \\]\n\n\nYou can find the derivation of this result and some additional exercises in Section 8.2.3 of Probability and Statistics with R.\nWe saw from the Exploratory Analysis completed in Lab 8 that the yields of potatoes from fertilised and unfertilised fields both seem to follow a normal distribution with approximately equal variances. To simplify our analysis at this stage, let’s first assume that the population variances are known and are equal to \\(\\sigma^2_\\mbox{f}=\\sigma^2_\\mbox{uf}=4^2\\).\nThat is, we are assuming that the yield of potatoes from fertilised fields follows a \\(N(\\mu_\\mbox{f},4^2)\\) distribution, and the yield of potatoes from unfertilised fields follows a \\(N(\\mu_\\mbox{uf}, 4^2)\\) distribution.\nNow we are ready to compute a 95% confidence interval for the difference in population mean yields of potatoes from fields that were fertilised and fields that were unfertilised using Equation \\(\\eqref{eq:known-equal}\\). That is, a confidence interval for \\(\\mu_\\mbox{f}-\\mu_\\mbox{uf}\\). There a few different ways we could do this in R.\n\n\nMethod 1: Using R as a calculator\n\n\nIn order to use Equation \\(\\eqref{eq:known-equal}\\) above, there are a few values we need to find. We have already assumed that \\(\\sigma=4\\), and we know that \\(n_X=130\\) and \\(n_Y=80\\). We can save these values in R using the code below.\n\nR Code\n\n\n\nsigma &lt;- 4\nnx &lt;- 130\nny &lt;- 80\n\n\n\n\nThat leaves us to find \\(\\bar x\\), \\(\\bar y\\) and \\(z_{1-\\frac{\\alpha}{2}}\\), the \\((1-\\frac{\\alpha}{2})\\)th quantile from the standard normal distribution. In our case, because we are interested in a 95% confidence interval, \\(\\alpha=0.05\\), so we are looking for the \\(\\left(1-\\frac{0.05}{2}\\right)=0.975\\)th quantile.\nWe can find these three values in R using the code below.\n\nR Code\n\n\n\nxbar &lt;- mean(potato_fertilised$yield)\nybar &lt;- mean(potato_unfertilised$yield)\nz &lt;- qnorm(0.975)\n\n\n\n\nNow we can see in the Environment tab that \\(\\bar x=38.75\\) tonnes, \\(\\bar y=38.6\\) tonnes and \\(z_{0.975}=1.96\\).\nCalculating the 95% confidence interval is now just a case of subbing in all the values into Equation \\(\\eqref{eq:known-equal}\\). We can do this in R as follows.\n\nR CodeR Code with Output\n\n\n\n(xbar - ybar) + c(-1, 1)*z*sigma*sqrt(1/nx + 1/ny)\n\n\n\n\n(xbar - ybar) + c(-1, 1)*z*sigma*sqrt(1/nx + 1/ny)\n\n[1] -0.9603676  1.2677138\n\n\n\n\n\nUsing c(-1, 1) allows us to find the lower and upper limit of the confidence interval in one easy step. We would interpret this confidence interval by saying that we are 95% confident that the difference between the population mean yields of potatoes from fertilised and unfertilised fields lies in the interval \\(\\left[-0.9604,\\, 1.2677\\right]\\).\nNote that this interval is not strictly positive i.e. it contains the value 0. This tells us that there is not sufficient evidence that the population mean potato yield from fertilised fields is any different from the population mean potato yield from unfertilised fields at the \\(\\alpha=0.05\\) significance level.\n\n\n\n\nMethod 2: Using the z.test() function\n\n\nExactly the same result can be reached by using the function z.test(). This function runs through all the steps we manually calculated in the section above, so can speed up the process of finding a confidence interval. This function is part of the PASWR2 package, so we need to load it into the R session. z.test() can take the following arguments,\n\nx =: this is a vector containing the sample data taken from the first normal distribution.\ny =: this is a vector containing the sample data taken from the second normal distribution.\nsigma.x =: this is the standard deviation of the first normal distribution.\nsigma.y =: this is the standard deviation of the second normal distribution.\nconf.level =: the is the confidence level for the desired interval. It needs to be put in as a decimal, so for a 95% confidence interval, we would use 0.95 for example.\n\nThe code below uses z.test() to find the 95% confidence interval for the difference in population mean potato yield from fertilised and unfertilised fields. We use $conf at the end of the function to extract only the confidence interval. z.test() by itself will return additional results.\n\nR CodeOutput\n\n\n\nlibrary(PASWR2)\n\nz.test(x = potato_fertilised$yield, y = potato_unfertilised$yield,\n       sigma.x = 4, sigma.y = 4, conf.level = 0.95)$conf\n\n\n\n\n\n[1] -0.9603676  1.2677138\nattr(,\"conf.level\")\n[1] 0.95\n\n\n\n\n\nAgain, we would interpret this confidence interval by saying that we are 95% confident that the difference between the population mean yields of potatoes from fertilised and unfertilised fields lies in the interval \\(\\left[-0.9604,\\, 1.2677\\right]\\).\nWe would again say that there is not sufficient evidence that the population mean potato yield from fertilised fields is any different from the population mean potato yield from unfertilised fields since this interval contains the value 0.\n\n\n\n\nMethod 3: Using the zsum.test() function\n\n\nAnother function contained in the PASWR2 package that can be useful is the zsum.test() function. This allows you to calculate the same confidence interval, but rather than inputting the data from the sample itself, you input some summary statistics that you have either calculated or have been given to you as part of the question.\nzsum.test() is a good function to use if you are not given the data from the samples as part of a question, but rather some already calculated summary statistics.\nThe arguments that zsum.test() can take are,\n\nmean.x =: this is the mean of the first sample. We have already calculated \\(\\bar x\\) and saved it as xbar.\nmean.y =: this is the mean of the second sample. We have already calculated \\(\\bar y\\) and saved it as ybar.\nsigma.x =: this is the standard deviation of the underlying normal distribution the first sample has been taken from. We know from the question that this is equal to 4 and we have saved it in the object sigma.\nsigma.y =: this is the standard deviation of the underlying normal distribution the second sample has been taken from. We know from the question that this is equal to 4 and we have saved it in the object sigma.\nn.x =: this is the size of the first sample. In the question this is \\(n_X=130\\) and this is already saved as nx.\nn.y =: this is the size of the second sample. In the question this is \\(n_Y=80\\) and this is already saved as ny.\nconf.level =: this is the confidence level for the desired interval. It needs to be put in as a decimal, so for a 95% confidence interval, we would use 0.95 for example.\n\nWe can input all of these values as arguments in the zsum.test() function to find the 95% confidence interval for the difference in population mean yield of potatoes from the fertilised and unfertilised fields. Again, we use $conf at the end of the function to extract only the confidence interval.\n\nR CodeOutput\n\n\n\nlibrary(PASWR2)  #this line only needs to be run once in each R session\n\nzsum.test(mean.x = xbar, mean.y = ybar, sigma.x = sigma, sigma.y = sigma,\n          n.x = nx, n.y = ny, conf.level = 0.95)$conf\n\n\n\n\n\n[1] -0.9603676  1.2677138\nattr(,\"conf.level\")\n[1] 0.95\n\n\n\n\n\nThis confidence interval tells us that we are 95% confident that the difference between the population mean yields of potatoes from fertilised and unfertilised fields lies in the interval \\(\\left[-0.9604,\\, 1.2677\\right]\\). Once again, we see that this interval contains 0, so there is not sufficient evidence to suggest a difference in population mean potato yield exists between the fertilised and unfertilised fields when the significance level is \\(\\alpha=0.05\\).\n\n\n\n\n3.1.2 Variances are known and unequal (8.2.4)\nIn the case where the variances of both distributions are known but are unequal, that is \\(\\sigma_X^2\\neq\\sigma_Y^2\\), then a \\((1-\\alpha)\\cdot100\\%\\) confidence interval for the difference in the population means, \\(\\mu_X-\\mu_Y\\), is given by,\n\n\\[\\begin{equation} \\tag{8.12} \\label{eq:known-unequal}\n\\begin{split}\nCI_{1-\\alpha}(\\mu_X-\\mu_Y)=\\Bigg[&\\left(\\bar x-\\bar y\\right)-z_{1-\\frac{\\alpha}{2}}\\cdot\\sqrt{\\frac{\\sigma_X^2}{n_X}+\\frac{\\sigma_Y^2}{n_Y}},\\\\\n&\\,\\,\\,\\,\\,\\,\\left(\\bar x-\\bar y\\right)+z_{1-\\frac{\\alpha}{2}}\\cdot\\sqrt{\\frac{\\sigma_X^2}{n_X}+\\frac{\\sigma_Y^2}{n_Y}}\\,\\Bigg]\n\\end{split}\n\\end{equation}\\]\n\n\nTo see some further examples of using this confidence interval, see Section 8.2.4 of Probability and Statistics with R.\nFrom the exploratory analysis completed in Lab 8, the yields of wheat from fertilised and unfertilised fields both approximately follow normal distributions, but with unequal variances. At this stage of the analysis, we’re going to assume the population variances are known and are \\(\\sigma_{\\mbox{f}}^2=3^2\\) for yields from fertilised fields, and \\(\\sigma_{\\mbox{uf}}^2=1^2\\) for yields from unfertilised fields.\nThat is, we’re assuming the wheat yields from fertilised fields follow a \\(N(\\mu_{\\mbox{f}},3^2)\\) distribution and the wheat yields from unfertilised fields follow a \\(N(\\mu_{\\mbox{uf}}, 1^2)\\) distribution.\nWe can then calculate a 95% confidence interval for the difference in population mean wheat yields from fertilised and unfertilised fields using Equation \\(\\eqref{eq:known-unequal}\\) above. This can be done, again, in a few different ways in R.\n\n\nMethod 1: Using R as a calculator\n\n\nIn order to use Equation \\(\\eqref{eq:known-unequal}\\), we can start by saving all the values that we know from the question as objects in the Environment tab. That is, \\(n_X=90\\), \\(n_Y=120\\), \\(\\sigma_X=3\\) and \\(\\sigma_Y=1\\).\n\nR Code\n\n\n\nnx &lt;- 90\nny &lt;- 120\nsigmax &lt;- 3\nsigmay &lt;- 1\n\n\n\n\nIn order to use the formula for the confidence interval stated above, we still need to find \\(\\bar x\\), \\(\\bar y\\) and \\(z_{1-\\frac{\\alpha}{2}}\\). We can find each of these using the code below.\n\nR Code\n\n\n\nxbar &lt;- mean(wheat_fertilised$yield)\nybar &lt;- mean(wheat_unfertilised$yield)\nz &lt;- qnorm(0.975)\n\n\n\n\nNow we can see in the Environment tab that \\(\\bar x=23.8\\) tonnes, \\(\\bar y=17.98\\) tonnes and \\(z_{0.975}=1.96\\).\nCalculating the 95% confidence interval is now just a case of subbing in all the values into Equation \\(\\eqref{eq:known-unequal}\\). We can do this in R as follows.\n\nR CodeR Code with Output\n\n\n\n(xbar - ybar) + c(-1, 1)*z*sqrt(sigmax^2/nx + sigmay^2/ny)\n\n\n\n\n(xbar - ybar) + c(-1, 1)*z*sqrt(sigmax^2/nx + sigmay^2/ny)\n\n[1] 5.174600 6.464806\n\n\n\n\n\nWe would interpret this confidence interval by saying that we are 95% confident that the difference between the population mean yields of wheat from fertilised and unfertilised fields lies in the interval \\(\\left[5.1746,\\, 6.4648\\right]\\).\nNote that this interval is strictly positive which means there is statistically significant evidence of a difference between the population mean yields of wheat from the two types of field at the 5% significance level.\n\n\n\n\nMethod 2: Using the z.test() function\n\n\nAs we have seen, the function z.test() from the PASWR2 package is useful if we have been provided the data and know the variances of the two normal distributions that the groups follow.\nIn this case, we can use z.test() to calculate a 95% confidence interval for the difference in population mean wheat yields from fertilised and unfertilised fields as follows.\n\nR CodeOutput\n\n\n\nlibrary(PASWR2)  #this line only needs to be run once in each R session\n\nz.test(x = wheat_fertilised$yield, y = wheat_unfertilised$yield,\n       sigma.x = 3, sigma.y = 1, conf.level = 0.95)$conf\n\n\n\n\n\n[1] 5.174600 6.464806\nattr(,\"conf.level\")\n[1] 0.95\n\n\n\n\n\nAgain, we would interpret this confidence interval by saying that we are 95% confident that the difference between the population mean yields of wheat from fertilised and unfertilised fields lies in the interval \\(\\left[5.1746,\\, 6.4648\\right]\\). We also see statistically significant evidence that there is a difference in these two population means at the 5% significance level.\n\n\n\n\nMethod 3: Using the zsum.test() function\n\n\nTo save us from having to use R as a calculator to find the confidence interval, we can use the function zsum.test() from the PASWR2 package.\nWe already have saved in the Environment tab that,\n\nxbar\\(=\\bar x=23.8\\)\nybar\\(=\\bar y=17.98\\)\nsigmax\\(=\\sigma_X=3\\)\nsigmay\\(=\\sigma_Y=1\\)\nnx\\(=n_X=90\\)\nny\\(=n_Y=120\\)\n\nWe can then find the 95% confidence interval for the difference in population mean wheat yield from fertilised and unfertilised fields as follows.\n\nR CodeOutput\n\n\n\nlibrary(PASWR2)  #this line only needs to be run once in each R session\n\nzsum.test(mean.x = xbar, mean.y = ybar, sigma.x = sigmax, sigma.y = sigmay,\n          n.x = nx, n.y = ny, conf.level = 0.95)$conf\n\n\n\n\n\n[1] 5.174600 6.464806\nattr(,\"conf.level\")\n[1] 0.95\n\n\n\n\n\nThis function is mostly useful if we are not provided with the original sample data, but rather summary statistics.\nWe can again see that the confidence interval is \\(\\left[5.1746,\\, 6.4648\\right]\\), so we say we are 95% confident that the difference between the population mean yields of wheat from fertilised and unfertilised fields lies in this interval and that there is statistically significant evidence of a difference in these two population means at the 5% significance level.\n\n\n\n\n3.1.3 Variances are unknown and assumed equal (8.2.5)\nWhen random samples have been taken from two normal distributions where the variances are unknown but assumed to be equal, a \\((1-\\alpha)\\cdot100\\%\\) confidence interval for \\(\\mu_X-\\mu_Y\\) is given by,\n\n\\[\\begin{equation} \\tag{8.15} \\label{eq:unknown-equal}\n\\begin{split}\nCI_{1-\\alpha}(\\mu_X-\\mu_Y)=\\Bigg[&\\left(\\bar x-\\bar y\\right)-t_{1-\\frac{\\alpha}{2};\\nu_p}\\cdot s_p\\sqrt{\\frac{1}{n_X}+\\frac{1}{n_Y}},\\\\\n&\\,\\,\\,\\,\\,\\,\\,\\left(\\bar x-\\bar y\\right)+t_{1-\\frac{\\alpha}{2};\\nu_p}\\cdot s_p\\sqrt{\\frac{1}{n_X}+\\frac{1}{n_Y}}\\,\\Bigg]\n\\end{split}\n\\end{equation}\\]\n\n\n\\(\\nu_p\\) represents the degrees of freedom for the associated \\(t\\) distribution. The degrees of freedom can be found as \\(\\nu_p=n_X+n_Y-2\\).\n\\(s_p\\) is a pooled estimate of the standard deviation that takes into account the sample sizes, \\(n_X\\) and \\(n_Y\\), taken from each distribution. An estimate for the pooled variance can be found using, \\[s_p^2=\\frac{\\left(n_X-1\\right)s_X^2+\\left(n_Y-1\\right)s_Y^2}{n_X+n_Y-2}\\]\nwhere, \\(s_X^2=\\frac{\\sum_{i=1}^{n_X}x_i^2-n_X\\bar x^2}{n_X-1}\\) and \\(s_Y^2=\\frac{\\sum_{i=1}^{n_Y}y_i^2-n_Y\\bar y^2}{n_Y-1}\\).\nRemember to take the square root of the estimated variance to find the estimate of standard deviation.\n\n\nTo see more examples of calculating these confidence intervals, see Section 8.2.5 of Probability and Statistics with R.\nSo far, when calculating the confidence interval for the difference in population mean yield of potatoes, we have been told the value for \\(\\sigma^2_X=\\sigma^2_Y=\\sigma^2\\), the population variance. It might not be the case that we know this value, in which case we would use Equation \\(\\eqref{eq:unknown-equal}\\) stated above.\nThe difference between this one and Equation \\(\\eqref{eq:known-equal}\\) from Section 3.1.1 is that the \\(t\\)-distribution is now used rather than the standard normal, and that a pooled estimate of the standard deviation is used. This is because we do not know a value for the population standard deviation \\(\\sigma\\).\nWe don’t actually know the standard deviations of the distributions that potato yields follow, but based on our exploratory analysis from Lab 8, we can assume that they are equal. We also know that potato yields from both fertilised and unfertilised fields approximately follow normal distributions. Therefore, a 95% confidence interval for the difference in mean population potato yields from fertilised and unfertilised fields can be calculated using Equation \\(\\eqref{eq:unknown-equal}\\). The confidence interval can be found in R in a few different ways.\n\n\nMethod 1: Using R as a calculator\n\n\nWe can start by saving \\(n_X=130\\) and \\(n_Y=80\\) as objects in the Environment tab.\n\nR Code\n\n\n\nnx &lt;- 130\nny &lt;- 80\n\n\n\n\nThen we can calculate \\(\\bar x\\), \\(\\bar y\\) and \\(t_{1-\\frac{\\alpha}{2};\\nu_p}\\), which is the \\((1-\\frac{\\alpha}{2})\\)th quantile from the \\(t\\)-distribution with \\(\\nu_p=n_X+n_Y-2\\) degrees of freedom. Because we are interested in a 95% confidence interval, \\(\\alpha=0.05\\), so the quantile we are looking for is the \\(\\left(1-\\frac{0.05}{2}\\right)=0.975\\)th quantile. To find a quantile from the \\(t\\)-distribution, we use the qt() function.\n\nR Code\n\n\n\nxbar &lt;- mean(potato_fertilised$yield)\nybar &lt;- mean(potato_unfertilised$yield)\nt &lt;- qt(0.975, nx + ny - 2)\n\n\n\n\nIn order to use Equation \\(\\eqref{eq:unknown-equal}\\), we also need to calculate the estimate for the pooled variance, \\(s_p^2\\). Before we can do this, we need to find the sum of squares for both groups, \\(s_X^2\\) and \\(s_Y^2\\). This can be done using the code below, which first of all calculates \\(\\sum_{i=1}^{n_X}x_i^2\\) and \\(\\sum_{i=1}^{n_Y}y_i^2\\) and saves them as sum_x2 and sum_y2 respectively. These values are then used to find \\(s_X^2\\) and \\(s_Y^2\\), which have been saved as s2x and s2y respectively.\n\nR Code\n\n\n\nsum_x2 &lt;- sum(potato_fertilised$yield^2)\nsum_y2 &lt;- sum(potato_unfertilised$yield^2)\n\ns2x &lt;- (sum_x2 - nx*xbar^2)/(nx - 1)\ns2y &lt;- (sum_y2 - ny*ybar^2)/(ny - 1)\n\n\n\n\nNote that here we have calculated the variance of both groups ‘by hand’. We could do exactly the same thing using the var() function, which calculates the variance of a vector of values.\nNow we can find the estimate for the pooled variance, \\(s_p^2\\), using the values for the sum of squares for both groups. This has been saved as sp2.\n\nR Code\n\n\n\nsp2 &lt;- ((nx - 1)*s2x + (ny - 1)*s2y)/(nx + ny - 2)\n\n\n\n\nNow we can sub all of the values that have been calculated into Equation \\(\\eqref{eq:unknown-equal}\\) as follows.\n\nR CodeR Code with Output\n\n\n\n(xbar - ybar) + c(-1, 1)*t*sqrt(sp2)*sqrt(1/nx + 1/ny)\n\n\n\n\n(xbar - ybar) + c(-1, 1)*t*sqrt(sp2)*sqrt(1/nx + 1/ny)\n\n[1] -0.9695833  1.2769294\n\n\n\n\n\nWe are 95% confident that the difference between the population mean yields of potatoes from fertilised and unfertilised fields lies in the interval \\(\\left[-0.9696,\\, 1.2769\\right]\\) when the population variances are unknown, but assumed equal.\n\n\n\n\nMethod 2: Using the t.test() function\n\n\nAnother way in which we can calculate this 95% confidence interval is by using the t.test() function. This function is already part of R, so you don’t need to load any packages. The only arguments that t.test() needs are,\n\nx =: this is the vector of normally distributed values from the first group.\ny =: this is the vector of normally distributed values from the second group.\nvar.equal =: this takes the value TRUE or FALSE, indicating whether we believe the variances, and hence the standard deviations, of both groups are the same.\nconf.level =: this is the confidence interval for the desired interval. It needs to be put in as a decimal, so for a 95% confidence interval, we would use 0.95.\n\nThe code below uses t.test() to find the 95% confidence interval for the difference in population mean potato yield from fertilised and unfertilised fields. $conf is used to extract only the confidence interval as by itself, t.test() will return additional results.\n\nR CodeOutput\n\n\n\nt.test(x = potato_fertilised$yield, y = potato_unfertilised$yield,\n       var.equal = TRUE, conf.level = 0.95)$conf\n\n\n\n\n\n[1] -0.9695833  1.2769294\nattr(,\"conf.level\")\n[1] 0.95\n\n\n\n\n\nWe see the same result, that the 95% confidence interval for the difference in population mean potato yields from the two types of field is \\(\\left[-0.9696,\\, 1.2769\\right]\\).\n\n\n\n\nMethod 3: Using the tsum.test() function\n\n\nIf we had been given summary statistics of the two groups, but did not know the variances of the groups, we can use the function tsum.test(). This is part of the PASWR2 package, so make sure it is loaded into your R session.\nThe arguments that tsum.test() can take are,\n\nmean.x =: this is the mean of the first sample, \\(\\bar x\\).\nmean.y =: this is the mean of the second sample, \\(\\bar y\\).\ns.x =: this is the estimate of the standard deviation of the first sample. We have already found the estimated variance, \\(s_X^2\\), and saved it as s2x, so we just need to take the square root.\ns.y =: this is the estimate of the standard deviation of the second sample. We have already found the estimated variance, \\(s_Y^2\\), and saved it as s2y, so we just need to take the square root.\nn.x =: this is the sample size of the first group, \\(n_X\\).\nn.y =: this is the sample size of the second group, \\(n_Y\\).\nvar.equal =: this takes the value TRUE or FALSE, indicating whether we believe the variances, and hence the standard deviations, of both groups are the same.\nconf.level =: this is the confidence interval for the desired interval.\n\nWe can input all of these values as arguments in the tsum.test() function to find the 95% confidence interval for the difference in population mean yield of potatoes from fertilised and unfertilised fields. Again, $conf is needed to show only the confidence interval.\n\nR CodeOutput\n\n\n\nlibrary(PASWR2)  #this line only needs to be run once in each R session\n\ntsum.test(mean.x = xbar, mean.y = ybar, s.x = sqrt(s2x), s.y = sqrt(s2y),\n          n.x = nx, n.y = ny, var.equal = TRUE, conf.level = 0.95)$conf\n\n\n\n\n\n[1] -0.9695833  1.2769294\nattr(,\"conf.level\")\n[1] 0.95\n\n\n\n\n\nOnce again, the 95% confidence interval returned to us for the difference between the population mean potato yield from fertilsied and from unfertilised fields is \\(\\left[-0.9696,\\, 1.2769\\right]\\).\n\n\n\n\nTask\n\n\nHow would you interpret the 95% confidence interval for the difference in population mean potato yields between fertilised and unfertilised fields, when the variances are unknown but assumed equal?\n\n There is not significant evidence to suggest a difference between the population mean potato yields from fertilised and unfertilised fields at the 5% significance level. There is significant evidence to suggest a difference between the population mean potato yields from fertilised and unfertilised fields at the 5% significance level. The population mean potato yield from fertilised fields is significantly lower than the population mean potato yield from unfertilised fields. The population mean potato yield from fertilised fields is significantly higher than the population mean potato yield from unfertilised fields.\n\n\n\n\n\nTask\n\n\nOpen the statistical report you have saved from Lab 8. This should already contain complete Introduction and Exploratory Analysis sections.\nIn the Statistical Analysis section, add in an interpretation of the 95% confidence interval for the difference in population mean potato yields between fertilised and unfertilised fields. Make sure you state what the assumptions you have made to calculate this confidence interval are, the values in the interval and how this would be interpreted.\n\n\n\n\n3.1.4 Variances are unknown and unequal (8.2.6)\nWhen random samples have been taken from two normal distributions where the variances, \\(\\sigma_X^2\\) and \\(\\sigma_Y^2\\), are unknown and they are assumed unequal, a \\((1-\\alpha)\\cdot100\\%\\) confidence interval for \\(\\mu_X-\\mu_Y\\) is given by,\n\n\\[\\begin{equation} \\tag{8.16} \\label{eq:unknown-unequal}\n\\begin{split}\nCI_{1-\\alpha}(\\mu_X-\\mu_Y)=\\Bigg[&\\left(\\bar x-\\bar y\\right)-t_{1-\\frac{\\alpha}{2};\\nu}\\cdot \\sqrt{\\frac{s_X^2}{n_X}+\\frac{s_Y^2}{n_Y}},\\\\\n&\\,\\,\\,\\,\\,\\,\\,\\left(\\bar x-\\bar y\\right)+t_{1-\\frac{\\alpha}{2};\\nu}\\cdot\\sqrt{\\frac{s_X^2}{n_X}+\\frac{s_Y^2}{n_Y}}\\,\\Bigg]\n\\end{split}\n\\end{equation}\\]\n\n\n\\(\\nu\\) represents the degrees of freedom for the associated \\(t\\) distribution. The degrees of freedom can be found using, \\[\\nu=\\frac{\\left(\\frac{s_X^2}{n_X}+\\frac{s_Y^2}{n_Y}\\right)^2}{\\frac{\\left(s_X^2/n_X\\right)^2}{n_X-1}+\\frac{\\left(s_Y^2/n_Y\\right)^2}{n_Y-1}}\\]\nwhere, \\(s_X^2=\\frac{\\sum_{i=1}^{n_X}x_i^2-n_X\\bar x^2}{n_X-1}\\) and \\(s_Y^2=\\frac{\\sum_{i=1}^{n_Y}y_i^2-n_Y\\bar y^2}{n_Y-1}\\).\n\n\nSee Section 8.2.6 of Probability and Statistics with R for further examples of finding these confidence intervals.\nThe standard deviations of the distributions that wheat yields follow are not actually known and from the exploratory analysis, it seems that the population variances are likely unequal. Assuming this is the case, we can still calculate a 95% confidence interval for the difference in population mean wheat yield between fertilised and unfertilised fields using Equation \\(\\eqref{eq:unknown-unequal}\\) above.\nIn order to use this result, both groups must be normally distributed. We have already seen that this is the case from the exploratory analysis, but if we hadn’t checked make sure to check both groups follow a normal distribution, using QQ plots.\nThere a few different ways in which we can calculate the desired 95% confidence interval.\n\n\nMethod 1: Using R as a calculator\n\n\nWe start by saving \\(n_X=90\\) and \\(n_Y=120\\) as objects in the Environment tab and calculating the mean of each group.\n\nR Code\n\n\n\nnx &lt;- 90\nny &lt;- 120\n\nxbar &lt;- mean(wheat_fertilised$yield)\nybar &lt;- mean(wheat_unfertilised$yield)\n\n\n\n\nWe can see now, in the Environment tab, that \\(\\bar x=23.8\\) and \\(\\bar y=17.98\\).\nBefore we can find the \\(\\left(1-\\frac{\\alpha}{2}\\right)\\)th quantile from the \\(t\\)-distribution, we need to find the associated degrees of freedom \\(\\nu\\). This involves a few steps. First of all, we find \\(\\sum_{i=1}^{n_X}x_i^2\\) and \\(\\sum_{i=1}^{n_Y}y_i^2\\).\n\nR Code\n\n\n\nsum_x2 &lt;- sum(wheat_fertilised$yield^2)\nsum_y2 &lt;- sum(wheat_unfertilised$yield^2)\n\n\n\n\nRunning the above code will show us that \\(\\sum_{i=1}^{n_X}x_i^2=5.171523\\times 10^{4}\\) and \\(\\sum_{i=1}^{n_Y}y_i^2=3.893489\\times 10^{4}\\). We can use these values to find the variance of the two wheat yield samples, \\(s_X^2\\) and \\(s_Y^2\\).\n\nR Code\n\n\n\ns2x &lt;- (sum_x2 - nx*xbar^2)/(nx - 1)\ns2y &lt;- (sum_y2 - ny*ybar^2)/(ny - 1)\n\n\n\n\nIf we had used the var() function we would be left with the same result, that \\(s_X^2=8.21\\) and \\(s_Y^2=1.13\\). Now we can use these values to find \\(\\nu\\) as follows (this value is saved as df) and find the \\(\\left(1-\\frac{\\alpha}{2}\\right)\\)th quantile from the \\(t\\)-distribution with \\(\\nu\\) degrees of freedom using the function qt().\n\nR Code\n\n\n\ndf &lt;- (s2x/nx + s2y/ny)^2 / ((s2x/nx)^2/(nx-1) + (s2y/ny)^2/(ny - 1))\n\nt &lt;- qt(0.975, df)\n\n\n\n\nFinally, we can sub all of these values into the formula for the confidence interval.\n\nR CodeR Code with Output\n\n\n\n(xbar - ybar) + c(-1, 1)*t*sqrt(s2x/nx + s2y/ny)\n\n\n\n\n(xbar - ybar) + c(-1, 1)*t*sqrt(s2x/nx + s2y/ny)\n\n[1] 5.190980 6.448426\n\n\n\n\n\nWe would interpret this interval by saying that we are 95% confident that the difference between the population mean wheat yield from fertilised and unfertilised fields lies in the interval \\(\\left[5.191,\\, 6.4484\\right]\\). This is true for the scenario where we don’t know the variance of each underlying distribution and assume it is different for the two groups.\n\n\n\n\nMethod 2: Using the t.test() function\n\n\nWe can find the same interval using the t.test() function.\nTo find the 95% confidence interval for the difference in population mean wheat yields from fertilised and unfertilised fields, assuming the variances are unequal, we would use the code below.\n\nR CodeOutput\n\n\n\nt.test(x = wheat_fertilised$yield, y = wheat_unfertilised$yield,\n       var.equal = FALSE, conf.level = 0.95)$conf\n\n\n\n\n\n[1] 5.190980 6.448426\nattr(,\"conf.level\")\n[1] 0.95\n\n\n\n\n\nThis again tells us that the interval is \\(\\left[5.191,\\, 6.4484\\right]\\), so we are 95% confident the difference in population mean wheat yields from fertilised and unfertilised fields lies in this interval.\n\n\n\n\nMethod 3: Using the tsum.test() function\n\n\nWe could also use the summary statistics, already calculated, and the function tsum.test() from the PASWR2 package. This would look as follows.\n\nR CodeOutput\n\n\n\nlibrary(PASWR2)  #this line only needs to be run once in each R session\n\ntsum.test(mean.x = xbar, mean.y = ybar, s.x = sqrt(s2x), s.y = sqrt(s2y),\n          n.x = nx, n.y = ny, var.equal = FALSE, conf.level = 0.95)$conf\n\n\n\n\n\n[1] 5.190980 6.448426\nattr(,\"conf.level\")\n[1] 0.95\n\n\n\n\n\nWe would say that we are 95% confident that the difference in population mean yields of wheat from the two types of field lies in the interval \\(\\left[5.191,\\, 6.4484\\right]\\).\n\n\n\n\nTask\n\n\nHow would you interpret the 95% confidence interval for the difference in population mean wheat yields between fertilised and unfertilised fields, when the variances are unknown and assumed unequal?\n\n There is not significant evidence to suggest a difference between the population mean wheat yields from fertilised and unfertilised fields at the 5% significance level. The population mean wheat yield from fertilised fields is equal to the population mean wheat yield from unfertilised fields at the 5% significance level. The population mean wheat yield from fertilised fields is significantly lower than the population mean wheat yield from unfertilised fields. There is significant evidence to suggest a difference between the population mean wheat yields from fertilised and unfertilised fields at the 5% significance level.\n\n\n\n\n\nTask\n\n\nIn the Statistical Analysis section of your report, add in an interpretation of the 95% confidence interval for the difference in population mean wheat yields between fertilised and unfertilised fields.\nMake sure you state what the assumptions you have made to calculate this confidence interval are, the values in the interval and how this would be interpreted.",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Statistical Analysis</span>"
    ]
  },
  {
    "objectID": "03-conclusion.html",
    "href": "03-conclusion.html",
    "title": "4  Conclusion",
    "section": "",
    "text": "To finish our statistical report we need to add a conclusion which should use the confidence intervals we found in Sections 3.1.3 and 3.1.4 to answer the aims of our analysis. We need to make sure that this section rounds out the whole report by comparing our initial impressions of the data from the Exploratory Analysis to the formal findings from the Statistical Analysis.\n\n\nTask\n\n\nFor each of our aims, what do your findings suggest?\n\nIs there a difference between the mean yields of potatoes from fields that were fertilised and fields that were unfertilised?\n\n Yes No\n\nIs there a difference between the mean yields of wheat from fields that were fertilised and fields that were unfertilised?\n\n Yes No\n\n\n\n\n\n\nTask\n\n\nIn the Conclusion section of your report, add a paragraph which compares your initial Exploratory Analysis to your formal Statistical Analysis. Make sure to include a sentence which clearly answers each of your aims.\n\n\nWe also want to include a discussion of the limitations of our analysis. This could talk about things like not having enough data, having to make relatively unrealistic assumptions, or mention any potential variables that could have been measured and would’ve been informative in your analysis.\nIf you know of any further statistical methods that could be applied to your dataset to help investigate the aims, but that have not been applied in the report, you can mention them here.",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Conclusion</span>"
    ]
  }
]